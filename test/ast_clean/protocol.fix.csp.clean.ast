(Module ((:) (Transparent ((:) (Ident "normal") ([]))) ((:) (FunBind (Ident "wire") ((:) (FunCase ((:) ((:) (VarPat (Ident "P")) ((:) (VarPat (Ident "A")) ((:) (VarPat (Ident "Q")) ([])))) ([])) (Fun2 (BuiltIn (F_Hiding)) (Parens (ProcSharing (Var (Ident "A")) (Var (Ident "P")) (Var (Ident "Q")))) (Var (Ident "A")))) ([]))) ((:) (FunBind (Ident "BUFFER") ((:) (FunCase ((:) ((:) (VarPat (Ident "n")) ((:) (VarPat (Ident "in")) ((:) (VarPat (Ident "out")) ((:) (VarPat (Ident "type")) ([]))))) ([])) (Let ((:) (FunBind (Ident "B") ((:) (FunCase ((:) ((:) (ListEnumPat ([])) ([])) ([])) (PrefixExp (Var (Ident "in")) ((:) (InCommGuarded (VarPat (Ident "x")) (Var (Ident "type"))) ([])) (CallFunction (Var (Ident "B")) ((:) ((:) (ListEnum ((:) (Var (Ident "x")) ([]))) ([])) ([]))))) ((:) (FunCase ((:) ((:) (VarPat (Ident "s")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "out")) ((:) (OutComm (CallBuiltIn (BuiltIn (F_head)) ((:) ((:) (Var (Ident "s")) ([])) ([])))) ([])) (CallFunction (Var (Ident "B")) ((:) ((:) (CallBuiltIn (BuiltIn (F_tail)) ((:) ((:) (Var (Ident "s")) ([])) ([]))) ([])) ([])))) (Parens (Fun2 (BuiltIn (F_IntChoice)) (Stop) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Fun1 (BuiltIn (F_Len2)) (Var (Ident "s"))) (Var (Ident "n"))) (PrefixExp (Var (Ident "in")) ((:) (InCommGuarded (VarPat (Ident "x2")) (Var (Ident "type"))) ([])) (CallFunction (Var (Ident "B")) ((:) ((:) (Fun2 (BuiltIn (F_Concat)) (Var (Ident "s")) (ListEnum ((:) (Var (Ident "x2")) ([])))) ([])) ([]))))))))) ([])))) ([])) (CallFunction (Var (Ident "B")) ((:) ((:) (ListEnum ([])) ([])) ([]))))) ([]))) ((:) (FunBind (Ident "FAULTY") ((:) (FunCase ((:) ((:) (VarPat (Ident "n2")) ((:) (VarPat (Ident "in2")) ((:) (VarPat (Ident "out2")) ((:) (VarPat (Ident "type2")) ([]))))) ([])) (Let ((:) (PatBind (VarPat (Ident "PassRate")) (IntExp (3))) ((:) (FunBind (Ident "B2") ((:) (FunCase ((:) ((:) (ListEnumPat ([])) ((:) (VarPat (Ident "since_last")) ([]))) ([])) (PrefixExp (Var (Ident "in2")) ((:) (InCommGuarded (VarPat (Ident "x3")) (Var (Ident "type2"))) ([])) (CallFunction (Var (Ident "A2")) ((:) ((:) (ListEnum ([])) ((:) (Var (Ident "since_last")) ((:) (Var (Ident "x3")) ([])))) ([]))))) ((:) (FunCase ((:) ((:) (VarPat (Ident "s2")) ((:) (VarPat (Ident "since_last2")) ([]))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "out2")) ((:) (OutComm (CallBuiltIn (BuiltIn (F_head)) ((:) ((:) (Var (Ident "s2")) ([])) ([])))) ([])) (CallFunction (Var (Ident "B2")) ((:) ((:) (CallBuiltIn (BuiltIn (F_tail)) ((:) ((:) (Var (Ident "s2")) ([])) ([]))) ((:) (Var (Ident "since_last2")) ([]))) ([])))) (Parens (Fun2 (BuiltIn (F_IntChoice)) (Stop) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Fun1 (BuiltIn (F_Len2)) (Var (Ident "s2"))) (Var (Ident "n2"))) (PrefixExp (Var (Ident "in2")) ((:) (InCommGuarded (VarPat (Ident "x4")) (Var (Ident "type2"))) ([])) (CallFunction (Var (Ident "A2")) ((:) ((:) (Var (Ident "s2")) ((:) (Var (Ident "since_last2")) ((:) (Var (Ident "x4")) ([])))) ([]))))))))) ([])))) ((:) (FunBind (Ident "A2") ((:) (FunCase ((:) ((:) (VarPat (Ident "s3")) ((:) (VarPat (Ident "since_last3")) ((:) (VarPat (Ident "x5")) ([])))) ([])) (Ifte (Fun2 (BuiltIn (F_LT)) (Var (Ident "since_last3")) (Var (Ident "PassRate"))) (Fun2 (BuiltIn (F_IntChoice)) (CallFunction (Var (Ident "B2")) ((:) ((:) (Fun2 (BuiltIn (F_Concat)) (Var (Ident "s3")) (ListEnum ((:) (Var (Ident "x5")) ([])))) ((:) (IntExp (0)) ([]))) ([]))) (CallFunction (Var (Ident "B2")) ((:) ((:) (Var (Ident "s3")) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "since_last3")) (IntExp (1))) ([]))) ([])))) (CallFunction (Var (Ident "B2")) ((:) ((:) (Fun2 (BuiltIn (F_Concat)) (Var (Ident "s3")) (ListEnum ((:) (Var (Ident "x5")) ([])))) ((:) (IntExp (0)) ([]))) ([]))))) ([]))) ([])))) (CallFunction (Var (Ident "B2")) ((:) ((:) (ListEnum ([])) ((:) (IntExp (0)) ([]))) ([]))))) ([]))) ((:) (DataType (Ident "Connection_Data") ((:) (Constructor (Ident "bit") (Just (TypeDot ((:) (SetEnum ((:) (IntExp (0)) ((:) (IntExp (1)) ([])))) ([]))))) ([]))) ((:) (DataType (Ident "Host") ((:) (Constructor (Ident "newton") (Nothing)) ((:) (Constructor (Ident "goedel") (Nothing)) ([])))) ((:) (NameType (Ident "Port") (TypeDot ((:) (SetClose ((,) (IntExp (0)) (IntExp (2)))) ([])))) ((:) (NameType (Ident "Connection_Addr") (TypeDot ((:) (Var (Ident "Host")) ((:) (Var (Ident "Port")) ([]))))) ((:) (Channel ((:) (Ident "connection") ([])) (Just (TypeDot ((:) (Var (Ident "Connection_Addr")) ((:) (Var (Ident "Connection_Data")) ([])))))) ((:) (PatBind (VarPat (Ident "Connections")) (SetEnum ((:) (TupleExp ((:) (DotTuple ((:) (Var (Ident "newton")) ((:) (IntExp (0)) ([])))) ((:) (DotTuple ((:) (Var (Ident "goedel")) ((:) (IntExp (1)) ([])))) ([])))) ((:) (TupleExp ((:) (DotTuple ((:) (Var (Ident "goedel")) ((:) (IntExp (0)) ([])))) ((:) (DotTuple ((:) (Var (Ident "newton")) ((:) (IntExp (1)) ([])))) ([])))) ((:) (TupleExp ((:) (DotTuple ((:) (Var (Ident "newton")) ((:) (IntExp (2)) ([])))) ((:) (DotTuple ((:) (Var (Ident "goedel")) ((:) (IntExp (2)) ([])))) ([])))) ([])))))) ((:) (PatBind (VarPat (Ident "ConnectionService")) (Let ((:) (FunBind (Ident "Buff") ((:) (FunCase ((:) ((:) (VarPat (Ident "read")) ((:) (VarPat (Ident "write")) ([]))) ([])) (PrefixExp (Var (Ident "read")) ((:) (InComm (VarPat (Ident "x6"))) ([])) (PrefixExp (Var (Ident "write")) ((:) (OutComm (Var (Ident "x6"))) ([])) (CallFunction (Var (Ident "Buff")) ((:) ((:) (Var (Ident "read")) ((:) (Var (Ident "write")) ([]))) ([])))))) ([]))) ([])) (ProcRepInterleave ((:) (Generator (TuplePat ((:) (VarPat (Ident "s4")) ((:) (VarPat (Ident "d")) ([])))) (Var (Ident "Connections"))) ([])) (CallFunction (Var (Ident "Buff")) ((:) ((:) (DotTuple ((:) (Var (Ident "connection")) ((:) (Var (Ident "s4")) ([])))) ((:) (DotTuple ((:) (Var (Ident "connection")) ((:) (Var (Ident "d")) ([])))) ([]))) ([])))))) ((:) (DataType (Ident "Network_Data") ((:) (Constructor (Ident "CAck") (Nothing)) ((:) (Constructor (Ident "CData") (Just (TypeDot ((:) (Var (Ident "Connection_Data")) ([]))))) ([])))) ((:) (PatBind (VarPat (Ident "Network_Data_Fwd")) (Closure ((:) (Var (Ident "CData")) ([])))) ((:) (PatBind (VarPat (Ident "Network_Data_Rev")) (CallBuiltIn (BuiltIn (F_diff)) ((:) ((:) (Var (Ident "Network_Data")) ((:) (Var (Ident "Network_Data_Fwd")) ([]))) ([])))) ((:) (PatBind (VarPat (Ident "Network_Addr")) (Var (Ident "Connection_Addr"))) ((:) (FunBind (Ident "hostof") ((:) (FunCase ((:) ((:) (VarPat (Ident "h")) ((:) (VarPat (Ident "p")) ([]))) ([])) (Var (Ident "h"))) ([]))) ((:) (Channel ((:) (Ident "network") ([])) (Just (TypeDot ((:) (Var (Ident "Network_Addr")) ((:) (Var (Ident "Network_Data")) ([])))))) ((:) (PatBind (VarPat (Ident "NetworkService")) (ProcRepInterleave ((:) (Generator (TuplePat ((:) (VarPat (Ident "s5")) ((:) (VarPat (Ident "d2")) ([])))) (Var (Ident "Connections"))) ([])) (Parens (Fun2 (BuiltIn (F_Interleave)) (CallFunction (Var (Ident "BUFFER")) ((:) ((:) (IntExp (3)) ((:) (DotTuple ((:) (Var (Ident "network")) ((:) (Var (Ident "s5")) ([])))) ((:) (DotTuple ((:) (Var (Ident "network")) ((:) (Var (Ident "d2")) ([])))) ((:) (Var (Ident "Network_Data_Fwd")) ([]))))) ([]))) (CallFunction (Var (Ident "BUFFER")) ((:) ((:) (IntExp (3)) ((:) (DotTuple ((:) (Var (Ident "network")) ((:) (Var (Ident "d2")) ([])))) ((:) (DotTuple ((:) (Var (Ident "network")) ((:) (Var (Ident "s5")) ([])))) ((:) (Var (Ident "Network_Data_Rev")) ([]))))) ([]))))))) ((:) (FunBind (Ident "inports") ((:) (FunCase ((:) ((:) (VarPat (Ident "host")) ([])) ([])) (SetComprehension ((,) ((:) (Var (Ident "s6")) ([])) ((:) (Generator (TuplePat ((:) (VarPat (Ident "s6")) ((:) (WildCard) ([])))) (Var (Ident "Connections"))) ((:) (Guard (Fun2 (BuiltIn (F_Eq)) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "s6")) ([])) ([]))) (Var (Ident "host")))) ([])))))) ([]))) ((:) (FunBind (Ident "outports") ((:) (FunCase ((:) ((:) (VarPat (Ident "host2")) ([])) ([])) (SetComprehension ((,) ((:) (Var (Ident "d3")) ([])) ((:) (Generator (TuplePat ((:) (WildCard) ((:) (VarPat (Ident "d3")) ([])))) (Var (Ident "Connections"))) ((:) (Guard (Fun2 (BuiltIn (F_Eq)) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "d3")) ([])) ([]))) (Var (Ident "host2")))) ([])))))) ([]))) ((:) (PatBind (VarPat (Ident "ConImp")) (Let ((:) (FunBind (Ident "InPort") ((:) (FunCase ((:) ((:) (VarPat (Ident "addr")) ([])) ([])) (PrefixExp (Var (Ident "connection")) ((:) (OutComm (Var (Ident "addr"))) ((:) (InComm (VarPat (Ident "v"))) ([]))) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "addr"))) ((:) (OutComm (Var (Ident "CData"))) ((:) (OutComm (Var (Ident "v"))) ([])))) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "addr"))) ((:) (OutComm (Var (Ident "CAck"))) ([]))) (CallFunction (Var (Ident "InPort")) ((:) ((:) (Var (Ident "addr")) ([])) ([]))))))) ([]))) ((:) (FunBind (Ident "OutPort") ((:) (FunCase ((:) ((:) (VarPat (Ident "addr2")) ([])) ([])) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "addr2"))) ((:) (OutComm (Var (Ident "CData"))) ((:) (InComm (VarPat (Ident "v2"))) ([])))) (PrefixExp (Var (Ident "connection")) ((:) (OutComm (Var (Ident "addr2"))) ((:) (OutComm (Var (Ident "v2"))) ([]))) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "addr2"))) ((:) (OutComm (Var (Ident "CAck"))) ([]))) (CallFunction (Var (Ident "OutPort")) ((:) ((:) (Var (Ident "addr2")) ([])) ([]))))))) ([]))) ((:) (FunBind (Ident "Ports") ((:) (FunCase ((:) ((:) (VarPat (Ident "host3")) ([])) ([])) (Fun2 (BuiltIn (F_Interleave)) (Parens (ProcRepInterleave ((:) (Generator (VarPat (Ident "s7")) (CallFunction (Var (Ident "inports")) ((:) ((:) (Var (Ident "host3")) ([])) ([])))) ([])) (CallFunction (Var (Ident "InPort")) ((:) ((:) (Var (Ident "s7")) ([])) ([]))))) (Parens (ProcRepInterleave ((:) (Generator (VarPat (Ident "d4")) (CallFunction (Var (Ident "outports")) ((:) ((:) (Var (Ident "host3")) ([])) ([])))) ([])) (CallFunction (Var (Ident "OutPort")) ((:) ((:) (Var (Ident "d4")) ([])) ([]))))))) ([]))) ([])))) (ProcRepInterleave ((:) (Generator (VarPat (Ident "h2")) (Var (Ident "Host"))) ([])) (CallFunction (Var (Ident "Ports")) ((:) ((:) (Var (Ident "h2")) ([])) ([])))))) ((:) (PatBind (VarPat (Ident "ConnectionLayer1")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "ConImp")) ((:) (Closure ((:) (Var (Ident "network")) ([]))) ((:) (Var (Ident "NetworkService")) ([])))) ([])))) ((:) (AssertRef (Var (Ident "ConnectionService")) "k" (Var (Ident "ConnectionLayer1"))) ((:) (DataType (Ident "Direction") ((:) (Constructor (Ident "Inbound") (Nothing)) ((:) (Constructor (Ident "Outbound") (Nothing)) ([])))) ((:) (NameType (Ident "Transport_Addr") (TypeDot ((:) (Var (Ident "Host")) ((:) (Var (Ident "Direction")) ([]))))) ((:) (NameType (Ident "Transport_Data") (TypeDot ((:) (Var (Ident "Connection_Addr")) ((:) (Var (Ident "Network_Data")) ([]))))) ((:) (Channel ((:) (Ident "transport") ([])) (Just (TypeDot ((:) (Var (Ident "Transport_Addr")) ((:) (Var (Ident "Transport_Data")) ([])))))) ((:) (FunBind (Ident "remoteport") ((:) (FunCase ((:) ((:) (VarPat (Ident "p2")) ([])) ([])) (Let ((:) (FunBind (Ident "uniq") ((:) (FunCase ((:) ((:) (SingleSetPat (VarPat (Ident "x7"))) ([])) ([])) (Var (Ident "x7"))) ([]))) ((:) (PatBind (VarPat (Ident "others")) (SetComprehension ((,) ((:) (Ifte (Fun2 (BuiltIn (F_Eq)) (Var (Ident "p2")) (Var (Ident "s8"))) (Var (Ident "d5")) (Var (Ident "s8"))) ([])) ((:) (Generator (TuplePat ((:) (VarPat (Ident "s8")) ((:) (VarPat (Ident "d5")) ([])))) (Var (Ident "Connections"))) ((:) (Guard (OrExp (Fun2 (BuiltIn (F_Eq)) (Var (Ident "p2")) (Var (Ident "s8"))) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "p2")) (Var (Ident "d5"))))) ([])))))) ([]))) (CallFunction (Var (Ident "uniq")) ((:) ((:) (Var (Ident "others")) ([])) ([]))))) ([]))) ((:) (FunBind (Ident "Transport_Data_Sent") ((:) (FunCase ((:) ((:) (VarPat (Ident "host4")) ([])) ([])) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (SetComprehension ((,) ((:) (DotTuple ((:) (CallFunction (Var (Ident "remoteport")) ((:) ((:) (Var (Ident "p3")) ([])) ([]))) ((:) (Var (Ident "d6")) ([])))) ([])) ((:) (Generator (VarPat (Ident "d6")) (Var (Ident "Network_Data_Fwd"))) ((:) (Generator (VarPat (Ident "p3")) (CallFunction (Var (Ident "inports")) ((:) ((:) (Var (Ident "host4")) ([])) ([])))) ([]))))) ((:) (SetComprehension ((,) ((:) (DotTuple ((:) (CallFunction (Var (Ident "remoteport")) ((:) ((:) (Var (Ident "p4")) ([])) ([]))) ((:) (Var (Ident "d7")) ([])))) ([])) ((:) (Generator (VarPat (Ident "d7")) (Var (Ident "Network_Data_Rev"))) ((:) (Generator (VarPat (Ident "p4")) (CallFunction (Var (Ident "outports")) ((:) ((:) (Var (Ident "host4")) ([])) ([])))) ([]))))) ([]))) ([])))) ([]))) ((:) (FunBind (Ident "Transport_Data_Recd") ((:) (FunCase ((:) ((:) (VarPat (Ident "host5")) ([])) ([])) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (SetComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "p5")) ((:) (Var (Ident "d8")) ([])))) ([])) ((:) (Generator (VarPat (Ident "d8")) (Var (Ident "Network_Data_Fwd"))) ((:) (Generator (VarPat (Ident "p5")) (CallFunction (Var (Ident "outports")) ((:) ((:) (Var (Ident "host5")) ([])) ([])))) ([]))))) ((:) (SetComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "p6")) ((:) (Var (Ident "d9")) ([])))) ([])) ((:) (Generator (VarPat (Ident "d9")) (Var (Ident "Network_Data_Rev"))) ((:) (Generator (VarPat (Ident "p6")) (CallFunction (Var (Ident "inports")) ((:) ((:) (Var (Ident "host5")) ([])) ([])))) ([]))))) ([]))) ([])))) ([]))) ((:) (PatBind (VarPat (Ident "TransportService")) (ProcRepInterleave ((:) (Generator (VarPat (Ident "s9")) (Var (Ident "Host"))) ((:) (Generator (VarPat (Ident "d143")) (Var (Ident "Host"))) ((:) (Guard (Fun2 (BuiltIn (F_NEq)) (Var (Ident "s9")) (Var (Ident "d143")))) ([])))) (CallFunction (Var (Ident "BUFFER")) ((:) ((:) (IntExp (1)) ((:) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "s9")) ((:) (Var (Ident "Outbound")) ([]))))) ((:) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "d143")) ((:) (Var (Ident "Inbound")) ([]))))) ((:) (CallBuiltIn (BuiltIn (F_inter)) ((:) ((:) (CallFunction (Var (Ident "Transport_Data_Sent")) ((:) ((:) (Var (Ident "s9")) ([])) ([]))) ((:) (CallFunction (Var (Ident "Transport_Data_Recd")) ((:) ((:) (Var (Ident "d143")) ([])) ([]))) ([]))) ([]))) ([]))))) ([]))))) ((:) (PatBind (VarPat (Ident "NetImp")) (Let ((:) (FunBind (Ident "NetworkTransmitter") ((:) (FunCase ((:) ((:) (VarPat (Ident "host6")) ([])) ([])) (Let ((:) (PatBind (VarPat (Ident "th")) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "host6")) ((:) (Var (Ident "Outbound")) ([])))))) ((:) (PatBind (VarPat (Ident "NT")) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (ProcRepChoice ((:) (Generator (VarPat (Ident "p7")) (CallFunction (Var (Ident "inports")) ((:) ((:) (Var (Ident "host6")) ([])) ([])))) ([])) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "p7"))) ((:) (InCommGuarded (VarPat (Ident "d150")) (Var (Ident "Network_Data_Fwd"))) ([]))) (PrefixExp (Var (Ident "th")) ((:) (OutComm (CallFunction (Var (Ident "remoteport")) ((:) ((:) (Var (Ident "p7")) ([])) ([])))) ((:) (OutComm (Var (Ident "d150"))) ([]))) (Var (Ident "NT")))))) (Parens (ProcRepChoice ((:) (Generator (VarPat (Ident "p8")) (CallFunction (Var (Ident "outports")) ((:) ((:) (Var (Ident "host6")) ([])) ([])))) ([])) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "p8"))) ((:) (InCommGuarded (VarPat (Ident "d152")) (Var (Ident "Network_Data_Rev"))) ([]))) (PrefixExp (Var (Ident "th")) ((:) (OutComm (CallFunction (Var (Ident "remoteport")) ((:) ((:) (Var (Ident "p8")) ([])) ([])))) ((:) (OutComm (Var (Ident "d152"))) ([]))) (Var (Ident "NT")))))))) ([]))) (Var (Ident "NT")))) ([]))) ((:) (FunBind (Ident "NetworkReceiver") ((:) (FunCase ((:) ((:) (VarPat (Ident "host7")) ([])) ([])) (Let ((:) (PatBind (VarPat (Ident "th2")) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "host7")) ((:) (Var (Ident "Inbound")) ([])))))) ((:) (PatBind (VarPat (Ident "NR")) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (ProcRepChoice ((:) (Generator (VarPat (Ident "p9")) (CallFunction (Var (Ident "outports")) ((:) ((:) (Var (Ident "host7")) ([])) ([])))) ([])) (PrefixExp (Var (Ident "th2")) ((:) (OutComm (Var (Ident "p9"))) ((:) (InCommGuarded (VarPat (Ident "d157")) (Var (Ident "Network_Data_Fwd"))) ([]))) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "p9"))) ((:) (OutComm (Var (Ident "d157"))) ([]))) (Var (Ident "NR")))))) (Parens (ProcRepChoice ((:) (Generator (VarPat (Ident "p158")) (CallFunction (Var (Ident "inports")) ((:) ((:) (Var (Ident "host7")) ([])) ([])))) ([])) (PrefixExp (Var (Ident "th2")) ((:) (OutComm (Var (Ident "p158"))) ((:) (InCommGuarded (VarPat (Ident "d159")) (Var (Ident "Network_Data_Rev"))) ([]))) (PrefixExp (Var (Ident "network")) ((:) (OutComm (Var (Ident "p158"))) ((:) (OutComm (Var (Ident "d159"))) ([]))) (Var (Ident "NR")))))))) ([]))) (Var (Ident "NR")))) ([]))) ([]))) (ProcRepInterleave ((:) (Generator (VarPat (Ident "h3")) (Var (Ident "Host"))) ([])) (Parens (Fun2 (BuiltIn (F_Interleave)) (CallFunction (Var (Ident "NetworkTransmitter")) ((:) ((:) (Var (Ident "h3")) ([])) ([]))) (CallFunction (Var (Ident "NetworkReceiver")) ((:) ((:) (Var (Ident "h3")) ([])) ([])))))))) ((:) (PatBind (VarPat (Ident "NetworkLayer1")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "NetImp")) ((:) (Closure ((:) (Var (Ident "transport")) ([]))) ((:) (Var (Ident "TransportService")) ([])))) ([])))) ((:) (PatBind (VarPat (Ident "ConnectionLayer2")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "ConImp")) ((:) (Closure ((:) (Var (Ident "network")) ([]))) ((:) (Var (Ident "NetworkLayer1")) ([])))) ([])))) ((:) (AssertRef (Var (Ident "ConnectionService")) "k" (Var (Ident "ConnectionLayer2"))) ((:) (DataType (Ident "MySeq") ((:) (Constructor (Ident "seq0") (Nothing)) ((:) (Constructor (Ident "seq1") (Nothing)) ([])))) ((:) (FunBind (Ident "seq_next") ((:) (FunCase ((:) ((:) (VarPat (Ident "seq0")) ([])) ([])) (Var (Ident "seq1"))) ((:) (FunCase ((:) ((:) (VarPat (Ident "seq1")) ([])) ([])) (Var (Ident "seq0"))) ([])))) ((:) (DataType (Ident "Transport_Primitive") ((:) (Constructor (Ident "TAck") (Just (TypeDot ((:) (Var (Ident "MySeq")) ([]))))) ((:) (Constructor (Ident "TData") (Just (TypeDot ((:) (Var (Ident "MySeq")) ((:) (Var (Ident "Transport_Data")) ([])))))) ([])))) ((:) (PatBind (VarPat (Ident "Packet_Data")) (Var (Ident "Transport_Primitive"))) ((:) (DataType (Ident "Function") ((:) (Constructor (Ident "Forward") (Nothing)) ((:) (Constructor (Ident "Reverse") (Nothing)) ([])))) ((:) (NameType (Ident "Packet_Addr") (TypeDot ((:) (Var (Ident "Host")) ((:) (Var (Ident "Direction")) ((:) (Var (Ident "Function")) ([])))))) ((:) (Channel ((:) (Ident "packet") ([])) (Just (TypeDot ((:) (Var (Ident "Packet_Addr")) ((:) (Var (Ident "Packet_Data")) ([])))))) ((:) (FunBind (Ident "Packet_Data_Sent") ((:) (FunCase ((:) ((:) (VarPat (Ident "host8")) ([])) ([])) (SetComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "TData")) ((:) (Var (Ident "s162")) ((:) (Var (Ident "d163")) ([]))))) ([])) ((:) (Generator (VarPat (Ident "s162")) (Var (Ident "MySeq"))) ((:) (Generator (VarPat (Ident "d163")) (CallFunction (Var (Ident "Transport_Data_Sent")) ((:) ((:) (Var (Ident "host8")) ([])) ([])))) ([])))))) ([]))) ((:) (FunBind (Ident "Packet_Data_Recd") ((:) (FunCase ((:) ((:) (VarPat (Ident "host9")) ([])) ([])) (SetComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "TData")) ((:) (Var (Ident "s165")) ((:) (Var (Ident "d166")) ([]))))) ([])) ((:) (Generator (VarPat (Ident "s165")) (Var (Ident "MySeq"))) ((:) (Generator (VarPat (Ident "d166")) (CallFunction (Var (Ident "Transport_Data_Recd")) ((:) ((:) (Var (Ident "host9")) ([])) ([])))) ([])))))) ([]))) ((:) (FunBind (Ident "PacketPair") ((:) (FunCase ((:) ((:) (VarPat (Ident "s167")) ((:) (VarPat (Ident "d168")) ([]))) ([])) (Fun2 (BuiltIn (F_Interleave)) (CallFunction (Var (Ident "FAULTY")) ((:) ((:) (IntExp (1)) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "s167")) ((:) (Var (Ident "Forward")) ([]))))) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "d168")) ((:) (Var (Ident "Forward")) ([]))))) ((:) (CallBuiltIn (BuiltIn (F_inter)) ((:) ((:) (CallFunction (Var (Ident "Packet_Data_Sent")) ((:) ((:) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "s167")) ([])) ([]))) ([])) ([]))) ((:) (CallFunction (Var (Ident "Packet_Data_Recd")) ((:) ((:) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "d168")) ([])) ([]))) ([])) ([]))) ([]))) ([]))) ([]))))) ([]))) (CallFunction (Var (Ident "FAULTY")) ((:) ((:) (IntExp (1)) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "d168")) ((:) (Var (Ident "Reverse")) ([]))))) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "s167")) ((:) (Var (Ident "Reverse")) ([]))))) ((:) (Closure ((:) (Var (Ident "TAck")) ([]))) ([]))))) ([]))))) ([]))) ((:) (PatBind (VarPat (Ident "PacketService")) (ProcRepInterleave ((:) (Generator (VarPat (Ident "s169")) (Var (Ident "Host"))) ((:) (Generator (VarPat (Ident "d170")) (Var (Ident "Host"))) ((:) (Guard (Fun2 (BuiltIn (F_NEq)) (Var (Ident "s169")) (Var (Ident "d170")))) ([])))) (CallFunction (Var (Ident "PacketPair")) ((:) ((:) (DotTuple ((:) (Var (Ident "s169")) ((:) (Var (Ident "Outbound")) ([])))) ((:) (DotTuple ((:) (Var (Ident "d170")) ((:) (Var (Ident "Inbound")) ([])))) ([]))) ([]))))) ((:) (FunBind (Ident "TransportSender") ((:) (FunCase ((:) ((:) (VarPat (Ident "taddr")) ([])) ([])) (Let ((:) (PatBind (VarPat (Ident "h4")) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "taddr")) ([])) ([])))) ((:) (FunBind (Ident "TS") ((:) (FunCase ((:) ((:) (VarPat (Ident "vs")) ((:) (VarPat (Ident "seq")) ([]))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Ifte (CallBuiltIn (BuiltIn (F_null)) ((:) ((:) (Var (Ident "vs")) ([])) ([]))) (PrefixExp (Var (Ident "transport")) ((:) (OutComm (Var (Ident "taddr"))) ((:) (InCommGuarded (VarPat (Ident "tdata")) (CallFunction (Var (Ident "Transport_Data_Sent")) ((:) ((:) (Var (Ident "h4")) ([])) ([])))) ([]))) (CallFunction (Var (Ident "TS")) ((:) ((:) (ListEnum ((:) (Var (Ident "tdata")) ([]))) ((:) (CallFunction (Var (Ident "seq_next")) ((:) ((:) (Var (Ident "seq")) ([])) ([]))) ([]))) ([])))) (PrefixExp (Var (Ident "packet")) ((:) (OutComm (Var (Ident "taddr"))) ((:) (OutComm (Var (Ident "Forward"))) ((:) (OutComm (Var (Ident "TData"))) ((:) (OutComm (Var (Ident "seq"))) ((:) (OutComm (CallBuiltIn (BuiltIn (F_head)) ((:) ((:) (Var (Ident "vs")) ([])) ([])))) ([])))))) (CallFunction (Var (Ident "TS")) ((:) ((:) (Var (Ident "vs")) ((:) (Var (Ident "seq")) ([]))) ([])))))) (Parens (PrefixExp (Var (Ident "packet")) ((:) (OutComm (Var (Ident "taddr"))) ((:) (OutComm (Var (Ident "Reverse"))) ((:) (OutComm (Var (Ident "TAck"))) ((:) (InComm (VarPat (Ident "s177"))) ([]))))) (CallFunction (Var (Ident "TS")) ((:) ((:) (Ifte (Fun2 (BuiltIn (F_Eq)) (Var (Ident "s177")) (Var (Ident "seq"))) (ListEnum ([])) (Var (Ident "vs"))) ((:) (Var (Ident "seq")) ([]))) ([]))))))) ([]))) ([]))) (CallFunction (Var (Ident "TS")) ((:) ((:) (ListEnum ([])) ((:) (Var (Ident "seq1")) ([]))) ([]))))) ([]))) ((:) (FunBind (Ident "TransportReceiver") ((:) (FunCase ((:) ((:) (VarPat (Ident "taddr2")) ([])) ([])) (Let ((:) (PatBind (VarPat (Ident "h5")) (CallFunction (Var (Ident "hostof")) ((:) ((:) (Var (Ident "taddr2")) ([])) ([])))) ((:) (FunBind (Ident "TR") ((:) (FunCase ((:) ((:) (VarPat (Ident "seq2")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "packet")) ((:) (OutComm (Var (Ident "taddr2"))) ((:) (OutComm (Var (Ident "Reverse"))) ((:) (OutComm (Var (Ident "TAck"))) ((:) (OutComm (CallFunction (Var (Ident "seq_next")) ((:) ((:) (Var (Ident "seq2")) ([])) ([])))) ([]))))) (CallFunction (Var (Ident "TR")) ((:) ((:) (Var (Ident "seq2")) ([])) ([])))) (PrefixExp (Var (Ident "packet")) ((:) (OutComm (Var (Ident "taddr2"))) ((:) (OutComm (Var (Ident "Forward"))) ((:) (OutComm (Var (Ident "TData"))) ((:) (InComm (VarPat (Ident "s182"))) ((:) (InCommGuarded (VarPat (Ident "v3")) (CallFunction (Var (Ident "Transport_Data_Recd")) ((:) ((:) (Var (Ident "h5")) ([])) ([])))) ([])))))) (Ifte (Fun2 (BuiltIn (F_Eq)) (Var (Ident "s182")) (Var (Ident "seq2"))) (PrefixExp (Var (Ident "transport")) ((:) (OutComm (Var (Ident "taddr2"))) ((:) (OutComm (Var (Ident "v3"))) ([]))) (CallFunction (Var (Ident "TR")) ((:) ((:) (CallFunction (Var (Ident "seq_next")) ((:) ((:) (Var (Ident "seq2")) ([])) ([]))) ([])) ([])))) (CallFunction (Var (Ident "TR")) ((:) ((:) (Var (Ident "seq2")) ([])) ([]))))))) ([]))) ([]))) (CallFunction (Var (Ident "TR")) ((:) ((:) (Var (Ident "seq0")) ([])) ([]))))) ([]))) ((:) (FunBind (Ident "SenderInterface") ((:) (FunCase ((:) ((:) (VarPat (Ident "h6")) ([])) ([])) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "h6")) ((:) (Var (Ident "Outbound")) ((:) (Var (Ident "Forward")) ((:) (Var (Ident "d185")) ([]))))))) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "h6")) ((:) (Var (Ident "Outbound")) ((:) (Var (Ident "Reverse")) ((:) (Var (Ident "TAck")) ([]))))))) ([]))) ((:) (Generator (VarPat (Ident "d185")) (CallFunction (Var (Ident "Packet_Data_Sent")) ((:) ((:) (Var (Ident "h6")) ([])) ([])))) ([]))))) ([]))) ((:) (FunBind (Ident "ReceiverInterface") ((:) (FunCase ((:) ((:) (VarPat (Ident "h7")) ([])) ([])) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "h7")) ((:) (Var (Ident "Inbound")) ((:) (Var (Ident "Forward")) ((:) (Var (Ident "d187")) ([]))))))) ((:) (DotTuple ((:) (Var (Ident "packet")) ((:) (Var (Ident "h7")) ((:) (Var (Ident "Inbound")) ((:) (Var (Ident "Reverse")) ((:) (Var (Ident "TAck")) ([]))))))) ([]))) ((:) (Generator (VarPat (Ident "d187")) (CallFunction (Var (Ident "Packet_Data_Recd")) ((:) ((:) (Var (Ident "h7")) ([])) ([])))) ([]))))) ([]))) ((:) (PatBind (VarPat (Ident "TransportLayer")) (Let ((:) (FunBind (Ident "Trans") ((:) (FunCase ((:) ((:) (VarPat (Ident "s189")) ((:) (VarPat (Ident "d190")) ([]))) ([])) (Let ((:) (PatBind (VarPat (Ident "si")) (CallFunction (Var (Ident "SenderInterface")) ((:) ((:) (Var (Ident "s189")) ([])) ([])))) ((:) (PatBind (VarPat (Ident "ri")) (CallFunction (Var (Ident "ReceiverInterface")) ((:) ((:) (Var (Ident "d190")) ([])) ([])))) ((:) (PatBind (VarPat (Ident "sr")) (Fun2 (BuiltIn (F_Interleave)) (CallFunction (Var (Ident "TransportSender")) ((:) ((:) (DotTuple ((:) (Var (Ident "s189")) ((:) (Var (Ident "Outbound")) ([])))) ([])) ([]))) (CallFunction (Var (Ident "TransportReceiver")) ((:) ((:) (DotTuple ((:) (Var (Ident "d190")) ((:) (Var (Ident "Inbound")) ([])))) ([])) ([]))))) ([])))) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "sr")) ((:) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (Var (Ident "si")) ((:) (Var (Ident "ri")) ([]))) ([]))) ((:) (CallFunction (Var (Ident "PacketPair")) ((:) ((:) (DotTuple ((:) (Var (Ident "s189")) ((:) (Var (Ident "Outbound")) ([])))) ((:) (DotTuple ((:) (Var (Ident "d190")) ((:) (Var (Ident "Inbound")) ([])))) ([]))) ([]))) ([])))) ([]))))) ([]))) ([])) (ProcRepInterleave ((:) (Generator (VarPat (Ident "s194")) (Var (Ident "Host"))) ((:) (Generator (VarPat (Ident "d195")) (Var (Ident "Host"))) ((:) (Guard (Fun2 (BuiltIn (F_NEq)) (Var (Ident "s194")) (Var (Ident "d195")))) ([])))) (CallFunction (Var (Ident "normal")) ((:) ((:) (CallFunction (Var (Ident "Trans")) ((:) ((:) (Var (Ident "s194")) ((:) (Var (Ident "d195")) ([]))) ([]))) ([])) ([])))))) ((:) (AssertRef (Var (Ident "TransportService")) "k" (Var (Ident "TransportLayer"))) ((:) (PatBind (VarPat (Ident "NetworkLayer2")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "NetImp")) ((:) (Closure ((:) (Var (Ident "transport")) ([]))) ((:) (Var (Ident "TransportLayer")) ([])))) ([])))) ((:) (PatBind (VarPat (Ident "ConnectionLayer3")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "ConImp")) ((:) (Closure ((:) (Var (Ident "network")) ([]))) ((:) (Var (Ident "NetworkLayer2")) ([])))) ([])))) ((:) (AssertRef (Var (Ident "ConnectionService")) "k" (Var (Ident "ConnectionLayer3"))) ((:) (PatBind (VarPat (Ident "FaultyConnectionLayer")) (Let ((:) (PatBind (VarPat (Ident "FaultyTransportService")) (ProcRepInterleave ((:) (Generator (VarPat (Ident "s198")) (Var (Ident "Host"))) ((:) (Generator (VarPat (Ident "d199")) (Var (Ident "Host"))) ((:) (Guard (Fun2 (BuiltIn (F_NEq)) (Var (Ident "s198")) (Var (Ident "d199")))) ([])))) (CallFunction (Var (Ident "FAULTY")) ((:) ((:) (IntExp (1)) ((:) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "s198")) ((:) (Var (Ident "Outbound")) ([]))))) ((:) (DotTuple ((:) (Var (Ident "transport")) ((:) (Var (Ident "d199")) ((:) (Var (Ident "Inbound")) ([]))))) ((:) (CallBuiltIn (BuiltIn (F_inter)) ((:) ((:) (CallFunction (Var (Ident "Transport_Data_Sent")) ((:) ((:) (Var (Ident "s198")) ([])) ([]))) ((:) (CallFunction (Var (Ident "Transport_Data_Recd")) ((:) ((:) (Var (Ident "d199")) ([])) ([]))) ([]))) ([]))) ([]))))) ([]))))) ((:) (PatBind (VarPat (Ident "FaultyNetworkLayer")) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "NetImp")) ((:) (Closure ((:) (Var (Ident "transport")) ([]))) ((:) (Var (Ident "FaultyTransportService")) ([])))) ([])))) ([]))) (CallFunction (Var (Ident "wire")) ((:) ((:) (Var (Ident "ConImp")) ((:) (Closure ((:) (Var (Ident "network")) ([]))) ((:) (Var (Ident "FaultyNetworkLayer")) ([])))) ([]))))) ((:) (AssertRef (Var (Ident "ConnectionService")) "k" (Var (Ident "FaultyConnectionLayer"))) ([])))))))))))))))))))))))))))))))))))))))))))))))))))))))))) (Nothing))