(Module ((:) (PatBind (VarPat (Ident "QUEUENUM")) (SetClose ((,) (IntExp (1)) (Var (Ident "numQueues"))))) ((:) (DataType (Ident "CUSTOMER") ((:) (Constructor (Ident "c1") (Nothing)) ((:) (Constructor (Ident "c2") (Nothing)) ((:) (Constructor (Ident "c3") (Nothing)) ((:) (Constructor (Ident "c4") (Nothing)) ((:) (Constructor (Ident "c5") (Nothing)) ((:) (Constructor (Ident "c6") (Nothing)) ([])))))))) ((:) (DataType (Ident "STATUS") ((:) (Constructor (Ident "success") (Nothing)) ((:) (Constructor (Ident "fail") (Nothing)) ([])))) ((:) (DataType (Ident "QSTATUS") ((:) (Constructor (Ident "yes") (Nothing)) ((:) (Constructor (Ident "no") (Nothing)) ([])))) ((:) (PatBind (VarPat (Ident "maxLimit")) (IntExp (2))) ((:) (PatBind (VarPat (Ident "defaultCounter")) (IntExp (1))) ((:) (PatBind (VarPat (Ident "defaultCustomer")) (Var (Ident "c1"))) ((:) (PatBind (VarPat (Ident "maxQueueingCustomers")) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "maxLimit")) (IntExp (1)))) ((:) (PatBind (VarPat (Ident "numQueues")) (IntExp (3))) ((:) (Channel ((:) (Ident "enterBank") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "leaveBank") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "report") ([])) (Just (TypeDot ((:) (Var (Ident "STATUS")) ([]))))) ((:) (Channel ((:) (Ident "com1") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "com3") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "canJoinResponse") ([])) (Just (TypeDot ((:) (Var (Ident "STATUS")) ([]))))) ((:) (Channel ((:) (Ident "retrieveCustomer") ([])) (Nothing)) ((:) (Channel ((:) (Ident "joinQueue") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "leaveQueue") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ((:) (Var (Ident "CUSTOMER")) ([])))))) ((:) (Channel ((:) (Ident "queryQueueEmpty") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ((:) (Var (Ident "QSTATUS")) ([])))))) ((:) (FunBind (Ident "inc") ((:) (FunCase ((:) ((:) (VarPat (Ident "queueNo")) ([])) ([])) (Fun2 (BuiltIn (F_Add)) (Parens (Fun2 (BuiltIn (F_Mod)) (Var (Ident "queueNo")) (Var (Ident "numQueues")))) (IntExp (1)))) ([]))) ((:) (FunBind (Ident "dec") ((:) (FunCase ((:) ((:) (VarPat (Ident "queueNo2")) ([])) ([])) (Fun2 (BuiltIn (F_Add)) (Parens (Fun2 (BuiltIn (F_Mod)) (Parens (Fun2 (BuiltIn (F_Sub)) (Var (Ident "queueNo2")) (IntExp (2)))) (Var (Ident "numQueues")))) (IntExp (1)))) ([]))) ((:) (PatBind (VarPat (Ident "CounterCtrl")) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (IntExp (0)) ((:) (Var (Ident "defaultCustomer")) ([]))) ([])))) ((:) (FunBind (Ident "CurrentCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num")) ((:) (VarPat (Ident "currentCust")) ([]))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (CallFunction (Var (Ident "JoinCtrl")) ((:) ((:) (Var (Ident "num")) ((:) (Var (Ident "currentCust")) ([]))) ([]))) (CallFunction (Var (Ident "LeaveCtrl")) ((:) ((:) (Var (Ident "num")) ((:) (Var (Ident "currentCust")) ([]))) ([]))))) ([]))) ((:) (FunBind (Ident "JoinCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num2")) ((:) (VarPat (Ident "currentCust2")) ([]))) ([])) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "num2")) (Var (Ident "maxLimit"))) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "cc"))) ([])) (Parens (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "num2")) (IntExp (0))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num2")) (IntExp (1))) ((:) (Var (Ident "cc")) ([]))) ([])))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Parens (AndExp (Fun2 (BuiltIn (F_GT)) (Var (Ident "num2")) (IntExp (0))) (NotExp (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "cc")) (Var (Ident "currentCust2"))))))) (PrefixExp (Var (Ident "com1")) ((:) (OutComm (Var (Ident "cc"))) ([])) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (InComm (VarPat (Ident "bb"))) ([])) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "bb"))) ([])) (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "bb")) (Var (Ident "success")))) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num2")) (IntExp (1))) ((:) (Var (Ident "currentCust2")) ([]))) ([]))) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Var (Ident "num2")) ((:) (Var (Ident "currentCust2")) ([]))) ([])))))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Parens (AndExp (Fun2 (BuiltIn (F_GT)) (Var (Ident "num2")) (IntExp (0))) (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "cc")) (Var (Ident "currentCust2")))))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Var (Ident "num2")) ((:) (Var (Ident "currentCust2")) ([]))) ([]))))))))))) ([]))) ((:) (FunBind (Ident "LeaveCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num3")) ((:) (VarPat (Ident "currentCust3")) ([]))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "num3")) (IntExp (1))) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "currentCust3"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (IntExp (0)) ((:) (Var (Ident "defaultCustomer")) ([]))) ([])))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "num3")) (IntExp (1))) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "currentCust3"))) ([])) (PrefixExp (Var (Ident "retrieveCustomer")) ([]) (PrefixExp (Var (Ident "com3")) ((:) (InComm (VarPat (Ident "cc2"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "num3")) (IntExp (1))) ((:) (Var (Ident "cc2")) ([]))) ([])))))))))) ([]))) ((:) (PatBind (VarPat (Ident "QueuesCtrl")) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (IntExp (0)) ((:) (IntExp (1)) ((:) (SetEnum ([])) ([])))) ([])))) ((:) (FunBind (Ident "QCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "s")) ((:) (VarPat (Ident "queueNo3")) ((:) (VarPat (Ident "custSet")) ([])))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "s")) (Var (Ident "maxQueueingCustomers"))) (PrefixExp (Var (Ident "com1")) ((:) (InComm (VarPat (Ident "cc3"))) ([])) (Ifte (Parens (CallBuiltIn (BuiltIn (F_member)) ((:) ((:) (Var (Ident "cc3")) ((:) (Var (Ident "custSet")) ([]))) ([])))) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Var (Ident "s")) ((:) (Var (Ident "queueNo3")) ((:) (Var (Ident "custSet")) ([])))) ([])))) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (OutComm (Var (Ident "success"))) ([])) (PrefixExp (Var (Ident "joinQueue")) ((:) (OutComm (Var (Ident "cc3"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "s")) (IntExp (1))) ((:) (Var (Ident "queueNo3")) ((:) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (Var (Ident "custSet")) ((:) (SetEnum ((:) (Var (Ident "cc3")) ([]))) ([]))) ([]))) ([])))) ([]))))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "s")) (IntExp (0))) (PrefixExp (Var (Ident "retrieveCustomer")) ([]) (CallFunction (Var (Ident "NextQCtrl")) ((:) ((:) (Var (Ident "s")) ((:) (Var (Ident "queueNo3")) ((:) (CallFunction (Var (Ident "dec")) ((:) ((:) (Var (Ident "queueNo3")) ([])) ([]))) ((:) (Var (Ident "custSet")) ([]))))) ([])))))))) ([]))) ((:) (FunBind (Ident "NextQCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "s2")) ((:) (VarPat (Ident "queueNo4")) ((:) (VarPat (Ident "lastQueueNo")) ((:) (VarPat (Ident "custSet2")) ([]))))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (NotExp (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "queueNo4")) (Var (Ident "lastQueueNo"))))) (PrefixExp (Var (Ident "queryQueueEmpty")) ((:) (OutComm (Var (Ident "queueNo4"))) ((:) (InComm (VarPat (Ident "bb2"))) ([]))) (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "bb2")) (Var (Ident "no")))) (PrefixExp (Var (Ident "leaveQueue")) ((:) (OutComm (Var (Ident "queueNo4"))) ((:) (InComm (VarPat (Ident "cc4"))) ([]))) (Ifte (Parens (CallBuiltIn (BuiltIn (F_member)) ((:) ((:) (Var (Ident "cc4")) ((:) (Var (Ident "custSet2")) ([]))) ([])))) (PrefixExp (Var (Ident "com3")) ((:) (OutComm (Var (Ident "cc4"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "s2")) (IntExp (1))) ((:) (CallFunction (Var (Ident "inc")) ((:) ((:) (Var (Ident "queueNo4")) ([])) ([]))) ((:) (CallBuiltIn (BuiltIn (F_diff)) ((:) ((:) (Var (Ident "custSet2")) ((:) (SetEnum ((:) (Var (Ident "cc4")) ([]))) ([]))) ([]))) ([])))) ([])))) (Var (Ident "DIV")))) (CallFunction (Var (Ident "NextQCtrl")) ((:) ((:) (Var (Ident "s2")) ((:) (CallFunction (Var (Ident "inc")) ((:) ((:) (Var (Ident "queueNo4")) ([])) ([]))) ((:) (Var (Ident "lastQueueNo")) ((:) (Var (Ident "custSet2")) ([]))))) ([]))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "queueNo4")) (Var (Ident "lastQueueNo")))) (PrefixExp (Var (Ident "queryQueueEmpty")) ((:) (OutComm (Var (Ident "queueNo4"))) ((:) (OutComm (Var (Ident "no"))) ([]))) (PrefixExp (Var (Ident "leaveQueue")) ((:) (OutComm (Var (Ident "queueNo4"))) ((:) (InComm (VarPat (Ident "cc5"))) ([]))) (Parens (Ifte (Parens (CallBuiltIn (BuiltIn (F_member)) ((:) ((:) (Var (Ident "cc5")) ((:) (Var (Ident "custSet2")) ([]))) ([])))) (PrefixExp (Var (Ident "com3")) ((:) (OutComm (Var (Ident "cc5"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "s2")) (IntExp (1))) ((:) (CallFunction (Var (Ident "inc")) ((:) ((:) (Var (Ident "queueNo4")) ([])) ([]))) ((:) (CallBuiltIn (BuiltIn (F_diff)) ((:) ((:) (Var (Ident "custSet2")) ((:) (SetEnum ((:) (Var (Ident "cc5")) ([]))) ([]))) ([]))) ([])))) ([])))) (Var (Ident "DIV"))))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "queueNo4")) (Var (Ident "lastQueueNo")))) (PrefixExp (Var (Ident "queryQueueEmpty")) ((:) (OutComm (Var (Ident "queueNo4"))) ((:) (OutComm (Var (Ident "yes"))) ([]))) (Var (Ident "DIV"))))))) ([]))) ((:) (PatBind (VarPat (Ident "A")) (Closure ((:) (Var (Ident "com1")) ((:) (Var (Ident "com3")) ((:) (Var (Ident "canJoinResponse")) ((:) (Var (Ident "retrieveCustomer")) ([]))))))) ((:) (PatBind (VarPat (Ident "B")) (Closure ((:) (Var (Ident "joinQueue")) ((:) (Var (Ident "leaveQueue")) ((:) (Var (Ident "queryQueueEmpty")) ([])))))) ((:) (PatBind (VarPat (Ident "BankSystem")) (Fun2 (BuiltIn (F_Hiding)) (ProcSharing (Var (Ident "A")) (Var (Ident "CounterCtrl")) (Var (Ident "QueuesCtrl"))) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (Var (Ident "A")) ((:) (Var (Ident "B")) ([]))) ([]))))) ((:) (PatBind (VarPat (Ident "FullBankSystem")) (ProcSharing (Var (Ident "A")) (Var (Ident "CounterCtrl")) (Var (Ident "QueuesCtrl")))) ((:) (PatBind (VarPat (Ident "SPEC")) (ProcRepInterleave ((:) (Generator (VarPat (Ident "i")) (SetClose ((,) (IntExp (1)) (Var (Ident "maxLimit"))))) ([])) (Var (Ident "CUST")))) ((:) (PatBind (VarPat (Ident "CUST")) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "i2"))) ([])) (Parens (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (Var (Ident "CUST"))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "i2"))) ([])) (Var (Ident "CUST")))))))) ((:) (AssertRef (Var (Ident "SPEC")) "k" (Var (Ident "BankSystem"))) ((:) (AssertRef (Var (Ident "SPEC")) "k" (Var (Ident "BankSystem"))) ((:) (PatBind (VarPat (Ident "SPEC2")) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (IntExp (0)) ([])) ([])))) ((:) (FunBind (Ident "NEWSPEC") ((:) (FunCase ((:) ((:) (VarPat (Ident "num4")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "num4")) (Var (Ident "maxLimit"))) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "cc6"))) ([])) (Parens (Fun2 (BuiltIn (F_IntChoice)) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num4")) (IntExp (1))) ([])) ([])))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Var (Ident "num4")) ([])) ([])))))))) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "num4")) (IntExp (0))) (ProcRepInternalChoice ((:) (Generator (VarPat (Ident "cc7")) (Var (Ident "CUSTOMER"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "cc7"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "num4")) (IntExp (1))) ([])) ([])))))))) ([]))) ((:) (AssertRef (Var (Ident "SPEC2")) "k" (Var (Ident "BankSystem"))) ((:) (AssertRef (Var (Ident "SPEC2")) "k" (Var (Ident "BankSystem"))) ((:) (Channel ((:) (Ident "a") ([])) (Nothing)) ((:) (PatBind (VarPat (Ident "DIV")) (Fun2 (BuiltIn (F_Hiding)) (Var (Ident "LOOP")) (SetEnum ((:) (Var (Ident "a")) ([]))))) ((:) (PatBind (VarPat (Ident "LOOP")) (PrefixExp (Var (Ident "a")) ([]) (Var (Ident "LOOP")))) ([])))))))))))))))))))))))))))))))))))))))))))) (Nothing))