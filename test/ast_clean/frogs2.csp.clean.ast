(Module ((:) (DataType (Ident "square") ((:) (Constructor (Ident "E") (Nothing)) ((:) (Constructor (Ident "Y") (Nothing)) ((:) (Constructor (Ident "G") (Nothing)) ([]))))) ((:) (SubType (Ident "colour") ((:) (Constructor (Ident "Y") (Nothing)) ((:) (Constructor (Ident "G") (Nothing)) ([])))) ((:) (PatBind (VarPat (Ident "StartBoard")) (ListEnum ((:) (Var (Ident "Y")) ((:) (Var (Ident "Y")) ((:) (Var (Ident "Y")) ((:) (Var (Ident "E")) ((:) (Var (Ident "G")) ((:) (Var (Ident "G")) ((:) (Var (Ident "G")) ([])))))))))) ((:) (PatBind (VarPat (Ident "EndBoard")) (ListEnum ((:) (Var (Ident "G")) ((:) (Var (Ident "G")) ((:) (Var (Ident "G")) ((:) (Var (Ident "E")) ((:) (Var (Ident "Y")) ((:) (Var (Ident "Y")) ((:) (Var (Ident "Y")) ([])))))))))) ((:) (FunBind (Ident "board_el") ((:) (FunCase ((:) ((:) (VarPat (Ident "i")) ((:) (VarPat (Ident "xs")) ([]))) ([])) (Ifte (Fun2 (BuiltIn (F_Eq)) (Var (Ident "i")) (IntExp (0))) (CallBuiltIn (BuiltIn (F_head)) ((:) ((:) (Var (Ident "xs")) ([])) ([]))) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i")) (IntExp (1))) ((:) (CallBuiltIn (BuiltIn (F_tail)) ((:) ((:) (Var (Ident "xs")) ([])) ([]))) ([]))) ([]))))) ([]))) ((:) (PatBind (VarPat (Ident "len")) (Fun2 (BuiltIn (F_Sub)) (Fun1 (BuiltIn (F_Len2)) (Var (Ident "StartBoard"))) (IntExp (1)))) ((:) (PatBind (VarPat (Ident "pos")) (SetClose ((,) (Parens (IntExp (-2))) (Fun2 (BuiltIn (F_Add)) (Var (Ident "len")) (IntExp (2)))))) ((:) (PatBind (VarPat (Ident "realpos")) (SetClose ((,) (IntExp (0)) (Var (Ident "len"))))) ((:) (Channel ((:) (Ident "move_left") ((:) (Ident "move_right") ((:) (Ident "hop_left") ((:) (Ident "hop_right") ([]))))) (Just (TypeDot ((:) (Var (Ident "pos")) ((:) (Var (Ident "colour")) ([])))))) ((:) (Channel ((:) (Ident "done") ([])) (Nothing)) ((:) (FunBind (Ident "EMPTY") ((:) (FunCase ((:) ((:) (VarPat (Ident "i2")) ((:) (VarPat (Ident "target")) ([]))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "target")) (Var (Ident "E"))) (PrefixExp (Var (Ident "done")) ([]) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i2")) ((:) (Var (Ident "target")) ([]))) ([]))))) (PrefixExp (Var (Ident "move_left")) ((:) (OutComm (Var (Ident "i2"))) ((:) (InComm (VarPat (Ident "c"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i2")) ((:) (Var (Ident "c")) ((:) (Var (Ident "target")) ([])))) ([]))))) (PrefixExp (Var (Ident "move_right")) ((:) (OutComm (Var (Ident "i2"))) ((:) (InComm (VarPat (Ident "c2"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i2")) ((:) (Var (Ident "c2")) ((:) (Var (Ident "target")) ([])))) ([]))))) (PrefixExp (Var (Ident "hop_left")) ((:) (OutComm (Var (Ident "i2"))) ((:) (InComm (VarPat (Ident "c3"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i2")) ((:) (Var (Ident "c3")) ((:) (Var (Ident "target")) ([])))) ([]))))) (PrefixExp (Var (Ident "hop_right")) ((:) (OutComm (Var (Ident "i2"))) ((:) (InComm (VarPat (Ident "c4"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i2")) ((:) (Var (Ident "c4")) ((:) (Var (Ident "target")) ([])))) ([])))))) ([]))) ((:) (FunBind (Ident "FULL") ((:) (FunCase ((:) ((:) (VarPat (Ident "i3")) ((:) (VarPat (Ident "c5")) ((:) (VarPat (Ident "target2")) ([])))) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "target2")) (Var (Ident "c5"))) (PrefixExp (Var (Ident "done")) ([]) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "c5")) ((:) (Var (Ident "target2")) ([])))) ([]))))) (PrefixExp (Var (Ident "move_left")) ((:) (OutComm (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i3")) (IntExp (1)))) ((:) (OutComm (Var (Ident "c5"))) ([]))) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "target2")) ([]))) ([]))))) (PrefixExp (Var (Ident "move_right")) ((:) (OutComm (Fun2 (BuiltIn (F_Add)) (Var (Ident "i3")) (IntExp (1)))) ((:) (OutComm (Var (Ident "c5"))) ([]))) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "target2")) ([]))) ([]))))) (PrefixExp (Var (Ident "hop_left")) ((:) (OutComm (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i3")) (IntExp (2)))) ((:) (OutComm (Var (Ident "c5"))) ([]))) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "target2")) ([]))) ([]))))) (PrefixExp (Var (Ident "hop_right")) ((:) (OutComm (Fun2 (BuiltIn (F_Add)) (Var (Ident "i3")) (IntExp (2)))) ((:) (OutComm (Var (Ident "c5"))) ([]))) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "target2")) ([]))) ([]))))) (PrefixExp (Var (Ident "hop_left")) ((:) (OutComm (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i3")) (IntExp (1)))) ((:) (InComm (VarPat (Ident "x"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "c5")) ((:) (Var (Ident "target2")) ([])))) ([]))))) (PrefixExp (Var (Ident "hop_right")) ((:) (OutComm (Fun2 (BuiltIn (F_Add)) (Var (Ident "i3")) (IntExp (1)))) ((:) (InComm (VarPat (Ident "x2"))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i3")) ((:) (Var (Ident "c5")) ((:) (Var (Ident "target2")) ([])))) ([])))))) ([]))) ((:) (FunBind (Ident "INIT") ((:) (FunCase ((:) ((:) (VarPat (Ident "i4")) ([])) ([])) (Ifte (Fun2 (BuiltIn (F_Eq)) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "StartBoard")) ([]))) ([]))) (Var (Ident "E"))) (CallFunction (Var (Ident "EMPTY")) ((:) ((:) (Var (Ident "i4")) ((:) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "EndBoard")) ([]))) ([]))) ([]))) ([]))) (Ifte (Fun2 (BuiltIn (F_Eq)) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "StartBoard")) ([]))) ([]))) (Var (Ident "Y"))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "Y")) ((:) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "EndBoard")) ([]))) ([]))) ([])))) ([]))) (CallFunction (Var (Ident "FULL")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "G")) ((:) (CallFunction (Var (Ident "board_el")) ((:) ((:) (Var (Ident "i4")) ((:) (Var (Ident "EndBoard")) ([]))) ([]))) ([])))) ([])))))) ([]))) ((:) (FunBind (Ident "Alpha") ((:) (FunCase ((:) ((:) (VarPat (Ident "i5")) ([])) ([])) (CallBuiltIn (BuiltIn (F_Union)) ((:) ((:) (SetEnum ((:) (SetEnum ((:) (Var (Ident "done")) ([]))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "move_left")) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i5")) (Var (Ident "k"))) ([])))) ([])) ((:) (Generator (VarPat (Ident "k")) (SetEnum ((:) (IntExp (0)) ((:) (IntExp (1)) ([]))))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "move_right")) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "i5")) (Var (Ident "k2"))) ([])))) ([])) ((:) (Generator (VarPat (Ident "k2")) (SetEnum ((:) (IntExp (0)) ((:) (IntExp (1)) ([]))))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "hop_left")) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "i5")) (Var (Ident "k3"))) ([])))) ([])) ((:) (Generator (VarPat (Ident "k3")) (SetEnum ((:) (IntExp (0)) ((:) (IntExp (1)) ((:) (IntExp (2)) ([])))))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "hop_right")) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "i5")) (Var (Ident "k4"))) ([])))) ([])) ((:) (Generator (VarPat (Ident "k4")) (SetEnum ((:) (IntExp (0)) ((:) (IntExp (1)) ((:) (IntExp (2)) ([])))))) ([])))) ([]))))))) ([])) ([])))) ([]))) ((:) (PatBind (VarPat (Ident "COMPLETEBOARD")) (ProcRepAParallel ((:) (Generator (VarPat (Ident "i6")) (Var (Ident "realpos"))) ([])) (CallFunction (Var (Ident "Alpha")) ((:) ((:) (Var (Ident "i6")) ([])) ([]))) (CallFunction (Var (Ident "INIT")) ((:) ((:) (Var (Ident "i6")) ([])) ([]))))) ((:) (PatBind (VarPat (Ident "OnBoardPlay")) (ProcRepChoice ((:) (Generator (VarPat (Ident "x3")) (Var (Ident "realpos"))) ([])) (Parens (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "move_left")) ((:) (OutComm (Var (Ident "x3"))) ((:) (InComm (VarPat (Ident "c6"))) ([]))) (Var (Ident "OnBoardPlay"))) (PrefixExp (Var (Ident "move_right")) ((:) (OutComm (Var (Ident "x3"))) ((:) (InComm (VarPat (Ident "c7"))) ([]))) (Var (Ident "OnBoardPlay")))) (PrefixExp (Var (Ident "hop_left")) ((:) (OutComm (Var (Ident "x3"))) ((:) (InComm (VarPat (Ident "c8"))) ([]))) (Var (Ident "OnBoardPlay")))) (PrefixExp (Var (Ident "hop_right")) ((:) (OutComm (Var (Ident "x3"))) ((:) (InComm (VarPat (Ident "c9"))) ([]))) (Var (Ident "OnBoardPlay"))))))) ((:) (PatBind (VarPat (Ident "AlphaBoard")) (Closure ((:) (Var (Ident "move_left")) ((:) (Var (Ident "move_right")) ((:) (Var (Ident "hop_left")) ((:) (Var (Ident "hop_right")) ([]))))))) ((:) (PatBind (VarPat (Ident "Ac")) (CallBuiltIn (BuiltIn (F_Union)) ((:) ((:) (SetComprehension ((,) ((:) (CallFunction (Var (Ident "Alpha")) ((:) ((:) (Var (Ident "i7")) ([])) ([]))) ([])) ((:) (Generator (VarPat (Ident "i7")) (Var (Ident "realpos"))) ([])))) ([])) ([])))) ((:) (PatBind (VarPat (Ident "invalidmoves")) (CallBuiltIn (BuiltIn (F_diff)) ((:) ((:) (Var (Ident "pos")) ((:) (Var (Ident "realpos")) ([]))) ([])))) ((:) (PatBind (VarPat (Ident "OffBoardMoves")) (CallBuiltIn (BuiltIn (F_Union)) ((:) ((:) (SetEnum ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "move_left")) ((:) (Var (Ident "i8")) ([])))) ([])) ((:) (Generator (VarPat (Ident "i8")) (Var (Ident "invalidmoves"))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "move_right")) ((:) (Var (Ident "i9")) ([])))) ([])) ((:) (Generator (VarPat (Ident "i9")) (Var (Ident "invalidmoves"))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "hop_left")) ((:) (Var (Ident "i65")) ([])))) ([])) ((:) (Generator (VarPat (Ident "i65")) (Var (Ident "invalidmoves"))) ([])))) ((:) (ClosureComprehension ((,) ((:) (DotTuple ((:) (Var (Ident "hop_right")) ((:) (Var (Ident "i66")) ([])))) ([])) ((:) (Generator (VarPat (Ident "i66")) (Var (Ident "invalidmoves"))) ([])))) ([])))))) ([])) ([])))) ((:) (PatBind (VarPat (Ident "PUZZLE")) (ProcAParallel (Var (Ident "Ac")) (Var (Ident "AlphaBoard")) (Var (Ident "COMPLETEBOARD")) (Var (Ident "OnBoardPlay")))) ((:) (AssertRef (Stop) "k" (Fun2 (BuiltIn (F_Hiding)) (Var (Ident "PUZZLE")) (Closure ((:) (Var (Ident "move_left")) ((:) (Var (Ident "move_right")) ((:) (Var (Ident "hop_left")) ((:) (Var (Ident "hop_right")) ([])))))))) ([]))))))))))))))))))))))) (Nothing))