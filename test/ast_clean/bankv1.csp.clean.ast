(Module ((:) (PatBind (VarPat (Ident "QUEUENUM")) (SetClose ((,) (IntExp (1)) (IntExp (3))))) ((:) (DataType (Ident "CUSTOMER") ((:) (Constructor (Ident "c1") (Nothing)) ((:) (Constructor (Ident "c2") (Nothing)) ((:) (Constructor (Ident "c3") (Nothing)) ([]))))) ((:) (DataType (Ident "STATUS") ((:) (Constructor (Ident "success") (Nothing)) ((:) (Constructor (Ident "fail") (Nothing)) ([])))) ((:) (DataType (Ident "QSTATUS") ((:) (Constructor (Ident "yes") (Nothing)) ((:) (Constructor (Ident "no") (Nothing)) ([])))) ((:) (PatBind (VarPat (Ident "maxLimit")) (IntExp (2))) ((:) (PatBind (VarPat (Ident "defaultCounter")) (IntExp (1))) ((:) (PatBind (VarPat (Ident "defaultCustomer")) (Var (Ident "c1"))) ((:) (PatBind (VarPat (Ident "maxQueueingCustomers")) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "maxLimit")) (IntExp (1)))) ((:) (PatBind (VarPat (Ident "numQueues")) (IntExp (2))) ((:) (Channel ((:) (Ident "enterBank") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "leaveBank") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "report") ([])) (Just (TypeDot ((:) (Var (Ident "STATUS")) ([]))))) ((:) (Channel ((:) (Ident "com1") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "com2") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ([]))))) ((:) (Channel ((:) (Ident "com3") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ((:) (Var (Ident "QUEUENUM")) ([])))))) ((:) (Channel ((:) (Ident "canJoinResponse") ([])) (Just (TypeDot ((:) (Var (Ident "STATUS")) ([]))))) ((:) (Channel ((:) (Ident "retrieveCustomer") ([])) (Nothing)) ((:) (Channel ((:) (Ident "joinQueue") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "leaveQueue") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ((:) (Var (Ident "CUSTOMER")) ([])))))) ((:) (Channel ((:) (Ident "queryQueueEmpty") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ((:) (Var (Ident "QSTATUS")) ([])))))) ((:) (Channel ((:) (Ident "queryIsInQueue") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ((:) (Var (Ident "QSTATUS")) ([])))))) ((:) (Channel ((:) (Ident "getQueueNo") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ([]))))) ((:) (Channel ((:) (Ident "setNextQueue") ([])) (Just (TypeDot ((:) (Var (Ident "QUEUENUM")) ([]))))) ((:) (Channel ((:) (Ident "setCustomer") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (Channel ((:) (Ident "getCustomer") ([])) (Just (TypeDot ((:) (Var (Ident "CUSTOMER")) ([]))))) ((:) (FunBind (Ident "inc") ((:) (FunCase ((:) ((:) (VarPat (Ident "queueNo")) ([])) ([])) (Fun2 (BuiltIn (F_Add)) (Parens (Fun2 (BuiltIn (F_Mod)) (Var (Ident "queueNo")) (Var (Ident "numQueues")))) (IntExp (1)))) ([]))) ((:) (PatBind (VarPat (Ident "BankCounterCtrl")) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (IntExp (0)) ([])) ([])))) ((:) (FunBind (Ident "CurrentCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (CallFunction (Var (Ident "JoinCtrl")) ((:) ((:) (Var (Ident "num")) ([])) ([]))) (CallFunction (Var (Ident "LeaveCtrl")) ((:) ((:) (Var (Ident "num")) ([])) ([]))))) ([]))) ((:) (FunBind (Ident "JoinCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num2")) ([])) ([])) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "num2")) (Var (Ident "maxLimit"))) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "cc"))) ([])) (Parens (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "num2")) (IntExp (0))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (PrefixExp (Var (Ident "setCustomer")) ((:) (OutComm (Var (Ident "cc"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num2")) (IntExp (1))) ([])) ([]))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "num2")) (IntExp (0))) (PrefixExp (Var (Ident "getCustomer")) ((:) (InComm (VarPat (Ident "currentCust"))) ([])) (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "cc")) (Var (Ident "currentCust")))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Var (Ident "num2")) ([])) ([])))) (PrefixExp (Var (Ident "com1")) ((:) (OutComm (Var (Ident "cc"))) ([])) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (InComm (VarPat (Ident "bb"))) ([])) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "bb"))) ([])) (Parens (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "bb")) (Var (Ident "success")))) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num2")) (IntExp (1))) ([])) ([]))) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Var (Ident "num2")) ([])) ([]))))))))))))))))) ([]))) ((:) (FunBind (Ident "LeaveCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "num3")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_Eq)) (Var (Ident "num3")) (IntExp (1))) (PrefixExp (Var (Ident "getCustomer")) ((:) (InComm (VarPat (Ident "cc2"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "cc2"))) ([])) (PrefixExp (Var (Ident "setCustomer")) ((:) (OutComm (Var (Ident "defaultCustomer"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (IntExp (0)) ([])) ([])))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "num3")) (IntExp (1))) (PrefixExp (Var (Ident "getCustomer")) ((:) (InComm (VarPat (Ident "cc3"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "cc3"))) ([])) (PrefixExp (Var (Ident "getQueueNo")) ((:) (InComm (VarPat (Ident "qNo"))) ([])) (PrefixExp (Var (Ident "com2")) ((:) (OutComm (Var (Ident "qNo"))) ([])) (PrefixExp (Var (Ident "com3")) ((:) (InComm (VarPat (Ident "newCust"))) ((:) (InComm (VarPat (Ident "newQNo"))) ([]))) (PrefixExp (Var (Ident "setCustomer")) ((:) (OutComm (Var (Ident "newCust"))) ([])) (PrefixExp (Var (Ident "setNextQueue")) ((:) (OutComm (Var (Ident "newQNo"))) ([])) (CallFunction (Var (Ident "CurrentCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "num3")) (IntExp (1))) ([])) ([])))))))))))))) ([]))) ((:) (PatBind (VarPat (Ident "QueuesCtrl")) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (IntExp (0)) ([])) ([])))) ((:) (FunBind (Ident "QCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "s")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "s")) (Var (Ident "maxQueueingCustomers"))) (PrefixExp (Var (Ident "com1")) ((:) (InComm (VarPat (Ident "cc4"))) ([])) (PrefixExp (Var (Ident "queryIsInQueue")) ((:) (OutComm (Var (Ident "cc4"))) ((:) (InComm (VarPat (Ident "bb2"))) ([]))) (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "bb2")) (Var (Ident "yes")))) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Var (Ident "s")) ([])) ([])))) (PrefixExp (Var (Ident "canJoinResponse")) ((:) (OutComm (Var (Ident "success"))) ([])) (PrefixExp (Var (Ident "joinQueue")) ((:) (OutComm (Var (Ident "cc4"))) ([])) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "s")) (IntExp (1))) ([])) ([])))))))))) (Parens (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "s")) (IntExp (0))) (PrefixExp (Var (Ident "com2")) ((:) (InComm (VarPat (Ident "qNo2"))) ([])) (CallFunction (Var (Ident "NextQCtrl")) ((:) ((:) (Var (Ident "s")) ((:) (Var (Ident "qNo2")) ([]))) ([])))))))) ([]))) ((:) (FunBind (Ident "NextQCtrl") ((:) (FunCase ((:) ((:) (VarPat (Ident "s2")) ((:) (VarPat (Ident "queueNo2")) ([]))) ([])) (PrefixExp (Var (Ident "queryQueueEmpty")) ((:) (OutComm (Var (Ident "queueNo2"))) ((:) (InComm (VarPat (Ident "bb3"))) ([]))) (Ifte (Parens (Fun2 (BuiltIn (F_Eq)) (Var (Ident "bb3")) (Var (Ident "no")))) (PrefixExp (Var (Ident "leaveQueue")) ((:) (OutComm (Var (Ident "queueNo2"))) ((:) (InComm (VarPat (Ident "cc5"))) ([]))) (PrefixExp (Var (Ident "com3")) ((:) (OutComm (Var (Ident "cc5"))) ((:) (OutComm (CallFunction (Var (Ident "inc")) ((:) ((:) (Var (Ident "queueNo2")) ([])) ([])))) ([]))) (CallFunction (Var (Ident "QCtrl")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "s2")) (IntExp (1))) ([])) ([]))))) (CallFunction (Var (Ident "NextQCtrl")) ((:) ((:) (Var (Ident "s2")) ((:) (CallFunction (Var (Ident "inc")) ((:) ((:) (Var (Ident "queueNo2")) ([])) ([]))) ([]))) ([])))))) ([]))) ((:) (PatBind (VarPat (Ident "A")) (Closure ((:) (Var (Ident "com1")) ((:) (Var (Ident "com2")) ((:) (Var (Ident "com3")) ((:) (Var (Ident "canJoinResponse")) ((:) (Var (Ident "retrieveCustomer")) ([])))))))) ((:) (PatBind (VarPat (Ident "B")) (Closure ((:) (Var (Ident "joinQueue")) ((:) (Var (Ident "leaveQueue")) ((:) (Var (Ident "queryQueueEmpty")) ((:) (Var (Ident "queryIsInQueue")) ((:) (Var (Ident "getCustomer")) ((:) (Var (Ident "setCustomer")) ((:) (Var (Ident "getQueueNo")) ((:) (Var (Ident "setNextQueue")) ([]))))))))))) ((:) (PatBind (VarPat (Ident "BankSystem")) (Fun2 (BuiltIn (F_Hiding)) (Parens (ProcSharing (Var (Ident "A")) (Var (Ident "BankCounterCtrl")) (Var (Ident "QueuesCtrl")))) (CallBuiltIn (BuiltIn (F_union)) ((:) ((:) (Var (Ident "A")) ((:) (Var (Ident "B")) ([]))) ([]))))) ((:) (PatBind (VarPat (Ident "BankSystemNoHide")) (ProcSharing (Var (Ident "A")) (Var (Ident "BankCounterCtrl")) (Var (Ident "QueuesCtrl")))) ((:) (PatBind (VarPat (Ident "SPEC")) (ProcRepInterleave ((:) (Generator (VarPat (Ident "i")) (SetClose ((,) (IntExp (1)) (Var (Ident "maxLimit"))))) ([])) (Var (Ident "CUST")))) ((:) (PatBind (VarPat (Ident "CUST")) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "i2"))) ([])) (Parens (Fun2 (BuiltIn (F_ExtChoice)) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (Var (Ident "CUST"))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "i2"))) ([])) (Var (Ident "CUST")))))))) ((:) (PatBind (VarPat (Ident "SPEC2")) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (IntExp (0)) ([])) ([])))) ((:) (FunBind (Ident "NEWSPEC") ((:) (FunCase ((:) ((:) (VarPat (Ident "num4")) ([])) ([])) (Fun2 (BuiltIn (F_ExtChoice)) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_LT)) (Var (Ident "num4")) (Var (Ident "maxLimit"))) (PrefixExp (Var (Ident "enterBank")) ((:) (InComm (VarPat (Ident "cc6"))) ([])) (Parens (Fun2 (BuiltIn (F_IntChoice)) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "success"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Fun2 (BuiltIn (F_Add)) (Var (Ident "num4")) (IntExp (1))) ([])) ([])))) (PrefixExp (Var (Ident "report")) ((:) (OutComm (Var (Ident "fail"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Var (Ident "num4")) ([])) ([])))))))) (Fun2 (BuiltIn (F_Guard)) (Fun2 (BuiltIn (F_GT)) (Var (Ident "num4")) (IntExp (0))) (ProcRepInternalChoice ((:) (Generator (VarPat (Ident "cc7")) (Var (Ident "CUSTOMER"))) ([])) (PrefixExp (Var (Ident "leaveBank")) ((:) (OutComm (Var (Ident "cc7"))) ([])) (CallFunction (Var (Ident "NEWSPEC")) ((:) ((:) (Fun2 (BuiltIn (F_Sub)) (Var (Ident "num4")) (IntExp (1))) ([])) ([])))))))) ([]))) ((:) (AssertRef (Var (Ident "SPEC")) "k" (Var (Ident "BankSystem"))) ((:) (AssertRef (Var (Ident "SPEC")) "k" (Var (Ident "BankSystem"))) ((:) (AssertRef (Var (Ident "SPEC2")) "k" (Var (Ident "BankSystem"))) ((:) (AssertRef (Var (Ident "SPEC2")) "k" (Var (Ident "BankSystem"))) ([])))))))))))))))))))))))))))))))))))))))))))))) (Nothing))