Labeled {label = TokSpan 11 544, unLabel = Module [Labeled {label = TokSpan 11 17, unLabel = PatBind (Labeled {label = TokSpan 11 11, unLabel = VarPat (Labeled {label = TokSpan 11 11, unLabel = Ident {unIdent = "RawData"}})}) (Labeled {label = TokSpan 13 17, unLabel = SetEnum [Labeled {label = TokSpan 14 14, unLabel = IntExp 0},Labeled {label = TokSpan 16 16, unLabel = IntExp 1}]})},Labeled {label = TokSpan 18 24, unLabel = PatBind (Labeled {label = TokSpan 18 18, unLabel = VarPat (Labeled {label = TokSpan 18 18, unLabel = Ident {unIdent = "VChans"}})}) (Labeled {label = TokSpan 20 24, unLabel = SetEnum [Labeled {label = TokSpan 21 21, unLabel = IntExp 0},Labeled {label = TokSpan 23 23, unLabel = IntExp 1}]})},Labeled {label = TokSpan 25 43, unLabel = PatBind (Labeled {label = TokSpan 25 25, unLabel = VarPat (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "LinkData"}})}) (Labeled {label = TokSpan 27 43, unLabel = SetEnum [Labeled {label = TokSpan 28 30, unLabel = DotTuple [Labeled {label = TokSpan 28 28, unLabel = IntExp 0},Labeled {label = TokSpan 30 30, unLabel = IntExp 0}]},Labeled {label = TokSpan 32 34, unLabel = DotTuple [Labeled {label = TokSpan 32 32, unLabel = IntExp 0},Labeled {label = TokSpan 34 34, unLabel = IntExp 1}]},Labeled {label = TokSpan 36 38, unLabel = DotTuple [Labeled {label = TokSpan 36 36, unLabel = IntExp 1},Labeled {label = TokSpan 38 38, unLabel = IntExp 0}]},Labeled {label = TokSpan 40 42, unLabel = DotTuple [Labeled {label = TokSpan 40 40, unLabel = IntExp 1},Labeled {label = TokSpan 42 42, unLabel = IntExp 1}]}]})},Labeled {label = TokSpan 44 48, unLabel = PatBind (Labeled {label = TokSpan 44 44, unLabel = VarPat (Labeled {label = TokSpan 44 44, unLabel = Ident {unIdent = "InternalAcks"}})}) (Labeled {label = TokSpan 46 48, unLabel = SetEnum [Labeled {label = TokSpan 47 47, unLabel = IntExp 0}]})},Labeled {label = TokSpan 49 55, unLabel = PatBind (Labeled {label = TokSpan 49 49, unLabel = VarPat (Labeled {label = TokSpan 49 49, unLabel = Ident {unIdent = "LinkAcks"}})}) (Labeled {label = TokSpan 51 55, unLabel = SetEnum [Labeled {label = TokSpan 52 52, unLabel = IntExp 0},Labeled {label = TokSpan 54 54, unLabel = IntExp 1}]})},Labeled {label = TokSpan 58 67, unLabel = Channel [Labeled {label = TokSpan 59 59, unLabel = Ident {unIdent = "upin0"}},Labeled {label = TokSpan 61 61, unLabel = Ident {unIdent = "upin1"}},Labeled {label = TokSpan 63 63, unLabel = Ident {unIdent = "upout0"}},Labeled {label = TokSpan 65 65, unLabel = Ident {unIdent = "upout1"}}] (Just (Labeled {label = TokSpan 67 67, unLabel = TypeDot [Labeled {label = TokSpan 67 67, unLabel = Var (Labeled {label = TokSpan 67 67, unLabel = Ident {unIdent = "RawData"}})}]}))},Labeled {label = TokSpan 68 77, unLabel = Channel [Labeled {label = TokSpan 69 69, unLabel = Ident {unIdent = "downin0"}},Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "downin1"}},Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "downout0"}},Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "downout1"}}] (Just (Labeled {label = TokSpan 77 77, unLabel = TypeDot [Labeled {label = TokSpan 77 77, unLabel = Var (Labeled {label = TokSpan 77 77, unLabel = Ident {unIdent = "RawData"}})}]}))},Labeled {label = TokSpan 78 87, unLabel = Channel [Labeled {label = TokSpan 79 79, unLabel = Ident {unIdent = "upack0"}},Labeled {label = TokSpan 81 81, unLabel = Ident {unIdent = "upack1"}},Labeled {label = TokSpan 83 83, unLabel = Ident {unIdent = "downack0"}},Labeled {label = TokSpan 85 85, unLabel = Ident {unIdent = "downack1"}}] (Just (Labeled {label = TokSpan 87 87, unLabel = TypeDot [Labeled {label = TokSpan 87 87, unLabel = Var (Labeled {label = TokSpan 87 87, unLabel = Ident {unIdent = "InternalAcks"}})}]}))},Labeled {label = TokSpan 90 93, unLabel = Channel [Labeled {label = TokSpan 91 91, unLabel = Ident {unIdent = "uptodown"}}] (Just (Labeled {label = TokSpan 93 93, unLabel = TypeDot [Labeled {label = TokSpan 93 93, unLabel = Var (Labeled {label = TokSpan 93 93, unLabel = Ident {unIdent = "LinkData"}})}]}))},Labeled {label = TokSpan 94 97, unLabel = Channel [Labeled {label = TokSpan 95 95, unLabel = Ident {unIdent = "downtoup"}}] (Just (Labeled {label = TokSpan 97 97, unLabel = TypeDot [Labeled {label = TokSpan 97 97, unLabel = Var (Labeled {label = TokSpan 97 97, unLabel = Ident {unIdent = "LinkAcks"}})}]}))},Labeled {label = TokSpan 99 108, unLabel = Channel [Labeled {label = TokSpan 100 100, unLabel = Ident {unIdent = "inack0"}},Labeled {label = TokSpan 102 102, unLabel = Ident {unIdent = "inack1"}},Labeled {label = TokSpan 104 104, unLabel = Ident {unIdent = "outack0"}},Labeled {label = TokSpan 106 106, unLabel = Ident {unIdent = "outack1"}}] (Just (Labeled {label = TokSpan 108 108, unLabel = TypeDot [Labeled {label = TokSpan 108 108, unLabel = Var (Labeled {label = TokSpan 108 108, unLabel = Ident {unIdent = "Acks"}})}]}))},Labeled {label = TokSpan 112 130, unLabel = PatBind (Labeled {label = TokSpan 112 112, unLabel = VarPat (Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "UpHandler0"}})}) (Labeled {label = TokSpan 114 130, unLabel = PrefixExp (Labeled {label = TokSpan 114 114, unLabel = Var (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "upin0"}})}) [Labeled {label = TokSpan 115 118, unLabel = InCommGuarded (Labeled {label = TokSpan 116 116, unLabel = VarPat (Labeled {label = TokSpan 116 116, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 118 118, unLabel = Var (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 120 130, unLabel = PrefixExp (Labeled {label = TokSpan 120 120, unLabel = Var (Labeled {label = TokSpan 120 120, unLabel = Ident {unIdent = "upout0"}})}) [Labeled {label = TokSpan 121 122, unLabel = OutComm (Labeled {label = TokSpan 122 122, unLabel = Var (Labeled {label = TokSpan 122 122, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 124 130, unLabel = PrefixExp (Labeled {label = TokSpan 124 124, unLabel = Var (Labeled {label = TokSpan 124 124, unLabel = Ident {unIdent = "upack0"}})}) [Labeled {label = TokSpan 125 128, unLabel = InCommGuarded (Labeled {label = TokSpan 126 126, unLabel = VarPat (Labeled {label = TokSpan 126 126, unLabel = Ident {unIdent = "y"}})}) (Labeled {label = TokSpan 128 128, unLabel = Var (Labeled {label = TokSpan 128 128, unLabel = Ident {unIdent = "InternalAcks"}})})}] (Labeled {label = TokSpan 130 130, unLabel = Var (Labeled {label = TokSpan 130 130, unLabel = Ident {unIdent = "UpHandler0"}})})})})})},Labeled {label = TokSpan 131 149, unLabel = PatBind (Labeled {label = TokSpan 131 131, unLabel = VarPat (Labeled {label = TokSpan 131 131, unLabel = Ident {unIdent = "UpHandler1"}})}) (Labeled {label = TokSpan 133 149, unLabel = PrefixExp (Labeled {label = TokSpan 133 133, unLabel = Var (Labeled {label = TokSpan 133 133, unLabel = Ident {unIdent = "upin1"}})}) [Labeled {label = TokSpan 134 137, unLabel = InCommGuarded (Labeled {label = TokSpan 135 135, unLabel = VarPat (Labeled {label = TokSpan 135 135, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 137 137, unLabel = Var (Labeled {label = TokSpan 137 137, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 139 149, unLabel = PrefixExp (Labeled {label = TokSpan 139 139, unLabel = Var (Labeled {label = TokSpan 139 139, unLabel = Ident {unIdent = "upout1"}})}) [Labeled {label = TokSpan 140 141, unLabel = OutComm (Labeled {label = TokSpan 141 141, unLabel = Var (Labeled {label = TokSpan 141 141, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 143 149, unLabel = PrefixExp (Labeled {label = TokSpan 143 143, unLabel = Var (Labeled {label = TokSpan 143 143, unLabel = Ident {unIdent = "upack1"}})}) [Labeled {label = TokSpan 144 147, unLabel = InCommGuarded (Labeled {label = TokSpan 145 145, unLabel = VarPat (Labeled {label = TokSpan 145 145, unLabel = Ident {unIdent = "y"}})}) (Labeled {label = TokSpan 147 147, unLabel = Var (Labeled {label = TokSpan 147 147, unLabel = Ident {unIdent = "InternalAcks"}})})}] (Labeled {label = TokSpan 149 149, unLabel = Var (Labeled {label = TokSpan 149 149, unLabel = Ident {unIdent = "UpHandler1"}})})})})})},Labeled {label = TokSpan 152 175, unLabel = PatBind (Labeled {label = TokSpan 152 152, unLabel = VarPat (Labeled {label = TokSpan 152 152, unLabel = Ident {unIdent = "UpControl"}})}) (Labeled {label = TokSpan 154 175, unLabel = PrefixExp (Labeled {label = TokSpan 154 154, unLabel = Var (Labeled {label = TokSpan 154 154, unLabel = Ident {unIdent = "downtoup"}})}) [Labeled {label = TokSpan 155 158, unLabel = InCommGuarded (Labeled {label = TokSpan 156 156, unLabel = VarPat (Labeled {label = TokSpan 156 156, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "LinkAcks"}})})}] (Labeled {label = TokSpan 160 175, unLabel = Ifte (Labeled {label = TokPos 162, unLabel = Fun2 "==" (Labeled {label = TokSpan 161 161, unLabel = Var (Labeled {label = TokSpan 161 161, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 163 163, unLabel = IntExp 0})}) (Labeled {label = TokSpan 165 169, unLabel = PrefixExp (Labeled {label = TokSpan 165 165, unLabel = Var (Labeled {label = TokSpan 165 165, unLabel = Ident {unIdent = "upack0"}})}) [Labeled {label = TokSpan 166 167, unLabel = OutComm (Labeled {label = TokSpan 167 167, unLabel = IntExp 0})}] (Labeled {label = TokSpan 169 169, unLabel = Var (Labeled {label = TokSpan 169 169, unLabel = Ident {unIdent = "UpControl"}})})}) (Labeled {label = TokSpan 171 175, unLabel = PrefixExp (Labeled {label = TokSpan 171 171, unLabel = Var (Labeled {label = TokSpan 171 171, unLabel = Ident {unIdent = "upack1"}})}) [Labeled {label = TokSpan 172 173, unLabel = OutComm (Labeled {label = TokSpan 173 173, unLabel = IntExp 0})}] (Labeled {label = TokSpan 175 175, unLabel = Var (Labeled {label = TokSpan 175 175, unLabel = Ident {unIdent = "UpControl"}})})})})})},Labeled {label = TokSpan 180 194, unLabel = PatBind (Labeled {label = TokSpan 180 180, unLabel = VarPat (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "InOut0"}})}) (Labeled {label = TokSpan 182 194, unLabel = PrefixExp (Labeled {label = TokSpan 182 182, unLabel = Var (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "upout0"}})}) [Labeled {label = TokSpan 183 186, unLabel = InCommGuarded (Labeled {label = TokSpan 184 184, unLabel = VarPat (Labeled {label = TokSpan 184 184, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 186 186, unLabel = Var (Labeled {label = TokSpan 186 186, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 188 194, unLabel = PrefixExp (Labeled {label = TokSpan 188 188, unLabel = Var (Labeled {label = TokSpan 188 188, unLabel = Ident {unIdent = "uptodown"}})}) [Labeled {label = TokSpan 189 190, unLabel = OutComm (Labeled {label = TokSpan 190 190, unLabel = IntExp 0})},Labeled {label = TokSpan 191 192, unLabel = OutComm (Labeled {label = TokSpan 192 192, unLabel = Var (Labeled {label = TokSpan 192 192, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 194 194, unLabel = Var (Labeled {label = TokSpan 194 194, unLabel = Ident {unIdent = "Mux"}})})})})},Labeled {label = TokSpan 195 209, unLabel = PatBind (Labeled {label = TokSpan 195 195, unLabel = VarPat (Labeled {label = TokSpan 195 195, unLabel = Ident {unIdent = "InOut1"}})}) (Labeled {label = TokSpan 197 209, unLabel = PrefixExp (Labeled {label = TokSpan 197 197, unLabel = Var (Labeled {label = TokSpan 197 197, unLabel = Ident {unIdent = "upout1"}})}) [Labeled {label = TokSpan 198 201, unLabel = InCommGuarded (Labeled {label = TokSpan 199 199, unLabel = VarPat (Labeled {label = TokSpan 199 199, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 201 201, unLabel = Var (Labeled {label = TokSpan 201 201, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 203 209, unLabel = PrefixExp (Labeled {label = TokSpan 203 203, unLabel = Var (Labeled {label = TokSpan 203 203, unLabel = Ident {unIdent = "uptodown"}})}) [Labeled {label = TokSpan 204 205, unLabel = OutComm (Labeled {label = TokSpan 205 205, unLabel = IntExp 1})},Labeled {label = TokSpan 206 207, unLabel = OutComm (Labeled {label = TokSpan 207 207, unLabel = Var (Labeled {label = TokSpan 207 207, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 209 209, unLabel = Var (Labeled {label = TokSpan 209 209, unLabel = Ident {unIdent = "Mux"}})})})})},Labeled {label = TokSpan 210 214, unLabel = PatBind (Labeled {label = TokSpan 210 210, unLabel = VarPat (Labeled {label = TokSpan 210 210, unLabel = Ident {unIdent = "Mux"}})}) (Labeled {label = TokPos 213, unLabel = Fun2 "[]" (Labeled {label = TokSpan 212 212, unLabel = Var (Labeled {label = TokSpan 212 212, unLabel = Ident {unIdent = "InOut0"}})}) (Labeled {label = TokSpan 214 214, unLabel = Var (Labeled {label = TokSpan 214 214, unLabel = Ident {unIdent = "InOut1"}})})})},Labeled {label = TokSpan 217 242, unLabel = PatBind (Labeled {label = TokSpan 217 217, unLabel = VarPat (Labeled {label = TokSpan 217 217, unLabel = Ident {unIdent = "DeMux"}})}) (Labeled {label = TokSpan 219 242, unLabel = PrefixExp (Labeled {label = TokSpan 219 219, unLabel = Var (Labeled {label = TokSpan 219 219, unLabel = Ident {unIdent = "uptodown"}})}) [Labeled {label = TokSpan 220 221, unLabel = InComm (Labeled {label = TokSpan 221 221, unLabel = VarPat (Labeled {label = TokSpan 221 221, unLabel = Ident {unIdent = "vchan"}})})},Labeled {label = TokSpan 222 225, unLabel = InCommGuarded (Labeled {label = TokSpan 223 223, unLabel = VarPat (Labeled {label = TokSpan 223 223, unLabel = Ident {unIdent = "data"}})}) (Labeled {label = TokSpan 225 225, unLabel = Var (Labeled {label = TokSpan 225 225, unLabel = Ident {unIdent = "LinkData"}})})}] (Labeled {label = TokSpan 227 242, unLabel = Ifte (Labeled {label = TokPos 229, unLabel = Fun2 "==" (Labeled {label = TokSpan 228 228, unLabel = Var (Labeled {label = TokSpan 228 228, unLabel = Ident {unIdent = "vchan"}})}) (Labeled {label = TokSpan 230 230, unLabel = IntExp 0})}) (Labeled {label = TokSpan 232 236, unLabel = PrefixExp (Labeled {label = TokSpan 232 232, unLabel = Var (Labeled {label = TokSpan 232 232, unLabel = Ident {unIdent = "downin0"}})}) [Labeled {label = TokSpan 233 234, unLabel = OutComm (Labeled {label = TokSpan 234 234, unLabel = Var (Labeled {label = TokSpan 234 234, unLabel = Ident {unIdent = "data"}})})}] (Labeled {label = TokSpan 236 236, unLabel = Var (Labeled {label = TokSpan 236 236, unLabel = Ident {unIdent = "DeMux"}})})}) (Labeled {label = TokSpan 238 242, unLabel = PrefixExp (Labeled {label = TokSpan 238 238, unLabel = Var (Labeled {label = TokSpan 238 238, unLabel = Ident {unIdent = "downin1"}})}) [Labeled {label = TokSpan 239 240, unLabel = OutComm (Labeled {label = TokSpan 240 240, unLabel = Var (Labeled {label = TokSpan 240 240, unLabel = Ident {unIdent = "data"}})})}] (Labeled {label = TokSpan 242 242, unLabel = Var (Labeled {label = TokSpan 242 242, unLabel = Ident {unIdent = "DeMux"}})})})})})},Labeled {label = TokSpan 245 261, unLabel = PatBind (Labeled {label = TokSpan 245 245, unLabel = VarPat (Labeled {label = TokSpan 245 245, unLabel = Ident {unIdent = "DownHandler0"}})}) (Labeled {label = TokSpan 247 261, unLabel = PrefixExp (Labeled {label = TokSpan 247 247, unLabel = Var (Labeled {label = TokSpan 247 247, unLabel = Ident {unIdent = "downin0"}})}) [Labeled {label = TokSpan 248 251, unLabel = InCommGuarded (Labeled {label = TokSpan 249 249, unLabel = VarPat (Labeled {label = TokSpan 249 249, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 251 251, unLabel = Var (Labeled {label = TokSpan 251 251, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 253 261, unLabel = PrefixExp (Labeled {label = TokSpan 253 253, unLabel = Var (Labeled {label = TokSpan 253 253, unLabel = Ident {unIdent = "downout0"}})}) [Labeled {label = TokSpan 254 255, unLabel = OutComm (Labeled {label = TokSpan 255 255, unLabel = Var (Labeled {label = TokSpan 255 255, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 257 261, unLabel = PrefixExp (Labeled {label = TokSpan 257 257, unLabel = Var (Labeled {label = TokSpan 257 257, unLabel = Ident {unIdent = "downack0"}})}) [Labeled {label = TokSpan 258 259, unLabel = OutComm (Labeled {label = TokSpan 259 259, unLabel = IntExp 0})}] (Labeled {label = TokSpan 261 261, unLabel = Var (Labeled {label = TokSpan 261 261, unLabel = Ident {unIdent = "DownHandler0"}})})})})})},Labeled {label = TokSpan 262 278, unLabel = PatBind (Labeled {label = TokSpan 262 262, unLabel = VarPat (Labeled {label = TokSpan 262 262, unLabel = Ident {unIdent = "DownHandler1"}})}) (Labeled {label = TokSpan 264 278, unLabel = PrefixExp (Labeled {label = TokSpan 264 264, unLabel = Var (Labeled {label = TokSpan 264 264, unLabel = Ident {unIdent = "downin1"}})}) [Labeled {label = TokSpan 265 268, unLabel = InCommGuarded (Labeled {label = TokSpan 266 266, unLabel = VarPat (Labeled {label = TokSpan 266 266, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 268 268, unLabel = Var (Labeled {label = TokSpan 268 268, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 270 278, unLabel = PrefixExp (Labeled {label = TokSpan 270 270, unLabel = Var (Labeled {label = TokSpan 270 270, unLabel = Ident {unIdent = "downout1"}})}) [Labeled {label = TokSpan 271 272, unLabel = OutComm (Labeled {label = TokSpan 272 272, unLabel = Var (Labeled {label = TokSpan 272 272, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 274 278, unLabel = PrefixExp (Labeled {label = TokSpan 274 274, unLabel = Var (Labeled {label = TokSpan 274 274, unLabel = Ident {unIdent = "downack1"}})}) [Labeled {label = TokSpan 275 276, unLabel = OutComm (Labeled {label = TokSpan 276 276, unLabel = IntExp 0})}] (Labeled {label = TokSpan 278 278, unLabel = Var (Labeled {label = TokSpan 278 278, unLabel = Ident {unIdent = "DownHandler1"}})})})})})},Labeled {label = TokSpan 281 305, unLabel = PatBind (Labeled {label = TokSpan 281 281, unLabel = VarPat (Labeled {label = TokSpan 281 281, unLabel = Ident {unIdent = "DownControl"}})}) (Labeled {label = TokPos 294, unLabel = Fun2 "[]" (Labeled {label = TokSpan 283 293, unLabel = PrefixExp (Labeled {label = TokSpan 283 283, unLabel = Var (Labeled {label = TokSpan 283 283, unLabel = Ident {unIdent = "downack0"}})}) [Labeled {label = TokSpan 284 287, unLabel = InCommGuarded (Labeled {label = TokSpan 285 285, unLabel = VarPat (Labeled {label = TokSpan 285 285, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 287 287, unLabel = Var (Labeled {label = TokSpan 287 287, unLabel = Ident {unIdent = "InternalAcks"}})})}] (Labeled {label = TokSpan 289 293, unLabel = PrefixExp (Labeled {label = TokSpan 289 289, unLabel = Var (Labeled {label = TokSpan 289 289, unLabel = Ident {unIdent = "downtoup"}})}) [Labeled {label = TokSpan 290 291, unLabel = OutComm (Labeled {label = TokSpan 291 291, unLabel = IntExp 0})}] (Labeled {label = TokSpan 293 293, unLabel = Var (Labeled {label = TokSpan 293 293, unLabel = Ident {unIdent = "DownControl"}})})})}) (Labeled {label = TokSpan 295 305, unLabel = PrefixExp (Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "downack1"}})}) [Labeled {label = TokSpan 296 299, unLabel = InCommGuarded (Labeled {label = TokSpan 297 297, unLabel = VarPat (Labeled {label = TokSpan 297 297, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 299 299, unLabel = Var (Labeled {label = TokSpan 299 299, unLabel = Ident {unIdent = "InternalAcks"}})})}] (Labeled {label = TokSpan 301 305, unLabel = PrefixExp (Labeled {label = TokSpan 301 301, unLabel = Var (Labeled {label = TokSpan 301 301, unLabel = Ident {unIdent = "downtoup"}})}) [Labeled {label = TokSpan 302 303, unLabel = OutComm (Labeled {label = TokSpan 303 303, unLabel = IntExp 1})}] (Labeled {label = TokSpan 305 305, unLabel = Var (Labeled {label = TokSpan 305 305, unLabel = Ident {unIdent = "DownControl"}})})})})})},Labeled {label = TokSpan 309 355, unLabel = PatBind (Labeled {label = TokSpan 309 309, unLabel = VarPat (Labeled {label = TokSpan 309 309, unLabel = Ident {unIdent = "Upstream"}})}) (Labeled {label = TokPos 350, unLabel = Fun2 "\\" (Labeled {label = TokSpan 311 349, unLabel = Parens (Labeled {label = TokSpan 341 347, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 342 346, unLabel = Closure [Labeled {label = TokSpan 343 343, unLabel = Var (Labeled {label = TokSpan 343 343, unLabel = Ident {unIdent = "upack0"}})},Labeled {label = TokSpan 345 345, unLabel = Var (Labeled {label = TokSpan 345 345, unLabel = Ident {unIdent = "upack1"}})}]}) (Labeled {label = TokSpan 312 340, unLabel = Parens (Labeled {label = TokPos 336, unLabel = Fun2 "\\" (Labeled {label = TokSpan 313 335, unLabel = Parens (Labeled {label = TokSpan 329 333, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 330 332, unLabel = Closure [Labeled {label = TokSpan 331 331, unLabel = Var (Labeled {label = TokSpan 331 331, unLabel = Ident {unIdent = "upout1"}})}]}) (Labeled {label = TokSpan 314 328, unLabel = Parens (Labeled {label = TokPos 324, unLabel = Fun2 "\\" (Labeled {label = TokSpan 315 323, unLabel = Parens (Labeled {label = TokSpan 317 321, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 318 320, unLabel = Closure [Labeled {label = TokSpan 319 319, unLabel = Var (Labeled {label = TokSpan 319 319, unLabel = Ident {unIdent = "upout0"}})}]}) (Labeled {label = TokSpan 316 316, unLabel = Var (Labeled {label = TokSpan 316 316, unLabel = Ident {unIdent = "UpHandler0"}})}) (Labeled {label = TokSpan 322 322, unLabel = Var (Labeled {label = TokSpan 322 322, unLabel = Ident {unIdent = "Mux"}})})})}) (Labeled {label = TokSpan 325 327, unLabel = Closure [Labeled {label = TokSpan 326 326, unLabel = Var (Labeled {label = TokSpan 326 326, unLabel = Ident {unIdent = "upout0"}})}]})})}) (Labeled {label = TokSpan 334 334, unLabel = Var (Labeled {label = TokSpan 334 334, unLabel = Ident {unIdent = "UpHandler1"}})})})}) (Labeled {label = TokSpan 337 339, unLabel = Closure [Labeled {label = TokSpan 338 338, unLabel = Var (Labeled {label = TokSpan 338 338, unLabel = Ident {unIdent = "upout1"}})}]})})}) (Labeled {label = TokSpan 348 348, unLabel = Var (Labeled {label = TokSpan 348 348, unLabel = Ident {unIdent = "UpControl"}})})})}) (Labeled {label = TokSpan 351 355, unLabel = Closure [Labeled {label = TokSpan 352 352, unLabel = Var (Labeled {label = TokSpan 352 352, unLabel = Ident {unIdent = "upack0"}})},Labeled {label = TokSpan 354 354, unLabel = Var (Labeled {label = TokSpan 354 354, unLabel = Ident {unIdent = "upack1"}})}]})})},Labeled {label = TokSpan 357 389, unLabel = PatBind (Labeled {label = TokSpan 357 357, unLabel = VarPat (Labeled {label = TokSpan 357 357, unLabel = Ident {unIdent = "UpstreamV"}})}) (Labeled {label = TokSpan 359 389, unLabel = Parens (Labeled {label = TokSpan 381 387, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 382 386, unLabel = Closure [Labeled {label = TokSpan 383 383, unLabel = Var (Labeled {label = TokSpan 383 383, unLabel = Ident {unIdent = "upack0"}})},Labeled {label = TokSpan 385 385, unLabel = Var (Labeled {label = TokSpan 385 385, unLabel = Ident {unIdent = "upack1"}})}]}) (Labeled {label = TokSpan 360 380, unLabel = Parens (Labeled {label = TokSpan 361 379, unLabel = Parens (Labeled {label = TokSpan 373 377, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 374 376, unLabel = Closure [Labeled {label = TokSpan 375 375, unLabel = Var (Labeled {label = TokSpan 375 375, unLabel = Ident {unIdent = "upout1"}})}]}) (Labeled {label = TokSpan 362 372, unLabel = Parens (Labeled {label = TokSpan 363 371, unLabel = Parens (Labeled {label = TokSpan 365 369, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 366 368, unLabel = Closure [Labeled {label = TokSpan 367 367, unLabel = Var (Labeled {label = TokSpan 367 367, unLabel = Ident {unIdent = "upout0"}})}]}) (Labeled {label = TokSpan 364 364, unLabel = Var (Labeled {label = TokSpan 364 364, unLabel = Ident {unIdent = "UpHandler0"}})}) (Labeled {label = TokSpan 370 370, unLabel = Var (Labeled {label = TokSpan 370 370, unLabel = Ident {unIdent = "Mux"}})})})})}) (Labeled {label = TokSpan 378 378, unLabel = Var (Labeled {label = TokSpan 378 378, unLabel = Ident {unIdent = "UpHandler1"}})})})})}) (Labeled {label = TokSpan 388 388, unLabel = Var (Labeled {label = TokSpan 388 388, unLabel = Ident {unIdent = "UpControl"}})})})})},Labeled {label = TokSpan 391 437, unLabel = PatBind (Labeled {label = TokSpan 391 391, unLabel = VarPat (Labeled {label = TokSpan 391 391, unLabel = Ident {unIdent = "Downstream"}})}) (Labeled {label = TokPos 432, unLabel = Fun2 "\\" (Labeled {label = TokSpan 393 431, unLabel = Parens (Labeled {label = TokSpan 423 429, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 424 428, unLabel = Closure [Labeled {label = TokSpan 425 425, unLabel = Var (Labeled {label = TokSpan 425 425, unLabel = Ident {unIdent = "downack0"}})},Labeled {label = TokSpan 427 427, unLabel = Var (Labeled {label = TokSpan 427 427, unLabel = Ident {unIdent = "downack1"}})}]}) (Labeled {label = TokSpan 394 422, unLabel = Parens (Labeled {label = TokPos 418, unLabel = Fun2 "\\" (Labeled {label = TokSpan 395 417, unLabel = Parens (Labeled {label = TokSpan 411 415, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 412 414, unLabel = Closure [Labeled {label = TokSpan 413 413, unLabel = Var (Labeled {label = TokSpan 413 413, unLabel = Ident {unIdent = "downin1"}})}]}) (Labeled {label = TokSpan 396 410, unLabel = Parens (Labeled {label = TokPos 406, unLabel = Fun2 "\\" (Labeled {label = TokSpan 397 405, unLabel = Parens (Labeled {label = TokSpan 399 403, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 400 402, unLabel = Closure [Labeled {label = TokSpan 401 401, unLabel = Var (Labeled {label = TokSpan 401 401, unLabel = Ident {unIdent = "downin0"}})}]}) (Labeled {label = TokSpan 398 398, unLabel = Var (Labeled {label = TokSpan 398 398, unLabel = Ident {unIdent = "DownHandler0"}})}) (Labeled {label = TokSpan 404 404, unLabel = Var (Labeled {label = TokSpan 404 404, unLabel = Ident {unIdent = "DeMux"}})})})}) (Labeled {label = TokSpan 407 409, unLabel = Closure [Labeled {label = TokSpan 408 408, unLabel = Var (Labeled {label = TokSpan 408 408, unLabel = Ident {unIdent = "downin0"}})}]})})}) (Labeled {label = TokSpan 416 416, unLabel = Var (Labeled {label = TokSpan 416 416, unLabel = Ident {unIdent = "DownHandler1"}})})})}) (Labeled {label = TokSpan 419 421, unLabel = Closure [Labeled {label = TokSpan 420 420, unLabel = Var (Labeled {label = TokSpan 420 420, unLabel = Ident {unIdent = "downin1"}})}]})})}) (Labeled {label = TokSpan 430 430, unLabel = Var (Labeled {label = TokSpan 430 430, unLabel = Ident {unIdent = "DownControl"}})})})}) (Labeled {label = TokSpan 433 437, unLabel = Closure [Labeled {label = TokSpan 434 434, unLabel = Var (Labeled {label = TokSpan 434 434, unLabel = Ident {unIdent = "downack0"}})},Labeled {label = TokSpan 436 436, unLabel = Var (Labeled {label = TokSpan 436 436, unLabel = Ident {unIdent = "downack1"}})}]})})},Labeled {label = TokSpan 439 471, unLabel = PatBind (Labeled {label = TokSpan 439 439, unLabel = VarPat (Labeled {label = TokSpan 439 439, unLabel = Ident {unIdent = "DownstreamV"}})}) (Labeled {label = TokSpan 441 471, unLabel = Parens (Labeled {label = TokSpan 463 469, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 464 468, unLabel = Closure [Labeled {label = TokSpan 465 465, unLabel = Var (Labeled {label = TokSpan 465 465, unLabel = Ident {unIdent = "downack0"}})},Labeled {label = TokSpan 467 467, unLabel = Var (Labeled {label = TokSpan 467 467, unLabel = Ident {unIdent = "downack1"}})}]}) (Labeled {label = TokSpan 442 462, unLabel = Parens (Labeled {label = TokSpan 443 461, unLabel = Parens (Labeled {label = TokSpan 455 459, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 456 458, unLabel = Closure [Labeled {label = TokSpan 457 457, unLabel = Var (Labeled {label = TokSpan 457 457, unLabel = Ident {unIdent = "downin1"}})}]}) (Labeled {label = TokSpan 444 454, unLabel = Parens (Labeled {label = TokSpan 445 453, unLabel = Parens (Labeled {label = TokSpan 447 451, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 448 450, unLabel = Closure [Labeled {label = TokSpan 449 449, unLabel = Var (Labeled {label = TokSpan 449 449, unLabel = Ident {unIdent = "downin0"}})}]}) (Labeled {label = TokSpan 446 446, unLabel = Var (Labeled {label = TokSpan 446 446, unLabel = Ident {unIdent = "DownHandler0"}})}) (Labeled {label = TokSpan 452 452, unLabel = Var (Labeled {label = TokSpan 452 452, unLabel = Ident {unIdent = "DeMux"}})})})})}) (Labeled {label = TokSpan 460 460, unLabel = Var (Labeled {label = TokSpan 460 460, unLabel = Ident {unIdent = "DownHandler1"}})})})})}) (Labeled {label = TokSpan 470 470, unLabel = Var (Labeled {label = TokSpan 470 470, unLabel = Ident {unIdent = "DownControl"}})})})})},Labeled {label = TokSpan 474 490, unLabel = PatBind (Labeled {label = TokSpan 474 474, unLabel = VarPat (Labeled {label = TokSpan 474 474, unLabel = Ident {unIdent = "System"}})}) (Labeled {label = TokPos 485, unLabel = Fun2 "\\" (Labeled {label = TokSpan 477 483, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 478 482, unLabel = Closure [Labeled {label = TokSpan 479 479, unLabel = Var (Labeled {label = TokSpan 479 479, unLabel = Ident {unIdent = "uptodown"}})},Labeled {label = TokSpan 481 481, unLabel = Var (Labeled {label = TokSpan 481 481, unLabel = Ident {unIdent = "downtoup"}})}]}) (Labeled {label = TokSpan 476 476, unLabel = Var (Labeled {label = TokSpan 476 476, unLabel = Ident {unIdent = "Upstream"}})}) (Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "Downstream"}})})}) (Labeled {label = TokSpan 486 490, unLabel = Closure [Labeled {label = TokSpan 487 487, unLabel = Var (Labeled {label = TokSpan 487 487, unLabel = Ident {unIdent = "uptodown"}})},Labeled {label = TokSpan 489 489, unLabel = Var (Labeled {label = TokSpan 489 489, unLabel = Ident {unIdent = "downtoup"}})}]})})},Labeled {label = TokSpan 492 493, unLabel = AssertBool (Labeled {label = TokSpan 493 493, unLabel = Var (Labeled {label = TokSpan 493 493, unLabel = Ident {unIdent = "System"}})})},Labeled {label = TokSpan 495 496, unLabel = AssertBool (Labeled {label = TokSpan 496 496, unLabel = Var (Labeled {label = TokSpan 496 496, unLabel = Ident {unIdent = "System"}})})},Labeled {label = TokSpan 498 499, unLabel = AssertBool (Labeled {label = TokSpan 499 499, unLabel = Var (Labeled {label = TokSpan 499 499, unLabel = Ident {unIdent = "System"}})})},Labeled {label = TokSpan 504 516, unLabel = PatBind (Labeled {label = TokSpan 504 504, unLabel = VarPat (Labeled {label = TokSpan 504 504, unLabel = Ident {unIdent = "Copy0"}})}) (Labeled {label = TokSpan 506 516, unLabel = PrefixExp (Labeled {label = TokSpan 506 506, unLabel = Var (Labeled {label = TokSpan 506 506, unLabel = Ident {unIdent = "upin0"}})}) [Labeled {label = TokSpan 507 510, unLabel = InCommGuarded (Labeled {label = TokSpan 508 508, unLabel = VarPat (Labeled {label = TokSpan 508 508, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 510 510, unLabel = Var (Labeled {label = TokSpan 510 510, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 512 516, unLabel = PrefixExp (Labeled {label = TokSpan 512 512, unLabel = Var (Labeled {label = TokSpan 512 512, unLabel = Ident {unIdent = "downout0"}})}) [Labeled {label = TokSpan 513 514, unLabel = OutComm (Labeled {label = TokSpan 514 514, unLabel = Var (Labeled {label = TokSpan 514 514, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 516 516, unLabel = Var (Labeled {label = TokSpan 516 516, unLabel = Ident {unIdent = "Copy0"}})})})})},Labeled {label = TokSpan 517 529, unLabel = PatBind (Labeled {label = TokSpan 517 517, unLabel = VarPat (Labeled {label = TokSpan 517 517, unLabel = Ident {unIdent = "Copy1"}})}) (Labeled {label = TokSpan 519 529, unLabel = PrefixExp (Labeled {label = TokSpan 519 519, unLabel = Var (Labeled {label = TokSpan 519 519, unLabel = Ident {unIdent = "upin1"}})}) [Labeled {label = TokSpan 520 523, unLabel = InCommGuarded (Labeled {label = TokSpan 521 521, unLabel = VarPat (Labeled {label = TokSpan 521 521, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 523 523, unLabel = Var (Labeled {label = TokSpan 523 523, unLabel = Ident {unIdent = "RawData"}})})}] (Labeled {label = TokSpan 525 529, unLabel = PrefixExp (Labeled {label = TokSpan 525 525, unLabel = Var (Labeled {label = TokSpan 525 525, unLabel = Ident {unIdent = "downout1"}})}) [Labeled {label = TokSpan 526 527, unLabel = OutComm (Labeled {label = TokSpan 527 527, unLabel = Var (Labeled {label = TokSpan 527 527, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 529 529, unLabel = Var (Labeled {label = TokSpan 529 529, unLabel = Ident {unIdent = "Copy1"}})})})})},Labeled {label = TokSpan 530 534, unLabel = PatBind (Labeled {label = TokSpan 530 530, unLabel = VarPat (Labeled {label = TokSpan 530 530, unLabel = Ident {unIdent = "DCopy"}})}) (Labeled {label = TokPos 533, unLabel = Fun2 "|||" (Labeled {label = TokSpan 532 532, unLabel = Var (Labeled {label = TokSpan 532 532, unLabel = Ident {unIdent = "Copy0"}})}) (Labeled {label = TokSpan 534 534, unLabel = Var (Labeled {label = TokSpan 534 534, unLabel = Ident {unIdent = "Copy1"}})})})},Labeled {label = TokSpan 536 539, unLabel = AssertRef (Labeled {label = TokSpan 537 537, unLabel = Var (Labeled {label = TokSpan 537 537, unLabel = Ident {unIdent = "DCopy"}})}) "[FD=" (Labeled {label = TokSpan 539 539, unLabel = Var (Labeled {label = TokSpan 539 539, unLabel = Ident {unIdent = "System"}})})},Labeled {label = TokSpan 541 544, unLabel = AssertRef (Labeled {label = TokSpan 542 542, unLabel = Var (Labeled {label = TokSpan 542 542, unLabel = Ident {unIdent = "System"}})}) "[FD=" (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "DCopy"}})})}]}
