Labeled {label = TokSpan 4 723, unLabel = Module [Labeled {label = TokSpan 4 10, unLabel = PatBind (Labeled {label = TokSpan 4 4, unLabel = VarPat (Labeled {label = TokSpan 4 4, unLabel = Ident {unIdent = "QUEUENUM"}})}) (Labeled {label = TokSpan 6 10, unLabel = SetClose (Labeled {label = TokSpan 7 7, unLabel = IntExp 1},Labeled {label = TokSpan 9 9, unLabel = Var (Labeled {label = TokSpan 9 9, unLabel = Ident {unIdent = "numQueues"}})})})},Labeled {label = TokSpan 11 24, unLabel = DataType (Labeled {label = TokSpan 12 12, unLabel = Ident {unIdent = "CUSTOMER"}}) [Labeled {label = TokSpan 14 14, unLabel = Constructor (Labeled {label = TokSpan 14 14, unLabel = Ident {unIdent = "c1"}}) Nothing},Labeled {label = TokSpan 16 16, unLabel = Constructor (Labeled {label = TokSpan 16 16, unLabel = Ident {unIdent = "c2"}}) Nothing},Labeled {label = TokSpan 18 18, unLabel = Constructor (Labeled {label = TokSpan 18 18, unLabel = Ident {unIdent = "c3"}}) Nothing},Labeled {label = TokSpan 20 20, unLabel = Constructor (Labeled {label = TokSpan 20 20, unLabel = Ident {unIdent = "c4"}}) Nothing},Labeled {label = TokSpan 22 22, unLabel = Constructor (Labeled {label = TokSpan 22 22, unLabel = Ident {unIdent = "c5"}}) Nothing},Labeled {label = TokSpan 24 24, unLabel = Constructor (Labeled {label = TokSpan 24 24, unLabel = Ident {unIdent = "c6"}}) Nothing}]},Labeled {label = TokSpan 25 30, unLabel = DataType (Labeled {label = TokSpan 26 26, unLabel = Ident {unIdent = "STATUS"}}) [Labeled {label = TokSpan 28 28, unLabel = Constructor (Labeled {label = TokSpan 28 28, unLabel = Ident {unIdent = "success"}}) Nothing},Labeled {label = TokSpan 30 30, unLabel = Constructor (Labeled {label = TokSpan 30 30, unLabel = Ident {unIdent = "fail"}}) Nothing}]},Labeled {label = TokSpan 31 36, unLabel = DataType (Labeled {label = TokSpan 32 32, unLabel = Ident {unIdent = "QSTATUS"}}) [Labeled {label = TokSpan 34 34, unLabel = Constructor (Labeled {label = TokSpan 34 34, unLabel = Ident {unIdent = "yes"}}) Nothing},Labeled {label = TokSpan 36 36, unLabel = Constructor (Labeled {label = TokSpan 36 36, unLabel = Ident {unIdent = "no"}}) Nothing}]},Labeled {label = TokSpan 37 39, unLabel = PatBind (Labeled {label = TokSpan 37 37, unLabel = VarPat (Labeled {label = TokSpan 37 37, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 39 39, unLabel = IntExp 2})},Labeled {label = TokSpan 40 42, unLabel = PatBind (Labeled {label = TokSpan 40 40, unLabel = VarPat (Labeled {label = TokSpan 40 40, unLabel = Ident {unIdent = "defaultCounter"}})}) (Labeled {label = TokSpan 42 42, unLabel = IntExp 1})},Labeled {label = TokSpan 43 45, unLabel = PatBind (Labeled {label = TokSpan 43 43, unLabel = VarPat (Labeled {label = TokSpan 43 43, unLabel = Ident {unIdent = "defaultCustomer"}})}) (Labeled {label = TokSpan 45 45, unLabel = Var (Labeled {label = TokSpan 45 45, unLabel = Ident {unIdent = "c1"}})})},Labeled {label = TokSpan 46 50, unLabel = PatBind (Labeled {label = TokSpan 46 46, unLabel = VarPat (Labeled {label = TokSpan 46 46, unLabel = Ident {unIdent = "maxQueueingCustomers"}})}) (Labeled {label = TokPos 49, unLabel = Fun2 "-" (Labeled {label = TokSpan 48 48, unLabel = Var (Labeled {label = TokSpan 48 48, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 50 50, unLabel = IntExp 1})})},Labeled {label = TokSpan 51 53, unLabel = PatBind (Labeled {label = TokSpan 51 51, unLabel = VarPat (Labeled {label = TokSpan 51 51, unLabel = Ident {unIdent = "numQueues"}})}) (Labeled {label = TokSpan 53 53, unLabel = IntExp 2})},Labeled {label = TokSpan 55 58, unLabel = Channel [Labeled {label = TokSpan 56 56, unLabel = Ident {unIdent = "enterBank"}}] (Just (Labeled {label = TokSpan 58 58, unLabel = TypeDot [Labeled {label = TokSpan 58 58, unLabel = Var (Labeled {label = TokSpan 58 58, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 59 62, unLabel = Channel [Labeled {label = TokSpan 60 60, unLabel = Ident {unIdent = "leaveBank"}}] (Just (Labeled {label = TokSpan 62 62, unLabel = TypeDot [Labeled {label = TokSpan 62 62, unLabel = Var (Labeled {label = TokSpan 62 62, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 63 66, unLabel = Channel [Labeled {label = TokSpan 64 64, unLabel = Ident {unIdent = "report"}}] (Just (Labeled {label = TokSpan 66 66, unLabel = TypeDot [Labeled {label = TokSpan 66 66, unLabel = Var (Labeled {label = TokSpan 66 66, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 68 71, unLabel = Channel [Labeled {label = TokSpan 69 69, unLabel = Ident {unIdent = "com1"}}] (Just (Labeled {label = TokSpan 71 71, unLabel = TypeDot [Labeled {label = TokSpan 71 71, unLabel = Var (Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 72 75, unLabel = Channel [Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "com3"}}] (Just (Labeled {label = TokSpan 75 75, unLabel = TypeDot [Labeled {label = TokSpan 75 75, unLabel = Var (Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 76 79, unLabel = Channel [Labeled {label = TokSpan 77 77, unLabel = Ident {unIdent = "canJoinResponse"}}] (Just (Labeled {label = TokSpan 79 79, unLabel = TypeDot [Labeled {label = TokSpan 79 79, unLabel = Var (Labeled {label = TokSpan 79 79, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 80 81, unLabel = Channel [Labeled {label = TokSpan 81 81, unLabel = Ident {unIdent = "retrieveCustomer"}}] Nothing},Labeled {label = TokSpan 83 86, unLabel = Channel [Labeled {label = TokSpan 84 84, unLabel = Ident {unIdent = "joinQueue"}}] (Just (Labeled {label = TokSpan 86 86, unLabel = TypeDot [Labeled {label = TokSpan 86 86, unLabel = Var (Labeled {label = TokSpan 86 86, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 87 92, unLabel = Channel [Labeled {label = TokSpan 88 88, unLabel = Ident {unIdent = "leaveQueue"}}] (Just (Labeled {label = TokSpan 90 92, unLabel = TypeDot [Labeled {label = TokSpan 90 90, unLabel = Var (Labeled {label = TokSpan 90 90, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 92 92, unLabel = Var (Labeled {label = TokSpan 92 92, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 93 98, unLabel = Channel [Labeled {label = TokSpan 94 94, unLabel = Ident {unIdent = "queryQueueEmpty"}}] (Just (Labeled {label = TokSpan 96 98, unLabel = TypeDot [Labeled {label = TokSpan 96 96, unLabel = Var (Labeled {label = TokSpan 96 96, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 98 98, unLabel = Var (Labeled {label = TokSpan 98 98, unLabel = Ident {unIdent = "QSTATUS"}})}]}))},Labeled {label = TokSpan 99 99, unLabel = FunBind (Labeled {label = TokSpan 99 99, unLabel = Ident {unIdent = "inc"}}) [FunCase [[Labeled {label = TokSpan 101 101, unLabel = VarPat (Labeled {label = TokSpan 101 101, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokPos 109, unLabel = Fun2 "+" (Labeled {label = TokSpan 104 108, unLabel = Parens (Labeled {label = TokPos 106, unLabel = Fun2 "%" (Labeled {label = TokSpan 105 105, unLabel = Var (Labeled {label = TokSpan 105 105, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 107 107, unLabel = Var (Labeled {label = TokSpan 107 107, unLabel = Ident {unIdent = "numQueues"}})})})}) (Labeled {label = TokSpan 110 110, unLabel = IntExp 1})})]},Labeled {label = TokSpan 111 111, unLabel = FunBind (Labeled {label = TokSpan 111 111, unLabel = Ident {unIdent = "dec"}}) [FunCase [[Labeled {label = TokSpan 113 113, unLabel = VarPat (Labeled {label = TokSpan 113 113, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokPos 125, unLabel = Fun2 "+" (Labeled {label = TokSpan 116 124, unLabel = Parens (Labeled {label = TokPos 122, unLabel = Fun2 "%" (Labeled {label = TokSpan 117 121, unLabel = Parens (Labeled {label = TokPos 119, unLabel = Fun2 "-" (Labeled {label = TokSpan 118 118, unLabel = Var (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 120 120, unLabel = IntExp 2})})}) (Labeled {label = TokSpan 123 123, unLabel = Var (Labeled {label = TokSpan 123 123, unLabel = Ident {unIdent = "numQueues"}})})})}) (Labeled {label = TokSpan 126 126, unLabel = IntExp 1})})]},Labeled {label = TokSpan 136 143, unLabel = PatBind (Labeled {label = TokSpan 136 136, unLabel = VarPat (Labeled {label = TokSpan 136 136, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 138 143, unLabel = CallFunction (Labeled {label = TokSpan 138 138, unLabel = Var (Labeled {label = TokSpan 138 138, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 140 140, unLabel = IntExp 0},Labeled {label = TokSpan 142 142, unLabel = Var (Labeled {label = TokSpan 142 142, unLabel = Ident {unIdent = "defaultCustomer"}})}]]})},Labeled {label = TokSpan 144 144, unLabel = FunBind (Labeled {label = TokSpan 144 144, unLabel = Ident {unIdent = "CurrentCtrl"}}) [FunCase [[Labeled {label = TokSpan 146 146, unLabel = VarPat (Labeled {label = TokSpan 146 146, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 148 148, unLabel = VarPat (Labeled {label = TokSpan 148 148, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 157, unLabel = Fun2 "[]" (Labeled {label = TokSpan 151 156, unLabel = CallFunction (Labeled {label = TokSpan 151 151, unLabel = Var (Labeled {label = TokSpan 151 151, unLabel = Ident {unIdent = "JoinCtrl"}})}) [[Labeled {label = TokSpan 153 153, unLabel = Var (Labeled {label = TokSpan 153 153, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 155 155, unLabel = Var (Labeled {label = TokSpan 155 155, unLabel = Ident {unIdent = "currentCust"}})}]]}) (Labeled {label = TokSpan 158 163, unLabel = CallFunction (Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "LeaveCtrl"}})}) [[Labeled {label = TokSpan 160 160, unLabel = Var (Labeled {label = TokSpan 160 160, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 162 162, unLabel = Var (Labeled {label = TokSpan 162 162, unLabel = Ident {unIdent = "currentCust"}})}]]})})]},Labeled {label = TokSpan 167 167, unLabel = FunBind (Labeled {label = TokSpan 167 167, unLabel = Ident {unIdent = "JoinCtrl"}}) [FunCase [[Labeled {label = TokSpan 169 169, unLabel = VarPat (Labeled {label = TokSpan 169 169, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 171 171, unLabel = VarPat (Labeled {label = TokSpan 171 171, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 177, unLabel = Fun2 "&" (Labeled {label = TokPos 175, unLabel = Fun2 "<" (Labeled {label = TokSpan 174 174, unLabel = Var (Labeled {label = TokSpan 174 174, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 176 176, unLabel = Var (Labeled {label = TokSpan 176 176, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 178 276, unLabel = PrefixExp (Labeled {label = TokSpan 178 178, unLabel = Var (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 179 180, unLabel = InComm (Labeled {label = TokSpan 180 180, unLabel = VarPat (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 182 276, unLabel = Parens (Labeled {label = TokPos 251, unLabel = Fun2 "[]" (Labeled {label = TokPos 201, unLabel = Fun2 "[]" (Labeled {label = TokSpan 183 200, unLabel = Parens (Labeled {label = TokPos 187, unLabel = Fun2 "&" (Labeled {label = TokPos 185, unLabel = Fun2 "==" (Labeled {label = TokSpan 184 184, unLabel = Var (Labeled {label = TokSpan 184 184, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 186 186, unLabel = IntExp 0})}) (Labeled {label = TokSpan 188 199, unLabel = PrefixExp (Labeled {label = TokSpan 188 188, unLabel = Var (Labeled {label = TokSpan 188 188, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 189 190, unLabel = OutComm (Labeled {label = TokSpan 190 190, unLabel = Var (Labeled {label = TokSpan 190 190, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 192 199, unLabel = CallFunction (Labeled {label = TokSpan 192 192, unLabel = Var (Labeled {label = TokSpan 192 192, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 195, unLabel = Fun2 "+" (Labeled {label = TokSpan 194 194, unLabel = Var (Labeled {label = TokSpan 194 194, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 196 196, unLabel = IntExp 1})},Labeled {label = TokSpan 198 198, unLabel = Var (Labeled {label = TokSpan 198 198, unLabel = Ident {unIdent = "cc"}})}]]})})})}) (Labeled {label = TokSpan 202 250, unLabel = Parens (Labeled {label = TokPos 215, unLabel = Fun2 "&" (Labeled {label = TokSpan 203 214, unLabel = Parens (Labeled {label = TokPos 207, unLabel = AndExp (Labeled {label = TokPos 206, unLabel = Fun2 ">" (Labeled {label = TokSpan 204 204, unLabel = Var (Labeled {label = TokSpan 204 204, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 206 206, unLabel = IntExp 0})}) (Labeled {label = TokPos 208, unLabel = NotExp (Labeled {label = TokSpan 209 213, unLabel = Parens (Labeled {label = TokPos 211, unLabel = Fun2 "==" (Labeled {label = TokSpan 210 210, unLabel = Var (Labeled {label = TokSpan 210 210, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 212 212, unLabel = Var (Labeled {label = TokSpan 212 212, unLabel = Ident {unIdent = "currentCust"}})})})})})})}) (Labeled {label = TokSpan 216 249, unLabel = PrefixExp (Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 217 218, unLabel = OutComm (Labeled {label = TokSpan 218 218, unLabel = Var (Labeled {label = TokSpan 218 218, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 220 249, unLabel = PrefixExp (Labeled {label = TokSpan 220 220, unLabel = Var (Labeled {label = TokSpan 220 220, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 221 222, unLabel = InComm (Labeled {label = TokSpan 222 222, unLabel = VarPat (Labeled {label = TokSpan 222 222, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 224 249, unLabel = PrefixExp (Labeled {label = TokSpan 224 224, unLabel = Var (Labeled {label = TokSpan 224 224, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 225 226, unLabel = OutComm (Labeled {label = TokSpan 226 226, unLabel = Var (Labeled {label = TokSpan 226 226, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 228 249, unLabel = Ifte (Labeled {label = TokSpan 229 233, unLabel = Parens (Labeled {label = TokPos 231, unLabel = Fun2 "==" (Labeled {label = TokSpan 230 230, unLabel = Var (Labeled {label = TokSpan 230 230, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 232 232, unLabel = Var (Labeled {label = TokSpan 232 232, unLabel = Ident {unIdent = "success"}})})})}) (Labeled {label = TokSpan 235 242, unLabel = CallFunction (Labeled {label = TokSpan 235 235, unLabel = Var (Labeled {label = TokSpan 235 235, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 238, unLabel = Fun2 "+" (Labeled {label = TokSpan 237 237, unLabel = Var (Labeled {label = TokSpan 237 237, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 239 239, unLabel = IntExp 1})},Labeled {label = TokSpan 241 241, unLabel = Var (Labeled {label = TokSpan 241 241, unLabel = Ident {unIdent = "currentCust"}})}]]}) (Labeled {label = TokSpan 244 249, unLabel = CallFunction (Labeled {label = TokSpan 244 244, unLabel = Var (Labeled {label = TokSpan 244 244, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 246 246, unLabel = Var (Labeled {label = TokSpan 246 246, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 248 248, unLabel = Var (Labeled {label = TokSpan 248 248, unLabel = Ident {unIdent = "currentCust"}})}]]})})})})})})})}) (Labeled {label = TokSpan 252 275, unLabel = Parens (Labeled {label = TokPos 264, unLabel = Fun2 "&" (Labeled {label = TokSpan 253 263, unLabel = Parens (Labeled {label = TokPos 257, unLabel = AndExp (Labeled {label = TokPos 256, unLabel = Fun2 ">" (Labeled {label = TokSpan 254 254, unLabel = Var (Labeled {label = TokSpan 254 254, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 256 256, unLabel = IntExp 0})}) (Labeled {label = TokSpan 258 262, unLabel = Parens (Labeled {label = TokPos 260, unLabel = Fun2 "==" (Labeled {label = TokSpan 259 259, unLabel = Var (Labeled {label = TokSpan 259 259, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 261 261, unLabel = Var (Labeled {label = TokSpan 261 261, unLabel = Ident {unIdent = "currentCust"}})})})})})}) (Labeled {label = TokSpan 265 274, unLabel = PrefixExp (Labeled {label = TokSpan 265 265, unLabel = Var (Labeled {label = TokSpan 265 265, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 266 267, unLabel = OutComm (Labeled {label = TokSpan 267 267, unLabel = Var (Labeled {label = TokSpan 267 267, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 269 274, unLabel = CallFunction (Labeled {label = TokSpan 269 269, unLabel = Var (Labeled {label = TokSpan 269 269, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 271 271, unLabel = Var (Labeled {label = TokSpan 271 271, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 273 273, unLabel = Var (Labeled {label = TokSpan 273 273, unLabel = Ident {unIdent = "currentCust"}})}]]})})})})})})})})]},Labeled {label = TokSpan 286 286, unLabel = FunBind (Labeled {label = TokSpan 286 286, unLabel = Ident {unIdent = "LeaveCtrl"}}) [FunCase [[Labeled {label = TokSpan 288 288, unLabel = VarPat (Labeled {label = TokSpan 288 288, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 290 290, unLabel = VarPat (Labeled {label = TokSpan 290 290, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 309, unLabel = Fun2 "[]" (Labeled {label = TokSpan 293 308, unLabel = Parens (Labeled {label = TokPos 297, unLabel = Fun2 "&" (Labeled {label = TokPos 295, unLabel = Fun2 "==" (Labeled {label = TokSpan 294 294, unLabel = Var (Labeled {label = TokSpan 294 294, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 296 296, unLabel = IntExp 1})}) (Labeled {label = TokSpan 298 307, unLabel = PrefixExp (Labeled {label = TokSpan 298 298, unLabel = Var (Labeled {label = TokSpan 298 298, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 299 300, unLabel = OutComm (Labeled {label = TokSpan 300 300, unLabel = Var (Labeled {label = TokSpan 300 300, unLabel = Ident {unIdent = "currentCust"}})})}] (Labeled {label = TokSpan 302 307, unLabel = CallFunction (Labeled {label = TokSpan 302 302, unLabel = Var (Labeled {label = TokSpan 302 302, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 304 304, unLabel = IntExp 0},Labeled {label = TokSpan 306 306, unLabel = Var (Labeled {label = TokSpan 306 306, unLabel = Ident {unIdent = "defaultCustomer"}})}]]})})})}) (Labeled {label = TokSpan 310 333, unLabel = Parens (Labeled {label = TokPos 314, unLabel = Fun2 "&" (Labeled {label = TokPos 313, unLabel = Fun2 ">" (Labeled {label = TokSpan 311 311, unLabel = Var (Labeled {label = TokSpan 311 311, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 313 313, unLabel = IntExp 1})}) (Labeled {label = TokSpan 315 332, unLabel = PrefixExp (Labeled {label = TokSpan 315 315, unLabel = Var (Labeled {label = TokSpan 315 315, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 316 317, unLabel = OutComm (Labeled {label = TokSpan 317 317, unLabel = Var (Labeled {label = TokSpan 317 317, unLabel = Ident {unIdent = "currentCust"}})})}] (Labeled {label = TokSpan 319 332, unLabel = PrefixExp (Labeled {label = TokSpan 319 319, unLabel = Var (Labeled {label = TokSpan 319 319, unLabel = Ident {unIdent = "retrieveCustomer"}})}) [] (Labeled {label = TokSpan 321 332, unLabel = PrefixExp (Labeled {label = TokSpan 321 321, unLabel = Var (Labeled {label = TokSpan 321 321, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 322 323, unLabel = InComm (Labeled {label = TokSpan 323 323, unLabel = VarPat (Labeled {label = TokSpan 323 323, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 325 332, unLabel = CallFunction (Labeled {label = TokSpan 325 325, unLabel = Var (Labeled {label = TokSpan 325 325, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 328, unLabel = Fun2 "-" (Labeled {label = TokSpan 327 327, unLabel = Var (Labeled {label = TokSpan 327 327, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 329 329, unLabel = IntExp 1})},Labeled {label = TokSpan 331 331, unLabel = Var (Labeled {label = TokSpan 331 331, unLabel = Ident {unIdent = "cc"}})}]]})})})})})})})]},Labeled {label = TokSpan 336 346, unLabel = PatBind (Labeled {label = TokSpan 336 336, unLabel = VarPat (Labeled {label = TokSpan 336 336, unLabel = Ident {unIdent = "QueuesCtrl"}})}) (Labeled {label = TokSpan 338 346, unLabel = CallFunction (Labeled {label = TokSpan 338 338, unLabel = Var (Labeled {label = TokSpan 338 338, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 340 340, unLabel = IntExp 0},Labeled {label = TokSpan 342 342, unLabel = IntExp 1},Labeled {label = TokSpan 344 345, unLabel = SetEnum []}]]})},Labeled {label = TokSpan 347 347, unLabel = FunBind (Labeled {label = TokSpan 347 347, unLabel = Ident {unIdent = "QCtrl"}}) [FunCase [[Labeled {label = TokSpan 349 349, unLabel = VarPat (Labeled {label = TokSpan 349 349, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 351 351, unLabel = VarPat (Labeled {label = TokSpan 351 351, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 353 353, unLabel = VarPat (Labeled {label = TokSpan 353 353, unLabel = Ident {unIdent = "custSet"}})}]] (Labeled {label = TokPos 414, unLabel = Fun2 "[]" (Labeled {label = TokSpan 356 413, unLabel = Parens (Labeled {label = TokPos 360, unLabel = Fun2 "&" (Labeled {label = TokPos 358, unLabel = Fun2 "<" (Labeled {label = TokSpan 357 357, unLabel = Var (Labeled {label = TokSpan 357 357, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 359 359, unLabel = Var (Labeled {label = TokSpan 359 359, unLabel = Ident {unIdent = "maxQueueingCustomers"}})})}) (Labeled {label = TokSpan 361 412, unLabel = PrefixExp (Labeled {label = TokSpan 361 361, unLabel = Var (Labeled {label = TokSpan 361 361, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 362 363, unLabel = InComm (Labeled {label = TokSpan 363 363, unLabel = VarPat (Labeled {label = TokSpan 363 363, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 365 412, unLabel = Ifte (Labeled {label = TokSpan 366 373, unLabel = Parens (Labeled {label = TokSpan 367 372, unLabel = CallBuiltIn (Labeled {label = TokSpan 367 367, unLabel = BuiltIn "member"}) [[Labeled {label = TokSpan 369 369, unLabel = Var (Labeled {label = TokSpan 369 369, unLabel = Ident {unIdent = "cc"}})},Labeled {label = TokSpan 371 371, unLabel = Var (Labeled {label = TokSpan 371 371, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 375 386, unLabel = PrefixExp (Labeled {label = TokSpan 375 375, unLabel = Var (Labeled {label = TokSpan 375 375, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 376 377, unLabel = OutComm (Labeled {label = TokSpan 377 377, unLabel = Var (Labeled {label = TokSpan 377 377, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 379 386, unLabel = CallFunction (Labeled {label = TokSpan 379 379, unLabel = Var (Labeled {label = TokSpan 379 379, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 381 381, unLabel = Var (Labeled {label = TokSpan 381 381, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 383 383, unLabel = Var (Labeled {label = TokSpan 383 383, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 385 385, unLabel = Var (Labeled {label = TokSpan 385 385, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 388 412, unLabel = PrefixExp (Labeled {label = TokSpan 388 388, unLabel = Var (Labeled {label = TokSpan 388 388, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 389 390, unLabel = OutComm (Labeled {label = TokSpan 390 390, unLabel = Var (Labeled {label = TokSpan 390 390, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 392 412, unLabel = PrefixExp (Labeled {label = TokSpan 392 392, unLabel = Var (Labeled {label = TokSpan 392 392, unLabel = Ident {unIdent = "joinQueue"}})}) [Labeled {label = TokSpan 393 394, unLabel = OutComm (Labeled {label = TokSpan 394 394, unLabel = Var (Labeled {label = TokSpan 394 394, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 396 412, unLabel = CallFunction (Labeled {label = TokSpan 396 396, unLabel = Var (Labeled {label = TokSpan 396 396, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 399, unLabel = Fun2 "+" (Labeled {label = TokSpan 398 398, unLabel = Var (Labeled {label = TokSpan 398 398, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 400 400, unLabel = IntExp 1})},Labeled {label = TokSpan 402 402, unLabel = Var (Labeled {label = TokSpan 402 402, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 404 411, unLabel = CallBuiltIn (Labeled {label = TokSpan 404 404, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 406 406, unLabel = Var (Labeled {label = TokSpan 406 406, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 408 410, unLabel = SetEnum [Labeled {label = TokSpan 409 409, unLabel = Var (Labeled {label = TokSpan 409 409, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})})})})})})}) (Labeled {label = TokSpan 415 435, unLabel = Parens (Labeled {label = TokPos 419, unLabel = Fun2 "&" (Labeled {label = TokPos 418, unLabel = Fun2 ">" (Labeled {label = TokSpan 416 416, unLabel = Var (Labeled {label = TokSpan 416 416, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 418 418, unLabel = IntExp 0})}) (Labeled {label = TokSpan 420 434, unLabel = PrefixExp (Labeled {label = TokSpan 420 420, unLabel = Var (Labeled {label = TokSpan 420 420, unLabel = Ident {unIdent = "retrieveCustomer"}})}) [] (Labeled {label = TokSpan 422 434, unLabel = CallFunction (Labeled {label = TokSpan 422 422, unLabel = Var (Labeled {label = TokSpan 422 422, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 424 424, unLabel = Var (Labeled {label = TokSpan 424 424, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 426 426, unLabel = Var (Labeled {label = TokSpan 426 426, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 428 431, unLabel = CallFunction (Labeled {label = TokSpan 428 428, unLabel = Var (Labeled {label = TokSpan 428 428, unLabel = Ident {unIdent = "dec"}})}) [[Labeled {label = TokSpan 430 430, unLabel = Var (Labeled {label = TokSpan 430 430, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 433 433, unLabel = Var (Labeled {label = TokSpan 433 433, unLabel = Ident {unIdent = "custSet"}})}]]})})})})})]},Labeled {label = TokSpan 438 438, unLabel = FunBind (Labeled {label = TokSpan 438 438, unLabel = Ident {unIdent = "NextQCtrl"}}) [FunCase [[Labeled {label = TokSpan 440 440, unLabel = VarPat (Labeled {label = TokSpan 440 440, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 442 442, unLabel = VarPat (Labeled {label = TokSpan 442 442, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 444 444, unLabel = VarPat (Labeled {label = TokSpan 444 444, unLabel = Ident {unIdent = "lastQueueNo"}})},Labeled {label = TokSpan 446 446, unLabel = VarPat (Labeled {label = TokSpan 446 446, unLabel = Ident {unIdent = "custSet"}})}]] (Labeled {label = TokPos 517, unLabel = Fun2 "[]" (Labeled {label = TokSpan 449 516, unLabel = Parens (Labeled {label = TokPos 456, unLabel = Fun2 "&" (Labeled {label = TokPos 450, unLabel = NotExp (Labeled {label = TokSpan 451 455, unLabel = Parens (Labeled {label = TokPos 453, unLabel = Fun2 "==" (Labeled {label = TokSpan 452 452, unLabel = Var (Labeled {label = TokSpan 452 452, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 454 454, unLabel = Var (Labeled {label = TokSpan 454 454, unLabel = Ident {unIdent = "lastQueueNo"}})})})})}) (Labeled {label = TokSpan 457 515, unLabel = PrefixExp (Labeled {label = TokSpan 457 457, unLabel = Var (Labeled {label = TokSpan 457 457, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 458 459, unLabel = OutComm (Labeled {label = TokSpan 459 459, unLabel = Var (Labeled {label = TokSpan 459 459, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 460 461, unLabel = InComm (Labeled {label = TokSpan 461 461, unLabel = VarPat (Labeled {label = TokSpan 461 461, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 463 515, unLabel = Ifte (Labeled {label = TokSpan 464 468, unLabel = Parens (Labeled {label = TokPos 466, unLabel = Fun2 "==" (Labeled {label = TokSpan 465 465, unLabel = Var (Labeled {label = TokSpan 465 465, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 467 467, unLabel = Var (Labeled {label = TokSpan 467 467, unLabel = Ident {unIdent = "no"}})})})}) (Labeled {label = TokSpan 470 501, unLabel = PrefixExp (Labeled {label = TokSpan 470 470, unLabel = Var (Labeled {label = TokSpan 470 470, unLabel = Ident {unIdent = "leaveQueue"}})}) [Labeled {label = TokSpan 471 472, unLabel = OutComm (Labeled {label = TokSpan 472 472, unLabel = Var (Labeled {label = TokSpan 472 472, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 473 476, unLabel = InCommGuarded (Labeled {label = TokSpan 474 474, unLabel = VarPat (Labeled {label = TokSpan 474 474, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 476 476, unLabel = Var (Labeled {label = TokSpan 476 476, unLabel = Ident {unIdent = "custSet"}})})}] (Labeled {label = TokSpan 478 501, unLabel = PrefixExp (Labeled {label = TokSpan 478 478, unLabel = Var (Labeled {label = TokSpan 478 478, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 479 480, unLabel = OutComm (Labeled {label = TokSpan 480 480, unLabel = Var (Labeled {label = TokSpan 480 480, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 482 501, unLabel = CallFunction (Labeled {label = TokSpan 482 482, unLabel = Var (Labeled {label = TokSpan 482 482, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 485, unLabel = Fun2 "-" (Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 486 486, unLabel = IntExp 1})},Labeled {label = TokSpan 488 491, unLabel = CallFunction (Labeled {label = TokSpan 488 488, unLabel = Var (Labeled {label = TokSpan 488 488, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 490 490, unLabel = Var (Labeled {label = TokSpan 490 490, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 493 500, unLabel = CallBuiltIn (Labeled {label = TokSpan 493 493, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 495 495, unLabel = Var (Labeled {label = TokSpan 495 495, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 497 499, unLabel = SetEnum [Labeled {label = TokSpan 498 498, unLabel = Var (Labeled {label = TokSpan 498 498, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})})}) (Labeled {label = TokSpan 503 515, unLabel = CallFunction (Labeled {label = TokSpan 503 503, unLabel = Var (Labeled {label = TokSpan 503 503, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 505 505, unLabel = Var (Labeled {label = TokSpan 505 505, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 507 510, unLabel = CallFunction (Labeled {label = TokSpan 507 507, unLabel = Var (Labeled {label = TokSpan 507 507, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 509 509, unLabel = Var (Labeled {label = TokSpan 509 509, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 512 512, unLabel = Var (Labeled {label = TokSpan 512 512, unLabel = Ident {unIdent = "lastQueueNo"}})},Labeled {label = TokSpan 514 514, unLabel = Var (Labeled {label = TokSpan 514 514, unLabel = Ident {unIdent = "custSet"}})}]]})})})})}) (Labeled {label = TokSpan 518 563, unLabel = Parens (Labeled {label = TokPos 524, unLabel = Fun2 "&" (Labeled {label = TokSpan 519 523, unLabel = Parens (Labeled {label = TokPos 521, unLabel = Fun2 "==" (Labeled {label = TokSpan 520 520, unLabel = Var (Labeled {label = TokSpan 520 520, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 522 522, unLabel = Var (Labeled {label = TokSpan 522 522, unLabel = Ident {unIdent = "lastQueueNo"}})})})}) (Labeled {label = TokSpan 525 562, unLabel = PrefixExp (Labeled {label = TokSpan 525 525, unLabel = Var (Labeled {label = TokSpan 525 525, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 526 527, unLabel = OutComm (Labeled {label = TokSpan 527 527, unLabel = Var (Labeled {label = TokSpan 527 527, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 528 529, unLabel = OutComm (Labeled {label = TokSpan 529 529, unLabel = Var (Labeled {label = TokSpan 529 529, unLabel = Ident {unIdent = "no"}})})}] (Labeled {label = TokSpan 531 562, unLabel = PrefixExp (Labeled {label = TokSpan 531 531, unLabel = Var (Labeled {label = TokSpan 531 531, unLabel = Ident {unIdent = "leaveQueue"}})}) [Labeled {label = TokSpan 532 533, unLabel = OutComm (Labeled {label = TokSpan 533 533, unLabel = Var (Labeled {label = TokSpan 533 533, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 534 537, unLabel = InCommGuarded (Labeled {label = TokSpan 535 535, unLabel = VarPat (Labeled {label = TokSpan 535 535, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 537 537, unLabel = Var (Labeled {label = TokSpan 537 537, unLabel = Ident {unIdent = "custSet"}})})}] (Labeled {label = TokSpan 539 562, unLabel = PrefixExp (Labeled {label = TokSpan 539 539, unLabel = Var (Labeled {label = TokSpan 539 539, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 540 541, unLabel = OutComm (Labeled {label = TokSpan 541 541, unLabel = Var (Labeled {label = TokSpan 541 541, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 543 562, unLabel = CallFunction (Labeled {label = TokSpan 543 543, unLabel = Var (Labeled {label = TokSpan 543 543, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 546, unLabel = Fun2 "-" (Labeled {label = TokSpan 545 545, unLabel = Var (Labeled {label = TokSpan 545 545, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 547 547, unLabel = IntExp 1})},Labeled {label = TokSpan 549 552, unLabel = CallFunction (Labeled {label = TokSpan 549 549, unLabel = Var (Labeled {label = TokSpan 549 549, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 551 551, unLabel = Var (Labeled {label = TokSpan 551 551, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 554 561, unLabel = CallBuiltIn (Labeled {label = TokSpan 554 554, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 556 556, unLabel = Var (Labeled {label = TokSpan 556 556, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 558 560, unLabel = SetEnum [Labeled {label = TokSpan 559 559, unLabel = Var (Labeled {label = TokSpan 559 559, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})})})})})})})]},Labeled {label = TokSpan 569 579, unLabel = PatBind (Labeled {label = TokSpan 569 569, unLabel = VarPat (Labeled {label = TokSpan 569 569, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 571 579, unLabel = Closure [Labeled {label = TokSpan 572 572, unLabel = Var (Labeled {label = TokSpan 572 572, unLabel = Ident {unIdent = "com1"}})},Labeled {label = TokSpan 574 574, unLabel = Var (Labeled {label = TokSpan 574 574, unLabel = Ident {unIdent = "com3"}})},Labeled {label = TokSpan 576 576, unLabel = Var (Labeled {label = TokSpan 576 576, unLabel = Ident {unIdent = "canJoinResponse"}})},Labeled {label = TokSpan 578 578, unLabel = Var (Labeled {label = TokSpan 578 578, unLabel = Ident {unIdent = "retrieveCustomer"}})}]})},Labeled {label = TokSpan 580 588, unLabel = PatBind (Labeled {label = TokSpan 580 580, unLabel = VarPat (Labeled {label = TokSpan 580 580, unLabel = Ident {unIdent = "B"}})}) (Labeled {label = TokSpan 582 588, unLabel = Closure [Labeled {label = TokSpan 583 583, unLabel = Var (Labeled {label = TokSpan 583 583, unLabel = Ident {unIdent = "joinQueue"}})},Labeled {label = TokSpan 585 585, unLabel = Var (Labeled {label = TokSpan 585 585, unLabel = Ident {unIdent = "leaveQueue"}})},Labeled {label = TokSpan 587 587, unLabel = Var (Labeled {label = TokSpan 587 587, unLabel = Ident {unIdent = "queryQueueEmpty"}})}]})},Labeled {label = TokSpan 589 602, unLabel = PatBind (Labeled {label = TokSpan 589 589, unLabel = VarPat (Labeled {label = TokSpan 589 589, unLabel = Ident {unIdent = "BankSystem"}})}) (Labeled {label = TokPos 596, unLabel = Fun2 "\\" (Labeled {label = TokSpan 592 594, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 593 593, unLabel = Var (Labeled {label = TokSpan 593 593, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 591 591, unLabel = Var (Labeled {label = TokSpan 591 591, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 595 595, unLabel = Var (Labeled {label = TokSpan 595 595, unLabel = Ident {unIdent = "QueuesCtrl"}})})}) (Labeled {label = TokSpan 597 602, unLabel = CallBuiltIn (Labeled {label = TokSpan 597 597, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 599 599, unLabel = Var (Labeled {label = TokSpan 599 599, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 601 601, unLabel = Var (Labeled {label = TokSpan 601 601, unLabel = Ident {unIdent = "B"}})}]]})})},Labeled {label = TokSpan 603 609, unLabel = PatBind (Labeled {label = TokSpan 603 603, unLabel = VarPat (Labeled {label = TokSpan 603 603, unLabel = Ident {unIdent = "FullBankSystem"}})}) (Labeled {label = TokSpan 606 608, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 607 607, unLabel = Var (Labeled {label = TokSpan 607 607, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 605 605, unLabel = Var (Labeled {label = TokSpan 605 605, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 609 609, unLabel = Var (Labeled {label = TokSpan 609 609, unLabel = Ident {unIdent = "QueuesCtrl"}})})})},Labeled {label = TokSpan 611 622, unLabel = PatBind (Labeled {label = TokSpan 611 611, unLabel = VarPat (Labeled {label = TokSpan 611 611, unLabel = Ident {unIdent = "SPEC"}})}) (Labeled {label = TokSpan 613 622, unLabel = ProcRepInterleave [Labeled {label = TokSpan 614 620, unLabel = Generator (Labeled {label = TokSpan 614 614, unLabel = VarPat (Labeled {label = TokSpan 614 614, unLabel = Ident {unIdent = "i"}})}) (Labeled {label = TokSpan 616 620, unLabel = SetClose (Labeled {label = TokSpan 617 617, unLabel = IntExp 1},Labeled {label = TokSpan 619 619, unLabel = Var (Labeled {label = TokSpan 619 619, unLabel = Ident {unIdent = "maxLimit"}})})})}] (Labeled {label = TokSpan 622 622, unLabel = Var (Labeled {label = TokSpan 622 622, unLabel = Ident {unIdent = "CUST"}})})})},Labeled {label = TokSpan 623 645, unLabel = PatBind (Labeled {label = TokSpan 623 623, unLabel = VarPat (Labeled {label = TokSpan 623 623, unLabel = Ident {unIdent = "CUST"}})}) (Labeled {label = TokSpan 625 645, unLabel = PrefixExp (Labeled {label = TokSpan 625 625, unLabel = Var (Labeled {label = TokSpan 625 625, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 626 627, unLabel = InComm (Labeled {label = TokSpan 627 627, unLabel = VarPat (Labeled {label = TokSpan 627 627, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 629 645, unLabel = Parens (Labeled {label = TokPos 635, unLabel = Fun2 "[]" (Labeled {label = TokSpan 630 634, unLabel = PrefixExp (Labeled {label = TokSpan 630 630, unLabel = Var (Labeled {label = TokSpan 630 630, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 631 632, unLabel = OutComm (Labeled {label = TokSpan 632 632, unLabel = Var (Labeled {label = TokSpan 632 632, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 634 634, unLabel = Var (Labeled {label = TokSpan 634 634, unLabel = Ident {unIdent = "CUST"}})})}) (Labeled {label = TokSpan 636 644, unLabel = PrefixExp (Labeled {label = TokSpan 636 636, unLabel = Var (Labeled {label = TokSpan 636 636, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 637 638, unLabel = OutComm (Labeled {label = TokSpan 638 638, unLabel = Var (Labeled {label = TokSpan 638 638, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 640 644, unLabel = PrefixExp (Labeled {label = TokSpan 640 640, unLabel = Var (Labeled {label = TokSpan 640 640, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 641 642, unLabel = OutComm (Labeled {label = TokSpan 642 642, unLabel = Var (Labeled {label = TokSpan 642 642, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 644 644, unLabel = Var (Labeled {label = TokSpan 644 644, unLabel = Ident {unIdent = "CUST"}})})})})})})})},Labeled {label = TokSpan 648 653, unLabel = PatBind (Labeled {label = TokSpan 648 648, unLabel = VarPat (Labeled {label = TokSpan 648 648, unLabel = Ident {unIdent = "SPEC2"}})}) (Labeled {label = TokSpan 650 653, unLabel = CallFunction (Labeled {label = TokSpan 650 650, unLabel = Var (Labeled {label = TokSpan 650 650, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 652 652, unLabel = IntExp 0}]]})},Labeled {label = TokSpan 654 654, unLabel = FunBind (Labeled {label = TokSpan 654 654, unLabel = Ident {unIdent = "NEWSPEC"}}) [FunCase [[Labeled {label = TokSpan 656 656, unLabel = VarPat (Labeled {label = TokSpan 656 656, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 688, unLabel = Fun2 "[]" (Labeled {label = TokPos 662, unLabel = Fun2 "&" (Labeled {label = TokPos 660, unLabel = Fun2 "<" (Labeled {label = TokSpan 659 659, unLabel = Var (Labeled {label = TokSpan 659 659, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 661 661, unLabel = Var (Labeled {label = TokSpan 661 661, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 663 687, unLabel = PrefixExp (Labeled {label = TokSpan 663 663, unLabel = Var (Labeled {label = TokSpan 663 663, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 664 665, unLabel = InComm (Labeled {label = TokSpan 665 665, unLabel = VarPat (Labeled {label = TokSpan 665 665, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 667 687, unLabel = Parens (Labeled {label = TokPos 678, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 668 677, unLabel = PrefixExp (Labeled {label = TokSpan 668 668, unLabel = Var (Labeled {label = TokSpan 668 668, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 669 670, unLabel = OutComm (Labeled {label = TokSpan 670 670, unLabel = Var (Labeled {label = TokSpan 670 670, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 672 677, unLabel = CallFunction (Labeled {label = TokSpan 672 672, unLabel = Var (Labeled {label = TokSpan 672 672, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 675, unLabel = Fun2 "+" (Labeled {label = TokSpan 674 674, unLabel = Var (Labeled {label = TokSpan 674 674, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 676 676, unLabel = IntExp 1})}]]})}) (Labeled {label = TokSpan 679 686, unLabel = PrefixExp (Labeled {label = TokSpan 679 679, unLabel = Var (Labeled {label = TokSpan 679 679, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 680 681, unLabel = OutComm (Labeled {label = TokSpan 681 681, unLabel = Var (Labeled {label = TokSpan 681 681, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 683 686, unLabel = CallFunction (Labeled {label = TokSpan 683 683, unLabel = Var (Labeled {label = TokSpan 683 683, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 685 685, unLabel = Var (Labeled {label = TokSpan 685 685, unLabel = Ident {unIdent = "num"}})}]]})})})})})}) (Labeled {label = TokPos 692, unLabel = Fun2 "&" (Labeled {label = TokPos 691, unLabel = Fun2 ">" (Labeled {label = TokSpan 689 689, unLabel = Var (Labeled {label = TokSpan 689 689, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 691 691, unLabel = IntExp 0})}) (Labeled {label = TokSpan 693 707, unLabel = ProcRepInternalChoice [Labeled {label = TokSpan 694 696, unLabel = Generator (Labeled {label = TokSpan 694 694, unLabel = VarPat (Labeled {label = TokSpan 694 694, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 696 696, unLabel = Var (Labeled {label = TokSpan 696 696, unLabel = Ident {unIdent = "CUSTOMER"}})})}] (Labeled {label = TokSpan 698 707, unLabel = PrefixExp (Labeled {label = TokSpan 698 698, unLabel = Var (Labeled {label = TokSpan 698 698, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 699 700, unLabel = OutComm (Labeled {label = TokSpan 700 700, unLabel = Var (Labeled {label = TokSpan 700 700, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 702 707, unLabel = CallFunction (Labeled {label = TokSpan 702 702, unLabel = Var (Labeled {label = TokSpan 702 702, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 705, unLabel = Fun2 "-" (Labeled {label = TokSpan 704 704, unLabel = Var (Labeled {label = TokSpan 704 704, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 706 706, unLabel = IntExp 1})}]]})})})})})]},Labeled {label = TokSpan 708 711, unLabel = AssertRef (Labeled {label = TokSpan 709 709, unLabel = Var (Labeled {label = TokSpan 709 709, unLabel = Ident {unIdent = "SPEC2"}})}) "[T=" (Labeled {label = TokSpan 711 711, unLabel = Var (Labeled {label = TokSpan 711 711, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 712 715, unLabel = AssertRef (Labeled {label = TokSpan 713 713, unLabel = Var (Labeled {label = TokSpan 713 713, unLabel = Ident {unIdent = "SPEC2"}})}) "[F=" (Labeled {label = TokSpan 715 715, unLabel = Var (Labeled {label = TokSpan 715 715, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 716 719, unLabel = AssertRef (Labeled {label = TokSpan 717 717, unLabel = Var (Labeled {label = TokSpan 717 717, unLabel = Ident {unIdent = "SPEC"}})}) "[T=" (Labeled {label = TokSpan 719 719, unLabel = Var (Labeled {label = TokSpan 719 719, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 720 723, unLabel = AssertRef (Labeled {label = TokSpan 721 721, unLabel = Var (Labeled {label = TokSpan 721 721, unLabel = Ident {unIdent = "SPEC"}})}) "[F=" (Labeled {label = TokSpan 723 723, unLabel = Var (Labeled {label = TokSpan 723 723, unLabel = Ident {unIdent = "BankSystem"}})})}]}
