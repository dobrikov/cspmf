Labeled {label = TokSpan 2 1649, unLabel = Module [Labeled {label = TokSpan 2 3, unLabel = Transparent [Labeled {label = TokSpan 3 3, unLabel = Ident {unIdent = "normal"}}]},Labeled {label = TokSpan 5 5, unLabel = FunBind (Labeled {label = TokSpan 5 5, unLabel = Ident {unIdent = "wire"}}) [FunCase [[Labeled {label = TokSpan 7 7, unLabel = VarPat (Labeled {label = TokSpan 7 7, unLabel = Ident {unIdent = "P"}})},Labeled {label = TokSpan 9 9, unLabel = VarPat (Labeled {label = TokSpan 9 9, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 11 11, unLabel = VarPat (Labeled {label = TokSpan 11 11, unLabel = Ident {unIdent = "Q"}})}]] (Labeled {label = TokPos 21, unLabel = Fun2 "\\" (Labeled {label = TokSpan 14 20, unLabel = Parens (Labeled {label = TokSpan 16 18, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 17 17, unLabel = Var (Labeled {label = TokSpan 17 17, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 15 15, unLabel = Var (Labeled {label = TokSpan 15 15, unLabel = Ident {unIdent = "P"}})}) (Labeled {label = TokSpan 19 19, unLabel = Var (Labeled {label = TokSpan 19 19, unLabel = Ident {unIdent = "Q"}})})})}) (Labeled {label = TokSpan 22 22, unLabel = Var (Labeled {label = TokSpan 22 22, unLabel = Ident {unIdent = "A"}})})})]},Labeled {label = TokSpan 25 25, unLabel = FunBind (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "BUFFER"}}) [FunCase [[Labeled {label = TokSpan 27 27, unLabel = VarPat (Labeled {label = TokSpan 27 27, unLabel = Ident {unIdent = "n"}})},Labeled {label = TokSpan 29 29, unLabel = VarPat (Labeled {label = TokSpan 29 29, unLabel = Ident {unIdent = "in"}})},Labeled {label = TokSpan 31 31, unLabel = VarPat (Labeled {label = TokSpan 31 31, unLabel = Ident {unIdent = "out"}})},Labeled {label = TokSpan 33 33, unLabel = VarPat (Labeled {label = TokSpan 33 33, unLabel = Ident {unIdent = "type"}})}]] (Labeled {label = TokSpan 36 103, unLabel = Let [Labeled {label = TokSpan 37 37, unLabel = FunBind (Labeled {label = TokSpan 37 37, unLabel = Ident {unIdent = "B"}}) [FunCase [[Labeled {label = TokSpan 39 40, unLabel = ListEnumPat []}]] (Labeled {label = TokSpan 43 54, unLabel = PrefixExp (Labeled {label = TokSpan 43 43, unLabel = Var (Labeled {label = TokSpan 43 43, unLabel = Ident {unIdent = "in"}})}) [Labeled {label = TokSpan 44 47, unLabel = InCommGuarded (Labeled {label = TokSpan 45 45, unLabel = VarPat (Labeled {label = TokSpan 45 45, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 47 47, unLabel = Var (Labeled {label = TokSpan 47 47, unLabel = Ident {unIdent = "type"}})})}] (Labeled {label = TokSpan 49 54, unLabel = CallFunction (Labeled {label = TokSpan 49 49, unLabel = Var (Labeled {label = TokSpan 49 49, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 51 53, unLabel = ListEnum [Labeled {label = TokSpan 52 52, unLabel = Var (Labeled {label = TokSpan 52 52, unLabel = Ident {unIdent = "x"}})}]}]]})}),FunCase [[Labeled {label = TokSpan 57 57, unLabel = VarPat (Labeled {label = TokSpan 57 57, unLabel = Ident {unIdent = "s"}})}]] (Labeled {label = TokPos 74, unLabel = Fun2 "[]" (Labeled {label = TokSpan 60 73, unLabel = PrefixExp (Labeled {label = TokSpan 60 60, unLabel = Var (Labeled {label = TokSpan 60 60, unLabel = Ident {unIdent = "out"}})}) [Labeled {label = TokSpan 61 65, unLabel = OutComm (Labeled {label = TokSpan 62 65, unLabel = CallBuiltIn (Labeled {label = TokSpan 62 62, unLabel = BuiltIn "head"}) [[Labeled {label = TokSpan 64 64, unLabel = Var (Labeled {label = TokSpan 64 64, unLabel = Ident {unIdent = "s"}})}]]})}] (Labeled {label = TokSpan 67 73, unLabel = CallFunction (Labeled {label = TokSpan 67 67, unLabel = Var (Labeled {label = TokSpan 67 67, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 69 72, unLabel = CallBuiltIn (Labeled {label = TokSpan 69 69, unLabel = BuiltIn "tail"}) [[Labeled {label = TokSpan 71 71, unLabel = Var (Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "s"}})}]]}]]})}) (Labeled {label = TokSpan 75 97, unLabel = Parens (Labeled {label = TokPos 77, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 76 76, unLabel = Stop}) (Labeled {label = TokPos 82, unLabel = Fun2 "&" (Labeled {label = TokPos 80, unLabel = Fun2 "<" (Labeled {label = TokPos 78, unLabel = Fun1 "#" (Labeled {label = TokSpan 79 79, unLabel = Var (Labeled {label = TokSpan 79 79, unLabel = Ident {unIdent = "s"}})})}) (Labeled {label = TokSpan 81 81, unLabel = Var (Labeled {label = TokSpan 81 81, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 83 96, unLabel = PrefixExp (Labeled {label = TokSpan 83 83, unLabel = Var (Labeled {label = TokSpan 83 83, unLabel = Ident {unIdent = "in"}})}) [Labeled {label = TokSpan 84 87, unLabel = InCommGuarded (Labeled {label = TokSpan 85 85, unLabel = VarPat (Labeled {label = TokSpan 85 85, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 87 87, unLabel = Var (Labeled {label = TokSpan 87 87, unLabel = Ident {unIdent = "type"}})})}] (Labeled {label = TokSpan 89 96, unLabel = CallFunction (Labeled {label = TokSpan 89 89, unLabel = Var (Labeled {label = TokSpan 89 89, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokPos 92, unLabel = Fun2 "^" (Labeled {label = TokSpan 91 91, unLabel = Var (Labeled {label = TokSpan 91 91, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 93 95, unLabel = ListEnum [Labeled {label = TokSpan 94 94, unLabel = Var (Labeled {label = TokSpan 94 94, unLabel = Ident {unIdent = "x"}})}]})}]]})})})})})})]}] (Labeled {label = TokSpan 99 103, unLabel = CallFunction (Labeled {label = TokSpan 99 99, unLabel = Var (Labeled {label = TokSpan 99 99, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 101 102, unLabel = ListEnum []}]]})})]},Labeled {label = TokSpan 106 106, unLabel = FunBind (Labeled {label = TokSpan 106 106, unLabel = Ident {unIdent = "FAULTY"}}) [FunCase [[Labeled {label = TokSpan 108 108, unLabel = VarPat (Labeled {label = TokSpan 108 108, unLabel = Ident {unIdent = "n"}})},Labeled {label = TokSpan 110 110, unLabel = VarPat (Labeled {label = TokSpan 110 110, unLabel = Ident {unIdent = "in"}})},Labeled {label = TokSpan 112 112, unLabel = VarPat (Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "out"}})},Labeled {label = TokSpan 114 114, unLabel = VarPat (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "type"}})}]] (Labeled {label = TokSpan 117 242, unLabel = Let [Labeled {label = TokSpan 118 120, unLabel = PatBind (Labeled {label = TokSpan 118 118, unLabel = VarPat (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "PassRate"}})}) (Labeled {label = TokSpan 120 120, unLabel = IntExp 3})},Labeled {label = TokSpan 121 121, unLabel = FunBind (Labeled {label = TokSpan 121 121, unLabel = Ident {unIdent = "B"}}) [FunCase [[Labeled {label = TokSpan 123 124, unLabel = ListEnumPat []},Labeled {label = TokSpan 126 126, unLabel = VarPat (Labeled {label = TokSpan 126 126, unLabel = Ident {unIdent = "since_last"}})}]] (Labeled {label = TokSpan 129 143, unLabel = PrefixExp (Labeled {label = TokSpan 129 129, unLabel = Var (Labeled {label = TokSpan 129 129, unLabel = Ident {unIdent = "in"}})}) [Labeled {label = TokSpan 130 133, unLabel = InCommGuarded (Labeled {label = TokSpan 131 131, unLabel = VarPat (Labeled {label = TokSpan 131 131, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 133 133, unLabel = Var (Labeled {label = TokSpan 133 133, unLabel = Ident {unIdent = "type"}})})}] (Labeled {label = TokSpan 135 143, unLabel = CallFunction (Labeled {label = TokSpan 135 135, unLabel = Var (Labeled {label = TokSpan 135 135, unLabel = Ident {unIdent = "A"}})}) [[Labeled {label = TokSpan 137 138, unLabel = ListEnum []},Labeled {label = TokSpan 140 140, unLabel = Var (Labeled {label = TokSpan 140 140, unLabel = Ident {unIdent = "since_last"}})},Labeled {label = TokSpan 142 142, unLabel = Var (Labeled {label = TokSpan 142 142, unLabel = Ident {unIdent = "x"}})}]]})}),FunCase [[Labeled {label = TokSpan 146 146, unLabel = VarPat (Labeled {label = TokSpan 146 146, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 148 148, unLabel = VarPat (Labeled {label = TokSpan 148 148, unLabel = Ident {unIdent = "since_last"}})}]] (Labeled {label = TokPos 167, unLabel = Fun2 "[]" (Labeled {label = TokSpan 151 166, unLabel = PrefixExp (Labeled {label = TokSpan 151 151, unLabel = Var (Labeled {label = TokSpan 151 151, unLabel = Ident {unIdent = "out"}})}) [Labeled {label = TokSpan 152 156, unLabel = OutComm (Labeled {label = TokSpan 153 156, unLabel = CallBuiltIn (Labeled {label = TokSpan 153 153, unLabel = BuiltIn "head"}) [[Labeled {label = TokSpan 155 155, unLabel = Var (Labeled {label = TokSpan 155 155, unLabel = Ident {unIdent = "s"}})}]]})}] (Labeled {label = TokSpan 158 166, unLabel = CallFunction (Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 160 163, unLabel = CallBuiltIn (Labeled {label = TokSpan 160 160, unLabel = BuiltIn "tail"}) [[Labeled {label = TokSpan 162 162, unLabel = Var (Labeled {label = TokSpan 162 162, unLabel = Ident {unIdent = "s"}})}]]},Labeled {label = TokSpan 165 165, unLabel = Var (Labeled {label = TokSpan 165 165, unLabel = Ident {unIdent = "since_last"}})}]]})}) (Labeled {label = TokSpan 168 190, unLabel = Parens (Labeled {label = TokPos 170, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 169 169, unLabel = Stop}) (Labeled {label = TokPos 175, unLabel = Fun2 "&" (Labeled {label = TokPos 173, unLabel = Fun2 "<" (Labeled {label = TokPos 171, unLabel = Fun1 "#" (Labeled {label = TokSpan 172 172, unLabel = Var (Labeled {label = TokSpan 172 172, unLabel = Ident {unIdent = "s"}})})}) (Labeled {label = TokSpan 174 174, unLabel = Var (Labeled {label = TokSpan 174 174, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 176 189, unLabel = PrefixExp (Labeled {label = TokSpan 176 176, unLabel = Var (Labeled {label = TokSpan 176 176, unLabel = Ident {unIdent = "in"}})}) [Labeled {label = TokSpan 177 180, unLabel = InCommGuarded (Labeled {label = TokSpan 178 178, unLabel = VarPat (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 180 180, unLabel = Var (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "type"}})})}] (Labeled {label = TokSpan 182 189, unLabel = CallFunction (Labeled {label = TokSpan 182 182, unLabel = Var (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "A"}})}) [[Labeled {label = TokSpan 184 184, unLabel = Var (Labeled {label = TokSpan 184 184, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 186 186, unLabel = Var (Labeled {label = TokSpan 186 186, unLabel = Ident {unIdent = "since_last"}})},Labeled {label = TokSpan 188 188, unLabel = Var (Labeled {label = TokSpan 188 188, unLabel = Ident {unIdent = "x"}})}]]})})})})})})]},Labeled {label = TokSpan 191 191, unLabel = FunBind (Labeled {label = TokSpan 191 191, unLabel = Ident {unIdent = "A"}}) [FunCase [[Labeled {label = TokSpan 193 193, unLabel = VarPat (Labeled {label = TokSpan 193 193, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 195 195, unLabel = VarPat (Labeled {label = TokSpan 195 195, unLabel = Ident {unIdent = "since_last"}})},Labeled {label = TokSpan 197 197, unLabel = VarPat (Labeled {label = TokSpan 197 197, unLabel = Ident {unIdent = "x"}})}]] (Labeled {label = TokSpan 200 234, unLabel = Ifte (Labeled {label = TokPos 202, unLabel = Fun2 "<" (Labeled {label = TokSpan 201 201, unLabel = Var (Labeled {label = TokSpan 201 201, unLabel = Ident {unIdent = "since_last"}})}) (Labeled {label = TokSpan 203 203, unLabel = Var (Labeled {label = TokSpan 203 203, unLabel = Ident {unIdent = "PassRate"}})})}) (Labeled {label = TokPos 215, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 205 214, unLabel = CallFunction (Labeled {label = TokSpan 205 205, unLabel = Var (Labeled {label = TokSpan 205 205, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokPos 208, unLabel = Fun2 "^" (Labeled {label = TokSpan 207 207, unLabel = Var (Labeled {label = TokSpan 207 207, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 209 211, unLabel = ListEnum [Labeled {label = TokSpan 210 210, unLabel = Var (Labeled {label = TokSpan 210 210, unLabel = Ident {unIdent = "x"}})}]})},Labeled {label = TokSpan 213 213, unLabel = IntExp 0}]]}) (Labeled {label = TokSpan 216 223, unLabel = CallFunction (Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 218 218, unLabel = Var (Labeled {label = TokSpan 218 218, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokPos 221, unLabel = Fun2 "+" (Labeled {label = TokSpan 220 220, unLabel = Var (Labeled {label = TokSpan 220 220, unLabel = Ident {unIdent = "since_last"}})}) (Labeled {label = TokSpan 222 222, unLabel = IntExp 1})}]]})}) (Labeled {label = TokSpan 225 234, unLabel = CallFunction (Labeled {label = TokSpan 225 225, unLabel = Var (Labeled {label = TokSpan 225 225, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokPos 228, unLabel = Fun2 "^" (Labeled {label = TokSpan 227 227, unLabel = Var (Labeled {label = TokSpan 227 227, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 229 231, unLabel = ListEnum [Labeled {label = TokSpan 230 230, unLabel = Var (Labeled {label = TokSpan 230 230, unLabel = Ident {unIdent = "x"}})}]})},Labeled {label = TokSpan 233 233, unLabel = IntExp 0}]]})})]}] (Labeled {label = TokSpan 236 242, unLabel = CallFunction (Labeled {label = TokSpan 236 236, unLabel = Var (Labeled {label = TokSpan 236 236, unLabel = Ident {unIdent = "B"}})}) [[Labeled {label = TokSpan 238 239, unLabel = ListEnum []},Labeled {label = TokSpan 241 241, unLabel = IntExp 0}]]})})]},Labeled {label = TokSpan 244 253, unLabel = DataType (Labeled {label = TokSpan 245 245, unLabel = Ident {unIdent = "Connection_Data"}}) [Labeled {label = TokSpan 247 253, unLabel = Constructor (Labeled {label = TokSpan 247 247, unLabel = Ident {unIdent = "bit"}}) (Just (Labeled {label = TokSpan 249 253, unLabel = TypeDot [Labeled {label = TokSpan 249 253, unLabel = SetEnum [Labeled {label = TokSpan 250 250, unLabel = IntExp 0},Labeled {label = TokSpan 252 252, unLabel = IntExp 1}]}]}))}]},Labeled {label = TokSpan 254 259, unLabel = DataType (Labeled {label = TokSpan 255 255, unLabel = Ident {unIdent = "Host"}}) [Labeled {label = TokSpan 257 257, unLabel = Constructor (Labeled {label = TokSpan 257 257, unLabel = Ident {unIdent = "newton"}}) Nothing},Labeled {label = TokSpan 259 259, unLabel = Constructor (Labeled {label = TokSpan 259 259, unLabel = Ident {unIdent = "goedel"}}) Nothing}]},Labeled {label = TokSpan 260 267, unLabel = NameType (Labeled {label = TokSpan 261 261, unLabel = Ident {unIdent = "Port"}}) (Labeled {label = TokSpan 263 267, unLabel = TypeDot [Labeled {label = TokSpan 263 267, unLabel = SetClose (Labeled {label = TokSpan 264 264, unLabel = IntExp 0},Labeled {label = TokSpan 266 266, unLabel = IntExp 2})}]})},Labeled {label = TokSpan 268 273, unLabel = NameType (Labeled {label = TokSpan 269 269, unLabel = Ident {unIdent = "Connection_Addr"}}) (Labeled {label = TokSpan 271 273, unLabel = TypeDot [Labeled {label = TokSpan 271 271, unLabel = Var (Labeled {label = TokSpan 271 271, unLabel = Ident {unIdent = "Host"}})},Labeled {label = TokSpan 273 273, unLabel = Var (Labeled {label = TokSpan 273 273, unLabel = Ident {unIdent = "Port"}})}]})},Labeled {label = TokSpan 274 279, unLabel = Channel [Labeled {label = TokSpan 275 275, unLabel = Ident {unIdent = "connection"}}] (Just (Labeled {label = TokSpan 277 279, unLabel = TypeDot [Labeled {label = TokSpan 277 277, unLabel = Var (Labeled {label = TokSpan 277 277, unLabel = Ident {unIdent = "Connection_Addr"}})},Labeled {label = TokSpan 279 279, unLabel = Var (Labeled {label = TokSpan 279 279, unLabel = Ident {unIdent = "Connection_Data"}})}]}))},Labeled {label = TokSpan 281 313, unLabel = PatBind (Labeled {label = TokSpan 281 281, unLabel = VarPat (Labeled {label = TokSpan 281 281, unLabel = Ident {unIdent = "Connections"}})}) (Labeled {label = TokSpan 283 313, unLabel = SetEnum [Labeled {label = TokSpan 284 292, unLabel = TupleExp [Labeled {label = TokSpan 285 287, unLabel = DotTuple [Labeled {label = TokSpan 285 285, unLabel = Var (Labeled {label = TokSpan 285 285, unLabel = Ident {unIdent = "newton"}})},Labeled {label = TokSpan 287 287, unLabel = IntExp 0}]},Labeled {label = TokSpan 289 291, unLabel = DotTuple [Labeled {label = TokSpan 289 289, unLabel = Var (Labeled {label = TokSpan 289 289, unLabel = Ident {unIdent = "goedel"}})},Labeled {label = TokSpan 291 291, unLabel = IntExp 1}]}]},Labeled {label = TokSpan 294 302, unLabel = TupleExp [Labeled {label = TokSpan 295 297, unLabel = DotTuple [Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "goedel"}})},Labeled {label = TokSpan 297 297, unLabel = IntExp 0}]},Labeled {label = TokSpan 299 301, unLabel = DotTuple [Labeled {label = TokSpan 299 299, unLabel = Var (Labeled {label = TokSpan 299 299, unLabel = Ident {unIdent = "newton"}})},Labeled {label = TokSpan 301 301, unLabel = IntExp 1}]}]},Labeled {label = TokSpan 304 312, unLabel = TupleExp [Labeled {label = TokSpan 305 307, unLabel = DotTuple [Labeled {label = TokSpan 305 305, unLabel = Var (Labeled {label = TokSpan 305 305, unLabel = Ident {unIdent = "newton"}})},Labeled {label = TokSpan 307 307, unLabel = IntExp 2}]},Labeled {label = TokSpan 309 311, unLabel = DotTuple [Labeled {label = TokSpan 309 309, unLabel = Var (Labeled {label = TokSpan 309 309, unLabel = Ident {unIdent = "goedel"}})},Labeled {label = TokSpan 311 311, unLabel = IntExp 2}]}]}]})},Labeled {label = TokSpan 315 358, unLabel = PatBind (Labeled {label = TokSpan 315 315, unLabel = VarPat (Labeled {label = TokSpan 315 315, unLabel = Ident {unIdent = "ConnectionService"}})}) (Labeled {label = TokSpan 317 358, unLabel = Let [Labeled {label = TokSpan 318 318, unLabel = FunBind (Labeled {label = TokSpan 318 318, unLabel = Ident {unIdent = "Buff"}}) [FunCase [[Labeled {label = TokSpan 320 320, unLabel = VarPat (Labeled {label = TokSpan 320 320, unLabel = Ident {unIdent = "read"}})},Labeled {label = TokSpan 322 322, unLabel = VarPat (Labeled {label = TokSpan 322 322, unLabel = Ident {unIdent = "write"}})}]] (Labeled {label = TokSpan 325 338, unLabel = PrefixExp (Labeled {label = TokSpan 325 325, unLabel = Var (Labeled {label = TokSpan 325 325, unLabel = Ident {unIdent = "read"}})}) [Labeled {label = TokSpan 326 327, unLabel = InComm (Labeled {label = TokSpan 327 327, unLabel = VarPat (Labeled {label = TokSpan 327 327, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 329 338, unLabel = PrefixExp (Labeled {label = TokSpan 329 329, unLabel = Var (Labeled {label = TokSpan 329 329, unLabel = Ident {unIdent = "write"}})}) [Labeled {label = TokSpan 330 331, unLabel = OutComm (Labeled {label = TokSpan 331 331, unLabel = Var (Labeled {label = TokSpan 331 331, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 333 338, unLabel = CallFunction (Labeled {label = TokSpan 333 333, unLabel = Var (Labeled {label = TokSpan 333 333, unLabel = Ident {unIdent = "Buff"}})}) [[Labeled {label = TokSpan 335 335, unLabel = Var (Labeled {label = TokSpan 335 335, unLabel = Ident {unIdent = "read"}})},Labeled {label = TokSpan 337 337, unLabel = Var (Labeled {label = TokSpan 337 337, unLabel = Ident {unIdent = "write"}})}]]})})})]}] (Labeled {label = TokSpan 340 358, unLabel = ProcRepInterleave [Labeled {label = TokSpan 341 347, unLabel = Generator (Labeled {label = TokSpan 341 345, unLabel = TuplePat [Labeled {label = TokSpan 342 342, unLabel = VarPat (Labeled {label = TokSpan 342 342, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 344 344, unLabel = VarPat (Labeled {label = TokSpan 344 344, unLabel = Ident {unIdent = "d"}})}]}) (Labeled {label = TokSpan 347 347, unLabel = Var (Labeled {label = TokSpan 347 347, unLabel = Ident {unIdent = "Connections"}})})}] (Labeled {label = TokSpan 349 358, unLabel = CallFunction (Labeled {label = TokSpan 349 349, unLabel = Var (Labeled {label = TokSpan 349 349, unLabel = Ident {unIdent = "Buff"}})}) [[Labeled {label = TokSpan 351 353, unLabel = DotTuple [Labeled {label = TokSpan 351 351, unLabel = Var (Labeled {label = TokSpan 351 351, unLabel = Ident {unIdent = "connection"}})},Labeled {label = TokSpan 353 353, unLabel = Var (Labeled {label = TokSpan 353 353, unLabel = Ident {unIdent = "s"}})}]},Labeled {label = TokSpan 355 357, unLabel = DotTuple [Labeled {label = TokSpan 355 355, unLabel = Var (Labeled {label = TokSpan 355 355, unLabel = Ident {unIdent = "connection"}})},Labeled {label = TokSpan 357 357, unLabel = Var (Labeled {label = TokSpan 357 357, unLabel = Ident {unIdent = "d"}})}]}]]})})})},Labeled {label = TokSpan 360 367, unLabel = DataType (Labeled {label = TokSpan 361 361, unLabel = Ident {unIdent = "Network_Data"}}) [Labeled {label = TokSpan 363 363, unLabel = Constructor (Labeled {label = TokSpan 363 363, unLabel = Ident {unIdent = "CAck"}}) Nothing},Labeled {label = TokSpan 365 367, unLabel = Constructor (Labeled {label = TokSpan 365 365, unLabel = Ident {unIdent = "CData"}}) (Just (Labeled {label = TokSpan 367 367, unLabel = TypeDot [Labeled {label = TokSpan 367 367, unLabel = Var (Labeled {label = TokSpan 367 367, unLabel = Ident {unIdent = "Connection_Data"}})}]}))}]},Labeled {label = TokSpan 368 372, unLabel = PatBind (Labeled {label = TokSpan 368 368, unLabel = VarPat (Labeled {label = TokSpan 368 368, unLabel = Ident {unIdent = "Network_Data_Fwd"}})}) (Labeled {label = TokSpan 370 372, unLabel = Closure [Labeled {label = TokSpan 371 371, unLabel = Var (Labeled {label = TokSpan 371 371, unLabel = Ident {unIdent = "CData"}})}]})},Labeled {label = TokSpan 373 380, unLabel = PatBind (Labeled {label = TokSpan 373 373, unLabel = VarPat (Labeled {label = TokSpan 373 373, unLabel = Ident {unIdent = "Network_Data_Rev"}})}) (Labeled {label = TokSpan 375 380, unLabel = CallBuiltIn (Labeled {label = TokSpan 375 375, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 377 377, unLabel = Var (Labeled {label = TokSpan 377 377, unLabel = Ident {unIdent = "Network_Data"}})},Labeled {label = TokSpan 379 379, unLabel = Var (Labeled {label = TokSpan 379 379, unLabel = Ident {unIdent = "Network_Data_Fwd"}})}]]})},Labeled {label = TokSpan 381 383, unLabel = PatBind (Labeled {label = TokSpan 381 381, unLabel = VarPat (Labeled {label = TokSpan 381 381, unLabel = Ident {unIdent = "Network_Addr"}})}) (Labeled {label = TokSpan 383 383, unLabel = Var (Labeled {label = TokSpan 383 383, unLabel = Ident {unIdent = "Connection_Addr"}})})},Labeled {label = TokSpan 385 385, unLabel = FunBind (Labeled {label = TokSpan 385 385, unLabel = Ident {unIdent = "hostof"}}) [FunCase [[Labeled {label = TokSpan 387 387, unLabel = VarPat (Labeled {label = TokSpan 387 387, unLabel = Ident {unIdent = "h"}})},Labeled {label = TokSpan 389 389, unLabel = VarPat (Labeled {label = TokSpan 389 389, unLabel = Ident {unIdent = "p"}})}]] (Labeled {label = TokSpan 392 392, unLabel = Var (Labeled {label = TokSpan 392 392, unLabel = Ident {unIdent = "h"}})})]},Labeled {label = TokSpan 393 398, unLabel = Channel [Labeled {label = TokSpan 394 394, unLabel = Ident {unIdent = "network"}}] (Just (Labeled {label = TokSpan 396 398, unLabel = TypeDot [Labeled {label = TokSpan 396 396, unLabel = Var (Labeled {label = TokSpan 396 396, unLabel = Ident {unIdent = "Network_Addr"}})},Labeled {label = TokSpan 398 398, unLabel = Var (Labeled {label = TokSpan 398 398, unLabel = Ident {unIdent = "Network_Data"}})}]}))},Labeled {label = TokSpan 400 441, unLabel = PatBind (Labeled {label = TokSpan 400 400, unLabel = VarPat (Labeled {label = TokSpan 400 400, unLabel = Ident {unIdent = "NetworkService"}})}) (Labeled {label = TokSpan 402 441, unLabel = ProcRepInterleave [Labeled {label = TokSpan 403 409, unLabel = Generator (Labeled {label = TokSpan 403 407, unLabel = TuplePat [Labeled {label = TokSpan 404 404, unLabel = VarPat (Labeled {label = TokSpan 404 404, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 406 406, unLabel = VarPat (Labeled {label = TokSpan 406 406, unLabel = Ident {unIdent = "d"}})}]}) (Labeled {label = TokSpan 409 409, unLabel = Var (Labeled {label = TokSpan 409 409, unLabel = Ident {unIdent = "Connections"}})})}] (Labeled {label = TokSpan 411 441, unLabel = Parens (Labeled {label = TokPos 426, unLabel = Fun2 "|||" (Labeled {label = TokSpan 412 425, unLabel = CallFunction (Labeled {label = TokSpan 412 412, unLabel = Var (Labeled {label = TokSpan 412 412, unLabel = Ident {unIdent = "BUFFER"}})}) [[Labeled {label = TokSpan 414 414, unLabel = IntExp 3},Labeled {label = TokSpan 416 418, unLabel = DotTuple [Labeled {label = TokSpan 416 416, unLabel = Var (Labeled {label = TokSpan 416 416, unLabel = Ident {unIdent = "network"}})},Labeled {label = TokSpan 418 418, unLabel = Var (Labeled {label = TokSpan 418 418, unLabel = Ident {unIdent = "s"}})}]},Labeled {label = TokSpan 420 422, unLabel = DotTuple [Labeled {label = TokSpan 420 420, unLabel = Var (Labeled {label = TokSpan 420 420, unLabel = Ident {unIdent = "network"}})},Labeled {label = TokSpan 422 422, unLabel = Var (Labeled {label = TokSpan 422 422, unLabel = Ident {unIdent = "d"}})}]},Labeled {label = TokSpan 424 424, unLabel = Var (Labeled {label = TokSpan 424 424, unLabel = Ident {unIdent = "Network_Data_Fwd"}})}]]}) (Labeled {label = TokSpan 427 440, unLabel = CallFunction (Labeled {label = TokSpan 427 427, unLabel = Var (Labeled {label = TokSpan 427 427, unLabel = Ident {unIdent = "BUFFER"}})}) [[Labeled {label = TokSpan 429 429, unLabel = IntExp 3},Labeled {label = TokSpan 431 433, unLabel = DotTuple [Labeled {label = TokSpan 431 431, unLabel = Var (Labeled {label = TokSpan 431 431, unLabel = Ident {unIdent = "network"}})},Labeled {label = TokSpan 433 433, unLabel = Var (Labeled {label = TokSpan 433 433, unLabel = Ident {unIdent = "d"}})}]},Labeled {label = TokSpan 435 437, unLabel = DotTuple [Labeled {label = TokSpan 435 435, unLabel = Var (Labeled {label = TokSpan 435 435, unLabel = Ident {unIdent = "network"}})},Labeled {label = TokSpan 437 437, unLabel = Var (Labeled {label = TokSpan 437 437, unLabel = Ident {unIdent = "s"}})}]},Labeled {label = TokSpan 439 439, unLabel = Var (Labeled {label = TokSpan 439 439, unLabel = Ident {unIdent = "Network_Data_Rev"}})}]]})})})})},Labeled {label = TokSpan 443 443, unLabel = FunBind (Labeled {label = TokSpan 443 443, unLabel = Ident {unIdent = "inports"}}) [FunCase [[Labeled {label = TokSpan 445 445, unLabel = VarPat (Labeled {label = TokSpan 445 445, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 448 465, unLabel = SetComprehension ([Labeled {label = TokSpan 449 449, unLabel = Var (Labeled {label = TokSpan 449 449, unLabel = Ident {unIdent = "s"}})}],[Labeled {label = TokSpan 451 457, unLabel = Generator (Labeled {label = TokSpan 451 455, unLabel = TuplePat [Labeled {label = TokSpan 452 452, unLabel = VarPat (Labeled {label = TokSpan 452 452, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 454 454, unLabel = WildCard}]}) (Labeled {label = TokSpan 457 457, unLabel = Var (Labeled {label = TokSpan 457 457, unLabel = Ident {unIdent = "Connections"}})})},Labeled {label = TokSpan 459 464, unLabel = Guard (Labeled {label = TokPos 463, unLabel = Fun2 "==" (Labeled {label = TokSpan 459 462, unLabel = CallFunction (Labeled {label = TokSpan 459 459, unLabel = Var (Labeled {label = TokSpan 459 459, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 461 461, unLabel = Var (Labeled {label = TokSpan 461 461, unLabel = Ident {unIdent = "s"}})}]]}) (Labeled {label = TokSpan 464 464, unLabel = Var (Labeled {label = TokSpan 464 464, unLabel = Ident {unIdent = "host"}})})})}])})]},Labeled {label = TokSpan 466 466, unLabel = FunBind (Labeled {label = TokSpan 466 466, unLabel = Ident {unIdent = "outports"}}) [FunCase [[Labeled {label = TokSpan 468 468, unLabel = VarPat (Labeled {label = TokSpan 468 468, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 471 488, unLabel = SetComprehension ([Labeled {label = TokSpan 472 472, unLabel = Var (Labeled {label = TokSpan 472 472, unLabel = Ident {unIdent = "d"}})}],[Labeled {label = TokSpan 474 480, unLabel = Generator (Labeled {label = TokSpan 474 478, unLabel = TuplePat [Labeled {label = TokSpan 475 475, unLabel = WildCard},Labeled {label = TokSpan 477 477, unLabel = VarPat (Labeled {label = TokSpan 477 477, unLabel = Ident {unIdent = "d"}})}]}) (Labeled {label = TokSpan 480 480, unLabel = Var (Labeled {label = TokSpan 480 480, unLabel = Ident {unIdent = "Connections"}})})},Labeled {label = TokSpan 482 487, unLabel = Guard (Labeled {label = TokPos 486, unLabel = Fun2 "==" (Labeled {label = TokSpan 482 485, unLabel = CallFunction (Labeled {label = TokSpan 482 482, unLabel = Var (Labeled {label = TokSpan 482 482, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "d"}})}]]}) (Labeled {label = TokSpan 487 487, unLabel = Var (Labeled {label = TokSpan 487 487, unLabel = Ident {unIdent = "host"}})})})}])})]},Labeled {label = TokSpan 489 593, unLabel = PatBind (Labeled {label = TokSpan 489 489, unLabel = VarPat (Labeled {label = TokSpan 489 489, unLabel = Ident {unIdent = "ConImp"}})}) (Labeled {label = TokSpan 491 593, unLabel = Let [Labeled {label = TokSpan 492 492, unLabel = FunBind (Labeled {label = TokSpan 492 492, unLabel = Ident {unIdent = "InPort"}}) [FunCase [[Labeled {label = TokSpan 494 494, unLabel = VarPat (Labeled {label = TokSpan 494 494, unLabel = Ident {unIdent = "addr"}})}]] (Labeled {label = TokSpan 497 520, unLabel = PrefixExp (Labeled {label = TokSpan 497 497, unLabel = Var (Labeled {label = TokSpan 497 497, unLabel = Ident {unIdent = "connection"}})}) [Labeled {label = TokSpan 498 499, unLabel = OutComm (Labeled {label = TokSpan 499 499, unLabel = Var (Labeled {label = TokSpan 499 499, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 500 501, unLabel = InComm (Labeled {label = TokSpan 501 501, unLabel = VarPat (Labeled {label = TokSpan 501 501, unLabel = Ident {unIdent = "v"}})})}] (Labeled {label = TokSpan 503 520, unLabel = PrefixExp (Labeled {label = TokSpan 503 503, unLabel = Var (Labeled {label = TokSpan 503 503, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 504 505, unLabel = OutComm (Labeled {label = TokSpan 505 505, unLabel = Var (Labeled {label = TokSpan 505 505, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 506 507, unLabel = OutComm (Labeled {label = TokSpan 507 507, unLabel = Var (Labeled {label = TokSpan 507 507, unLabel = Ident {unIdent = "CData"}})})},Labeled {label = TokSpan 508 509, unLabel = OutComm (Labeled {label = TokSpan 509 509, unLabel = Var (Labeled {label = TokSpan 509 509, unLabel = Ident {unIdent = "v"}})})}] (Labeled {label = TokSpan 511 520, unLabel = PrefixExp (Labeled {label = TokSpan 511 511, unLabel = Var (Labeled {label = TokSpan 511 511, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 512 513, unLabel = OutComm (Labeled {label = TokSpan 513 513, unLabel = Var (Labeled {label = TokSpan 513 513, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 514 515, unLabel = OutComm (Labeled {label = TokSpan 515 515, unLabel = Var (Labeled {label = TokSpan 515 515, unLabel = Ident {unIdent = "CAck"}})})}] (Labeled {label = TokSpan 517 520, unLabel = CallFunction (Labeled {label = TokSpan 517 517, unLabel = Var (Labeled {label = TokSpan 517 517, unLabel = Ident {unIdent = "InPort"}})}) [[Labeled {label = TokSpan 519 519, unLabel = Var (Labeled {label = TokSpan 519 519, unLabel = Ident {unIdent = "addr"}})}]]})})})})]},Labeled {label = TokSpan 521 521, unLabel = FunBind (Labeled {label = TokSpan 521 521, unLabel = Ident {unIdent = "OutPort"}}) [FunCase [[Labeled {label = TokSpan 523 523, unLabel = VarPat (Labeled {label = TokSpan 523 523, unLabel = Ident {unIdent = "addr"}})}]] (Labeled {label = TokSpan 526 549, unLabel = PrefixExp (Labeled {label = TokSpan 526 526, unLabel = Var (Labeled {label = TokSpan 526 526, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 527 528, unLabel = OutComm (Labeled {label = TokSpan 528 528, unLabel = Var (Labeled {label = TokSpan 528 528, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 529 530, unLabel = OutComm (Labeled {label = TokSpan 530 530, unLabel = Var (Labeled {label = TokSpan 530 530, unLabel = Ident {unIdent = "CData"}})})},Labeled {label = TokSpan 531 532, unLabel = InComm (Labeled {label = TokSpan 532 532, unLabel = VarPat (Labeled {label = TokSpan 532 532, unLabel = Ident {unIdent = "v"}})})}] (Labeled {label = TokSpan 534 549, unLabel = PrefixExp (Labeled {label = TokSpan 534 534, unLabel = Var (Labeled {label = TokSpan 534 534, unLabel = Ident {unIdent = "connection"}})}) [Labeled {label = TokSpan 535 536, unLabel = OutComm (Labeled {label = TokSpan 536 536, unLabel = Var (Labeled {label = TokSpan 536 536, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 537 538, unLabel = OutComm (Labeled {label = TokSpan 538 538, unLabel = Var (Labeled {label = TokSpan 538 538, unLabel = Ident {unIdent = "v"}})})}] (Labeled {label = TokSpan 540 549, unLabel = PrefixExp (Labeled {label = TokSpan 540 540, unLabel = Var (Labeled {label = TokSpan 540 540, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 541 542, unLabel = OutComm (Labeled {label = TokSpan 542 542, unLabel = Var (Labeled {label = TokSpan 542 542, unLabel = Ident {unIdent = "addr"}})})},Labeled {label = TokSpan 543 544, unLabel = OutComm (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "CAck"}})})}] (Labeled {label = TokSpan 546 549, unLabel = CallFunction (Labeled {label = TokSpan 546 546, unLabel = Var (Labeled {label = TokSpan 546 546, unLabel = Ident {unIdent = "OutPort"}})}) [[Labeled {label = TokSpan 548 548, unLabel = Var (Labeled {label = TokSpan 548 548, unLabel = Ident {unIdent = "addr"}})}]]})})})})]},Labeled {label = TokSpan 550 550, unLabel = FunBind (Labeled {label = TokSpan 550 550, unLabel = Ident {unIdent = "Ports"}}) [FunCase [[Labeled {label = TokSpan 552 552, unLabel = VarPat (Labeled {label = TokSpan 552 552, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokPos 569, unLabel = Fun2 "|||" (Labeled {label = TokSpan 555 568, unLabel = Parens (Labeled {label = TokSpan 556 567, unLabel = ProcRepInterleave [Labeled {label = TokSpan 557 562, unLabel = Generator (Labeled {label = TokSpan 557 557, unLabel = VarPat (Labeled {label = TokSpan 557 557, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 559 562, unLabel = CallFunction (Labeled {label = TokSpan 559 559, unLabel = Var (Labeled {label = TokSpan 559 559, unLabel = Ident {unIdent = "inports"}})}) [[Labeled {label = TokSpan 561 561, unLabel = Var (Labeled {label = TokSpan 561 561, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 564 567, unLabel = CallFunction (Labeled {label = TokSpan 564 564, unLabel = Var (Labeled {label = TokSpan 564 564, unLabel = Ident {unIdent = "InPort"}})}) [[Labeled {label = TokSpan 566 566, unLabel = Var (Labeled {label = TokSpan 566 566, unLabel = Ident {unIdent = "s"}})}]]})})}) (Labeled {label = TokSpan 570 583, unLabel = Parens (Labeled {label = TokSpan 571 582, unLabel = ProcRepInterleave [Labeled {label = TokSpan 572 577, unLabel = Generator (Labeled {label = TokSpan 572 572, unLabel = VarPat (Labeled {label = TokSpan 572 572, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 574 577, unLabel = CallFunction (Labeled {label = TokSpan 574 574, unLabel = Var (Labeled {label = TokSpan 574 574, unLabel = Ident {unIdent = "outports"}})}) [[Labeled {label = TokSpan 576 576, unLabel = Var (Labeled {label = TokSpan 576 576, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 579 582, unLabel = CallFunction (Labeled {label = TokSpan 579 579, unLabel = Var (Labeled {label = TokSpan 579 579, unLabel = Ident {unIdent = "OutPort"}})}) [[Labeled {label = TokSpan 581 581, unLabel = Var (Labeled {label = TokSpan 581 581, unLabel = Ident {unIdent = "d"}})}]]})})})})]}] (Labeled {label = TokSpan 585 593, unLabel = ProcRepInterleave [Labeled {label = TokSpan 586 588, unLabel = Generator (Labeled {label = TokSpan 586 586, unLabel = VarPat (Labeled {label = TokSpan 586 586, unLabel = Ident {unIdent = "h"}})}) (Labeled {label = TokSpan 588 588, unLabel = Var (Labeled {label = TokSpan 588 588, unLabel = Ident {unIdent = "Host"}})})}] (Labeled {label = TokSpan 590 593, unLabel = CallFunction (Labeled {label = TokSpan 590 590, unLabel = Var (Labeled {label = TokSpan 590 590, unLabel = Ident {unIdent = "Ports"}})}) [[Labeled {label = TokSpan 592 592, unLabel = Var (Labeled {label = TokSpan 592 592, unLabel = Ident {unIdent = "h"}})}]]})})})},Labeled {label = TokSpan 594 605, unLabel = PatBind (Labeled {label = TokSpan 594 594, unLabel = VarPat (Labeled {label = TokSpan 594 594, unLabel = Ident {unIdent = "ConnectionLayer1"}})}) (Labeled {label = TokSpan 596 605, unLabel = CallFunction (Labeled {label = TokSpan 596 596, unLabel = Var (Labeled {label = TokSpan 596 596, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 598 598, unLabel = Var (Labeled {label = TokSpan 598 598, unLabel = Ident {unIdent = "ConImp"}})},Labeled {label = TokSpan 600 602, unLabel = Closure [Labeled {label = TokSpan 601 601, unLabel = Var (Labeled {label = TokSpan 601 601, unLabel = Ident {unIdent = "network"}})}]},Labeled {label = TokSpan 604 604, unLabel = Var (Labeled {label = TokSpan 604 604, unLabel = Ident {unIdent = "NetworkService"}})}]]})},Labeled {label = TokSpan 606 609, unLabel = AssertRef (Labeled {label = TokSpan 607 607, unLabel = Var (Labeled {label = TokSpan 607 607, unLabel = Ident {unIdent = "ConnectionService"}})}) "[F=" (Labeled {label = TokSpan 609 609, unLabel = Var (Labeled {label = TokSpan 609 609, unLabel = Ident {unIdent = "ConnectionLayer1"}})})},Labeled {label = TokSpan 612 617, unLabel = DataType (Labeled {label = TokSpan 613 613, unLabel = Ident {unIdent = "Direction"}}) [Labeled {label = TokSpan 615 615, unLabel = Constructor (Labeled {label = TokSpan 615 615, unLabel = Ident {unIdent = "Inbound"}}) Nothing},Labeled {label = TokSpan 617 617, unLabel = Constructor (Labeled {label = TokSpan 617 617, unLabel = Ident {unIdent = "Outbound"}}) Nothing}]},Labeled {label = TokSpan 618 623, unLabel = NameType (Labeled {label = TokSpan 619 619, unLabel = Ident {unIdent = "Transport_Addr"}}) (Labeled {label = TokSpan 621 623, unLabel = TypeDot [Labeled {label = TokSpan 621 621, unLabel = Var (Labeled {label = TokSpan 621 621, unLabel = Ident {unIdent = "Host"}})},Labeled {label = TokSpan 623 623, unLabel = Var (Labeled {label = TokSpan 623 623, unLabel = Ident {unIdent = "Direction"}})}]})},Labeled {label = TokSpan 624 629, unLabel = NameType (Labeled {label = TokSpan 625 625, unLabel = Ident {unIdent = "Transport_Data"}}) (Labeled {label = TokSpan 627 629, unLabel = TypeDot [Labeled {label = TokSpan 627 627, unLabel = Var (Labeled {label = TokSpan 627 627, unLabel = Ident {unIdent = "Connection_Addr"}})},Labeled {label = TokSpan 629 629, unLabel = Var (Labeled {label = TokSpan 629 629, unLabel = Ident {unIdent = "Network_Data"}})}]})},Labeled {label = TokSpan 630 635, unLabel = Channel [Labeled {label = TokSpan 631 631, unLabel = Ident {unIdent = "transport"}}] (Just (Labeled {label = TokSpan 633 635, unLabel = TypeDot [Labeled {label = TokSpan 633 633, unLabel = Var (Labeled {label = TokSpan 633 633, unLabel = Ident {unIdent = "Transport_Addr"}})},Labeled {label = TokSpan 635 635, unLabel = Var (Labeled {label = TokSpan 635 635, unLabel = Ident {unIdent = "Transport_Data"}})}]}))},Labeled {label = TokSpan 636 636, unLabel = FunBind (Labeled {label = TokSpan 636 636, unLabel = Ident {unIdent = "remoteport"}}) [FunCase [[Labeled {label = TokSpan 638 638, unLabel = VarPat (Labeled {label = TokSpan 638 638, unLabel = Ident {unIdent = "p"}})}]] (Labeled {label = TokSpan 641 682, unLabel = Let [Labeled {label = TokSpan 642 642, unLabel = FunBind (Labeled {label = TokSpan 642 642, unLabel = Ident {unIdent = "uniq"}}) [FunCase [[Labeled {label = TokSpan 644 646, unLabel = SingleSetPat (Labeled {label = TokSpan 645 645, unLabel = VarPat (Labeled {label = TokSpan 645 645, unLabel = Ident {unIdent = "x"}})})}]] (Labeled {label = TokSpan 649 649, unLabel = Var (Labeled {label = TokSpan 649 649, unLabel = Ident {unIdent = "x"}})})]},Labeled {label = TokSpan 650 677, unLabel = PatBind (Labeled {label = TokSpan 650 650, unLabel = VarPat (Labeled {label = TokSpan 650 650, unLabel = Ident {unIdent = "others"}})}) (Labeled {label = TokSpan 652 677, unLabel = SetComprehension ([Labeled {label = TokSpan 653 660, unLabel = Ifte (Labeled {label = TokPos 655, unLabel = Fun2 "==" (Labeled {label = TokSpan 654 654, unLabel = Var (Labeled {label = TokSpan 654 654, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 656 656, unLabel = Var (Labeled {label = TokSpan 656 656, unLabel = Ident {unIdent = "s"}})})}) (Labeled {label = TokSpan 658 658, unLabel = Var (Labeled {label = TokSpan 658 658, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 660 660, unLabel = Var (Labeled {label = TokSpan 660 660, unLabel = Ident {unIdent = "s"}})})}],[Labeled {label = TokSpan 662 668, unLabel = Generator (Labeled {label = TokSpan 662 666, unLabel = TuplePat [Labeled {label = TokSpan 663 663, unLabel = VarPat (Labeled {label = TokSpan 663 663, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 665 665, unLabel = VarPat (Labeled {label = TokSpan 665 665, unLabel = Ident {unIdent = "d"}})}]}) (Labeled {label = TokSpan 668 668, unLabel = Var (Labeled {label = TokSpan 668 668, unLabel = Ident {unIdent = "Connections"}})})},Labeled {label = TokSpan 670 676, unLabel = Guard (Labeled {label = TokPos 673, unLabel = OrExp (Labeled {label = TokPos 671, unLabel = Fun2 "==" (Labeled {label = TokSpan 670 670, unLabel = Var (Labeled {label = TokSpan 670 670, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 672 672, unLabel = Var (Labeled {label = TokSpan 672 672, unLabel = Ident {unIdent = "s"}})})}) (Labeled {label = TokPos 675, unLabel = Fun2 "==" (Labeled {label = TokSpan 674 674, unLabel = Var (Labeled {label = TokSpan 674 674, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 676 676, unLabel = Var (Labeled {label = TokSpan 676 676, unLabel = Ident {unIdent = "d"}})})})})}])})}] (Labeled {label = TokSpan 679 682, unLabel = CallFunction (Labeled {label = TokSpan 679 679, unLabel = Var (Labeled {label = TokSpan 679 679, unLabel = Ident {unIdent = "uniq"}})}) [[Labeled {label = TokSpan 681 681, unLabel = Var (Labeled {label = TokSpan 681 681, unLabel = Ident {unIdent = "others"}})}]]})})]},Labeled {label = TokSpan 683 683, unLabel = FunBind (Labeled {label = TokSpan 683 683, unLabel = Ident {unIdent = "Transport_Data_Sent"}}) [FunCase [[Labeled {label = TokSpan 685 685, unLabel = VarPat (Labeled {label = TokSpan 685 685, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 688 729, unLabel = CallBuiltIn (Labeled {label = TokSpan 688 688, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 690 708, unLabel = SetComprehension ([Labeled {label = TokSpan 691 696, unLabel = DotTuple [Labeled {label = TokSpan 691 694, unLabel = CallFunction (Labeled {label = TokSpan 691 691, unLabel = Var (Labeled {label = TokSpan 691 691, unLabel = Ident {unIdent = "remoteport"}})}) [[Labeled {label = TokSpan 693 693, unLabel = Var (Labeled {label = TokSpan 693 693, unLabel = Ident {unIdent = "p"}})}]]},Labeled {label = TokSpan 696 696, unLabel = Var (Labeled {label = TokSpan 696 696, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 698 700, unLabel = Generator (Labeled {label = TokSpan 698 698, unLabel = VarPat (Labeled {label = TokSpan 698 698, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 700 700, unLabel = Var (Labeled {label = TokSpan 700 700, unLabel = Ident {unIdent = "Network_Data_Fwd"}})})},Labeled {label = TokSpan 702 707, unLabel = Generator (Labeled {label = TokSpan 702 702, unLabel = VarPat (Labeled {label = TokSpan 702 702, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 704 707, unLabel = CallFunction (Labeled {label = TokSpan 704 704, unLabel = Var (Labeled {label = TokSpan 704 704, unLabel = Ident {unIdent = "inports"}})}) [[Labeled {label = TokSpan 706 706, unLabel = Var (Labeled {label = TokSpan 706 706, unLabel = Ident {unIdent = "host"}})}]]})}])},Labeled {label = TokSpan 710 728, unLabel = SetComprehension ([Labeled {label = TokSpan 711 716, unLabel = DotTuple [Labeled {label = TokSpan 711 714, unLabel = CallFunction (Labeled {label = TokSpan 711 711, unLabel = Var (Labeled {label = TokSpan 711 711, unLabel = Ident {unIdent = "remoteport"}})}) [[Labeled {label = TokSpan 713 713, unLabel = Var (Labeled {label = TokSpan 713 713, unLabel = Ident {unIdent = "p"}})}]]},Labeled {label = TokSpan 716 716, unLabel = Var (Labeled {label = TokSpan 716 716, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 718 720, unLabel = Generator (Labeled {label = TokSpan 718 718, unLabel = VarPat (Labeled {label = TokSpan 718 718, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 720 720, unLabel = Var (Labeled {label = TokSpan 720 720, unLabel = Ident {unIdent = "Network_Data_Rev"}})})},Labeled {label = TokSpan 722 727, unLabel = Generator (Labeled {label = TokSpan 722 722, unLabel = VarPat (Labeled {label = TokSpan 722 722, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 724 727, unLabel = CallFunction (Labeled {label = TokSpan 724 724, unLabel = Var (Labeled {label = TokSpan 724 724, unLabel = Ident {unIdent = "outports"}})}) [[Labeled {label = TokSpan 726 726, unLabel = Var (Labeled {label = TokSpan 726 726, unLabel = Ident {unIdent = "host"}})}]]})}])}]]})]},Labeled {label = TokSpan 730 730, unLabel = FunBind (Labeled {label = TokSpan 730 730, unLabel = Ident {unIdent = "Transport_Data_Recd"}}) [FunCase [[Labeled {label = TokSpan 732 732, unLabel = VarPat (Labeled {label = TokSpan 732 732, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 735 770, unLabel = CallBuiltIn (Labeled {label = TokSpan 735 735, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 737 752, unLabel = SetComprehension ([Labeled {label = TokSpan 738 740, unLabel = DotTuple [Labeled {label = TokSpan 738 738, unLabel = Var (Labeled {label = TokSpan 738 738, unLabel = Ident {unIdent = "p"}})},Labeled {label = TokSpan 740 740, unLabel = Var (Labeled {label = TokSpan 740 740, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 742 744, unLabel = Generator (Labeled {label = TokSpan 742 742, unLabel = VarPat (Labeled {label = TokSpan 742 742, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 744 744, unLabel = Var (Labeled {label = TokSpan 744 744, unLabel = Ident {unIdent = "Network_Data_Fwd"}})})},Labeled {label = TokSpan 746 751, unLabel = Generator (Labeled {label = TokSpan 746 746, unLabel = VarPat (Labeled {label = TokSpan 746 746, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 748 751, unLabel = CallFunction (Labeled {label = TokSpan 748 748, unLabel = Var (Labeled {label = TokSpan 748 748, unLabel = Ident {unIdent = "outports"}})}) [[Labeled {label = TokSpan 750 750, unLabel = Var (Labeled {label = TokSpan 750 750, unLabel = Ident {unIdent = "host"}})}]]})}])},Labeled {label = TokSpan 754 769, unLabel = SetComprehension ([Labeled {label = TokSpan 755 757, unLabel = DotTuple [Labeled {label = TokSpan 755 755, unLabel = Var (Labeled {label = TokSpan 755 755, unLabel = Ident {unIdent = "p"}})},Labeled {label = TokSpan 757 757, unLabel = Var (Labeled {label = TokSpan 757 757, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 759 761, unLabel = Generator (Labeled {label = TokSpan 759 759, unLabel = VarPat (Labeled {label = TokSpan 759 759, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 761 761, unLabel = Var (Labeled {label = TokSpan 761 761, unLabel = Ident {unIdent = "Network_Data_Rev"}})})},Labeled {label = TokSpan 763 768, unLabel = Generator (Labeled {label = TokSpan 763 763, unLabel = VarPat (Labeled {label = TokSpan 763 763, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 765 768, unLabel = CallFunction (Labeled {label = TokSpan 765 765, unLabel = Var (Labeled {label = TokSpan 765 765, unLabel = Ident {unIdent = "inports"}})}) [[Labeled {label = TokSpan 767 767, unLabel = Var (Labeled {label = TokSpan 767 767, unLabel = Ident {unIdent = "host"}})}]]})}])}]]})]},Labeled {label = TokSpan 772 815, unLabel = PatBind (Labeled {label = TokSpan 772 772, unLabel = VarPat (Labeled {label = TokSpan 772 772, unLabel = Ident {unIdent = "TransportService"}})}) (Labeled {label = TokSpan 774 815, unLabel = ProcRepInterleave [Labeled {label = TokSpan 775 777, unLabel = Generator (Labeled {label = TokSpan 775 775, unLabel = VarPat (Labeled {label = TokSpan 775 775, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 777 777, unLabel = Var (Labeled {label = TokSpan 777 777, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 779 781, unLabel = Generator (Labeled {label = TokSpan 779 779, unLabel = VarPat (Labeled {label = TokSpan 779 779, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 781 781, unLabel = Var (Labeled {label = TokSpan 781 781, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 783 785, unLabel = Guard (Labeled {label = TokPos 784, unLabel = Fun2 "!=" (Labeled {label = TokSpan 783 783, unLabel = Var (Labeled {label = TokSpan 783 783, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 785 785, unLabel = Var (Labeled {label = TokSpan 785 785, unLabel = Ident {unIdent = "d"}})})})}] (Labeled {label = TokSpan 787 815, unLabel = CallFunction (Labeled {label = TokSpan 787 787, unLabel = Var (Labeled {label = TokSpan 787 787, unLabel = Ident {unIdent = "BUFFER"}})}) [[Labeled {label = TokSpan 789 789, unLabel = IntExp 1},Labeled {label = TokSpan 791 795, unLabel = DotTuple [Labeled {label = TokSpan 791 791, unLabel = Var (Labeled {label = TokSpan 791 791, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 793 793, unLabel = Var (Labeled {label = TokSpan 793 793, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 795 795, unLabel = Var (Labeled {label = TokSpan 795 795, unLabel = Ident {unIdent = "Outbound"}})}]},Labeled {label = TokSpan 797 801, unLabel = DotTuple [Labeled {label = TokSpan 797 797, unLabel = Var (Labeled {label = TokSpan 797 797, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 799 799, unLabel = Var (Labeled {label = TokSpan 799 799, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 801 801, unLabel = Var (Labeled {label = TokSpan 801 801, unLabel = Ident {unIdent = "Inbound"}})}]},Labeled {label = TokSpan 803 814, unLabel = CallBuiltIn (Labeled {label = TokSpan 803 803, unLabel = BuiltIn "inter"}) [[Labeled {label = TokSpan 805 808, unLabel = CallFunction (Labeled {label = TokSpan 805 805, unLabel = Var (Labeled {label = TokSpan 805 805, unLabel = Ident {unIdent = "Transport_Data_Sent"}})}) [[Labeled {label = TokSpan 807 807, unLabel = Var (Labeled {label = TokSpan 807 807, unLabel = Ident {unIdent = "s"}})}]]},Labeled {label = TokSpan 810 813, unLabel = CallFunction (Labeled {label = TokSpan 810 810, unLabel = Var (Labeled {label = TokSpan 810 810, unLabel = Ident {unIdent = "Transport_Data_Recd"}})}) [[Labeled {label = TokSpan 812 812, unLabel = Var (Labeled {label = TokSpan 812 812, unLabel = Ident {unIdent = "d"}})}]]}]]}]]})})},Labeled {label = TokSpan 817 981, unLabel = PatBind (Labeled {label = TokSpan 817 817, unLabel = VarPat (Labeled {label = TokSpan 817 817, unLabel = Ident {unIdent = "NetImp"}})}) (Labeled {label = TokSpan 819 981, unLabel = Let [Labeled {label = TokSpan 820 820, unLabel = FunBind (Labeled {label = TokSpan 820 820, unLabel = Ident {unIdent = "NetworkTransmitter"}}) [FunCase [[Labeled {label = TokSpan 822 822, unLabel = VarPat (Labeled {label = TokSpan 822 822, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 825 893, unLabel = Let [Labeled {label = TokSpan 826 832, unLabel = PatBind (Labeled {label = TokSpan 826 826, unLabel = VarPat (Labeled {label = TokSpan 826 826, unLabel = Ident {unIdent = "th"}})}) (Labeled {label = TokSpan 828 832, unLabel = DotTuple [Labeled {label = TokSpan 828 828, unLabel = Var (Labeled {label = TokSpan 828 828, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 830 830, unLabel = Var (Labeled {label = TokSpan 830 830, unLabel = Ident {unIdent = "host"}})},Labeled {label = TokSpan 832 832, unLabel = Var (Labeled {label = TokSpan 832 832, unLabel = Ident {unIdent = "Outbound"}})}]})},Labeled {label = TokSpan 833 891, unLabel = PatBind (Labeled {label = TokSpan 833 833, unLabel = VarPat (Labeled {label = TokSpan 833 833, unLabel = Ident {unIdent = "NT"}})}) (Labeled {label = TokPos 863, unLabel = Fun2 "[]" (Labeled {label = TokSpan 835 862, unLabel = Parens (Labeled {label = TokSpan 836 861, unLabel = ProcRepChoice [Labeled {label = TokSpan 837 842, unLabel = Generator (Labeled {label = TokSpan 837 837, unLabel = VarPat (Labeled {label = TokSpan 837 837, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 839 842, unLabel = CallFunction (Labeled {label = TokSpan 839 839, unLabel = Var (Labeled {label = TokSpan 839 839, unLabel = Ident {unIdent = "inports"}})}) [[Labeled {label = TokSpan 841 841, unLabel = Var (Labeled {label = TokSpan 841 841, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 844 861, unLabel = PrefixExp (Labeled {label = TokSpan 844 844, unLabel = Var (Labeled {label = TokSpan 844 844, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 845 846, unLabel = OutComm (Labeled {label = TokSpan 846 846, unLabel = Var (Labeled {label = TokSpan 846 846, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 847 850, unLabel = InCommGuarded (Labeled {label = TokSpan 848 848, unLabel = VarPat (Labeled {label = TokSpan 848 848, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 850 850, unLabel = Var (Labeled {label = TokSpan 850 850, unLabel = Ident {unIdent = "Network_Data_Fwd"}})})}] (Labeled {label = TokSpan 852 861, unLabel = PrefixExp (Labeled {label = TokSpan 852 852, unLabel = Var (Labeled {label = TokSpan 852 852, unLabel = Ident {unIdent = "th"}})}) [Labeled {label = TokSpan 853 857, unLabel = OutComm (Labeled {label = TokSpan 854 857, unLabel = CallFunction (Labeled {label = TokSpan 854 854, unLabel = Var (Labeled {label = TokSpan 854 854, unLabel = Ident {unIdent = "remoteport"}})}) [[Labeled {label = TokSpan 856 856, unLabel = Var (Labeled {label = TokSpan 856 856, unLabel = Ident {unIdent = "p"}})}]]})},Labeled {label = TokSpan 858 859, unLabel = OutComm (Labeled {label = TokSpan 859 859, unLabel = Var (Labeled {label = TokSpan 859 859, unLabel = Ident {unIdent = "d"}})})}] (Labeled {label = TokSpan 861 861, unLabel = Var (Labeled {label = TokSpan 861 861, unLabel = Ident {unIdent = "NT"}})})})})})}) (Labeled {label = TokSpan 864 891, unLabel = Parens (Labeled {label = TokSpan 865 890, unLabel = ProcRepChoice [Labeled {label = TokSpan 866 871, unLabel = Generator (Labeled {label = TokSpan 866 866, unLabel = VarPat (Labeled {label = TokSpan 866 866, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 868 871, unLabel = CallFunction (Labeled {label = TokSpan 868 868, unLabel = Var (Labeled {label = TokSpan 868 868, unLabel = Ident {unIdent = "outports"}})}) [[Labeled {label = TokSpan 870 870, unLabel = Var (Labeled {label = TokSpan 870 870, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 873 890, unLabel = PrefixExp (Labeled {label = TokSpan 873 873, unLabel = Var (Labeled {label = TokSpan 873 873, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 874 875, unLabel = OutComm (Labeled {label = TokSpan 875 875, unLabel = Var (Labeled {label = TokSpan 875 875, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 876 879, unLabel = InCommGuarded (Labeled {label = TokSpan 877 877, unLabel = VarPat (Labeled {label = TokSpan 877 877, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 879 879, unLabel = Var (Labeled {label = TokSpan 879 879, unLabel = Ident {unIdent = "Network_Data_Rev"}})})}] (Labeled {label = TokSpan 881 890, unLabel = PrefixExp (Labeled {label = TokSpan 881 881, unLabel = Var (Labeled {label = TokSpan 881 881, unLabel = Ident {unIdent = "th"}})}) [Labeled {label = TokSpan 882 886, unLabel = OutComm (Labeled {label = TokSpan 883 886, unLabel = CallFunction (Labeled {label = TokSpan 883 883, unLabel = Var (Labeled {label = TokSpan 883 883, unLabel = Ident {unIdent = "remoteport"}})}) [[Labeled {label = TokSpan 885 885, unLabel = Var (Labeled {label = TokSpan 885 885, unLabel = Ident {unIdent = "p"}})}]]})},Labeled {label = TokSpan 887 888, unLabel = OutComm (Labeled {label = TokSpan 888 888, unLabel = Var (Labeled {label = TokSpan 888 888, unLabel = Ident {unIdent = "d"}})})}] (Labeled {label = TokSpan 890 890, unLabel = Var (Labeled {label = TokSpan 890 890, unLabel = Ident {unIdent = "NT"}})})})})})})})}] (Labeled {label = TokSpan 893 893, unLabel = Var (Labeled {label = TokSpan 893 893, unLabel = Ident {unIdent = "NT"}})})})]},Labeled {label = TokSpan 894 894, unLabel = FunBind (Labeled {label = TokSpan 894 894, unLabel = Ident {unIdent = "NetworkReceiver"}}) [FunCase [[Labeled {label = TokSpan 896 896, unLabel = VarPat (Labeled {label = TokSpan 896 896, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 899 961, unLabel = Let [Labeled {label = TokSpan 900 906, unLabel = PatBind (Labeled {label = TokSpan 900 900, unLabel = VarPat (Labeled {label = TokSpan 900 900, unLabel = Ident {unIdent = "th"}})}) (Labeled {label = TokSpan 902 906, unLabel = DotTuple [Labeled {label = TokSpan 902 902, unLabel = Var (Labeled {label = TokSpan 902 902, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 904 904, unLabel = Var (Labeled {label = TokSpan 904 904, unLabel = Ident {unIdent = "host"}})},Labeled {label = TokSpan 906 906, unLabel = Var (Labeled {label = TokSpan 906 906, unLabel = Ident {unIdent = "Inbound"}})}]})},Labeled {label = TokSpan 907 959, unLabel = PatBind (Labeled {label = TokSpan 907 907, unLabel = VarPat (Labeled {label = TokSpan 907 907, unLabel = Ident {unIdent = "NR"}})}) (Labeled {label = TokPos 934, unLabel = Fun2 "[]" (Labeled {label = TokSpan 909 933, unLabel = Parens (Labeled {label = TokSpan 910 932, unLabel = ProcRepChoice [Labeled {label = TokSpan 911 916, unLabel = Generator (Labeled {label = TokSpan 911 911, unLabel = VarPat (Labeled {label = TokSpan 911 911, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 913 916, unLabel = CallFunction (Labeled {label = TokSpan 913 913, unLabel = Var (Labeled {label = TokSpan 913 913, unLabel = Ident {unIdent = "outports"}})}) [[Labeled {label = TokSpan 915 915, unLabel = Var (Labeled {label = TokSpan 915 915, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 918 932, unLabel = PrefixExp (Labeled {label = TokSpan 918 918, unLabel = Var (Labeled {label = TokSpan 918 918, unLabel = Ident {unIdent = "th"}})}) [Labeled {label = TokSpan 919 920, unLabel = OutComm (Labeled {label = TokSpan 920 920, unLabel = Var (Labeled {label = TokSpan 920 920, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 921 924, unLabel = InCommGuarded (Labeled {label = TokSpan 922 922, unLabel = VarPat (Labeled {label = TokSpan 922 922, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 924 924, unLabel = Var (Labeled {label = TokSpan 924 924, unLabel = Ident {unIdent = "Network_Data_Fwd"}})})}] (Labeled {label = TokSpan 926 932, unLabel = PrefixExp (Labeled {label = TokSpan 926 926, unLabel = Var (Labeled {label = TokSpan 926 926, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 927 928, unLabel = OutComm (Labeled {label = TokSpan 928 928, unLabel = Var (Labeled {label = TokSpan 928 928, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 929 930, unLabel = OutComm (Labeled {label = TokSpan 930 930, unLabel = Var (Labeled {label = TokSpan 930 930, unLabel = Ident {unIdent = "d"}})})}] (Labeled {label = TokSpan 932 932, unLabel = Var (Labeled {label = TokSpan 932 932, unLabel = Ident {unIdent = "NR"}})})})})})}) (Labeled {label = TokSpan 935 959, unLabel = Parens (Labeled {label = TokSpan 936 958, unLabel = ProcRepChoice [Labeled {label = TokSpan 937 942, unLabel = Generator (Labeled {label = TokSpan 937 937, unLabel = VarPat (Labeled {label = TokSpan 937 937, unLabel = Ident {unIdent = "p"}})}) (Labeled {label = TokSpan 939 942, unLabel = CallFunction (Labeled {label = TokSpan 939 939, unLabel = Var (Labeled {label = TokSpan 939 939, unLabel = Ident {unIdent = "inports"}})}) [[Labeled {label = TokSpan 941 941, unLabel = Var (Labeled {label = TokSpan 941 941, unLabel = Ident {unIdent = "host"}})}]]})}] (Labeled {label = TokSpan 944 958, unLabel = PrefixExp (Labeled {label = TokSpan 944 944, unLabel = Var (Labeled {label = TokSpan 944 944, unLabel = Ident {unIdent = "th"}})}) [Labeled {label = TokSpan 945 946, unLabel = OutComm (Labeled {label = TokSpan 946 946, unLabel = Var (Labeled {label = TokSpan 946 946, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 947 950, unLabel = InCommGuarded (Labeled {label = TokSpan 948 948, unLabel = VarPat (Labeled {label = TokSpan 948 948, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 950 950, unLabel = Var (Labeled {label = TokSpan 950 950, unLabel = Ident {unIdent = "Network_Data_Rev"}})})}] (Labeled {label = TokSpan 952 958, unLabel = PrefixExp (Labeled {label = TokSpan 952 952, unLabel = Var (Labeled {label = TokSpan 952 952, unLabel = Ident {unIdent = "network"}})}) [Labeled {label = TokSpan 953 954, unLabel = OutComm (Labeled {label = TokSpan 954 954, unLabel = Var (Labeled {label = TokSpan 954 954, unLabel = Ident {unIdent = "p"}})})},Labeled {label = TokSpan 955 956, unLabel = OutComm (Labeled {label = TokSpan 956 956, unLabel = Var (Labeled {label = TokSpan 956 956, unLabel = Ident {unIdent = "d"}})})}] (Labeled {label = TokSpan 958 958, unLabel = Var (Labeled {label = TokSpan 958 958, unLabel = Ident {unIdent = "NR"}})})})})})})})}] (Labeled {label = TokSpan 961 961, unLabel = Var (Labeled {label = TokSpan 961 961, unLabel = Ident {unIdent = "NR"}})})})]}] (Labeled {label = TokSpan 966 981, unLabel = ProcRepInterleave [Labeled {label = TokSpan 967 969, unLabel = Generator (Labeled {label = TokSpan 967 967, unLabel = VarPat (Labeled {label = TokSpan 967 967, unLabel = Ident {unIdent = "h"}})}) (Labeled {label = TokSpan 969 969, unLabel = Var (Labeled {label = TokSpan 969 969, unLabel = Ident {unIdent = "Host"}})})}] (Labeled {label = TokSpan 971 981, unLabel = Parens (Labeled {label = TokPos 976, unLabel = Fun2 "|||" (Labeled {label = TokSpan 972 975, unLabel = CallFunction (Labeled {label = TokSpan 972 972, unLabel = Var (Labeled {label = TokSpan 972 972, unLabel = Ident {unIdent = "NetworkTransmitter"}})}) [[Labeled {label = TokSpan 974 974, unLabel = Var (Labeled {label = TokSpan 974 974, unLabel = Ident {unIdent = "h"}})}]]}) (Labeled {label = TokSpan 977 980, unLabel = CallFunction (Labeled {label = TokSpan 977 977, unLabel = Var (Labeled {label = TokSpan 977 977, unLabel = Ident {unIdent = "NetworkReceiver"}})}) [[Labeled {label = TokSpan 979 979, unLabel = Var (Labeled {label = TokSpan 979 979, unLabel = Ident {unIdent = "h"}})}]]})})})})})},Labeled {label = TokSpan 982 993, unLabel = PatBind (Labeled {label = TokSpan 982 982, unLabel = VarPat (Labeled {label = TokSpan 982 982, unLabel = Ident {unIdent = "NetworkLayer1"}})}) (Labeled {label = TokSpan 984 993, unLabel = CallFunction (Labeled {label = TokSpan 984 984, unLabel = Var (Labeled {label = TokSpan 984 984, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 986 986, unLabel = Var (Labeled {label = TokSpan 986 986, unLabel = Ident {unIdent = "NetImp"}})},Labeled {label = TokSpan 988 990, unLabel = Closure [Labeled {label = TokSpan 989 989, unLabel = Var (Labeled {label = TokSpan 989 989, unLabel = Ident {unIdent = "transport"}})}]},Labeled {label = TokSpan 992 992, unLabel = Var (Labeled {label = TokSpan 992 992, unLabel = Ident {unIdent = "TransportService"}})}]]})},Labeled {label = TokSpan 1000 1011, unLabel = PatBind (Labeled {label = TokSpan 1000 1000, unLabel = VarPat (Labeled {label = TokSpan 1000 1000, unLabel = Ident {unIdent = "ConnectionLayer2"}})}) (Labeled {label = TokSpan 1002 1011, unLabel = CallFunction (Labeled {label = TokSpan 1002 1002, unLabel = Var (Labeled {label = TokSpan 1002 1002, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1004 1004, unLabel = Var (Labeled {label = TokSpan 1004 1004, unLabel = Ident {unIdent = "ConImp"}})},Labeled {label = TokSpan 1006 1008, unLabel = Closure [Labeled {label = TokSpan 1007 1007, unLabel = Var (Labeled {label = TokSpan 1007 1007, unLabel = Ident {unIdent = "network"}})}]},Labeled {label = TokSpan 1010 1010, unLabel = Var (Labeled {label = TokSpan 1010 1010, unLabel = Ident {unIdent = "NetworkLayer1"}})}]]})},Labeled {label = TokSpan 1012 1015, unLabel = AssertRef (Labeled {label = TokSpan 1013 1013, unLabel = Var (Labeled {label = TokSpan 1013 1013, unLabel = Ident {unIdent = "ConnectionService"}})}) "[F=" (Labeled {label = TokSpan 1015 1015, unLabel = Var (Labeled {label = TokSpan 1015 1015, unLabel = Ident {unIdent = "ConnectionLayer2"}})})},Labeled {label = TokSpan 1017 1022, unLabel = DataType (Labeled {label = TokSpan 1018 1018, unLabel = Ident {unIdent = "MySeq"}}) [Labeled {label = TokSpan 1020 1020, unLabel = Constructor (Labeled {label = TokSpan 1020 1020, unLabel = Ident {unIdent = "seq0"}}) Nothing},Labeled {label = TokSpan 1022 1022, unLabel = Constructor (Labeled {label = TokSpan 1022 1022, unLabel = Ident {unIdent = "seq1"}}) Nothing}]},Labeled {label = TokSpan 1024 1024, unLabel = FunBind (Labeled {label = TokSpan 1024 1024, unLabel = Ident {unIdent = "seq_next"}}) [FunCase [[Labeled {label = TokSpan 1026 1026, unLabel = VarPat (Labeled {label = TokSpan 1026 1026, unLabel = Ident {unIdent = "seq0"}})}]] (Labeled {label = TokSpan 1029 1029, unLabel = Var (Labeled {label = TokSpan 1029 1029, unLabel = Ident {unIdent = "seq1"}})}),FunCase [[Labeled {label = TokSpan 1032 1032, unLabel = VarPat (Labeled {label = TokSpan 1032 1032, unLabel = Ident {unIdent = "seq1"}})}]] (Labeled {label = TokSpan 1035 1035, unLabel = Var (Labeled {label = TokSpan 1035 1035, unLabel = Ident {unIdent = "seq0"}})})]},Labeled {label = TokSpan 1036 1047, unLabel = DataType (Labeled {label = TokSpan 1037 1037, unLabel = Ident {unIdent = "Transport_Primitive"}}) [Labeled {label = TokSpan 1039 1041, unLabel = Constructor (Labeled {label = TokSpan 1039 1039, unLabel = Ident {unIdent = "TAck"}}) (Just (Labeled {label = TokSpan 1041 1041, unLabel = TypeDot [Labeled {label = TokSpan 1041 1041, unLabel = Var (Labeled {label = TokSpan 1041 1041, unLabel = Ident {unIdent = "MySeq"}})}]}))},Labeled {label = TokSpan 1043 1047, unLabel = Constructor (Labeled {label = TokSpan 1043 1043, unLabel = Ident {unIdent = "TData"}}) (Just (Labeled {label = TokSpan 1045 1047, unLabel = TypeDot [Labeled {label = TokSpan 1045 1045, unLabel = Var (Labeled {label = TokSpan 1045 1045, unLabel = Ident {unIdent = "MySeq"}})},Labeled {label = TokSpan 1047 1047, unLabel = Var (Labeled {label = TokSpan 1047 1047, unLabel = Ident {unIdent = "Transport_Data"}})}]}))}]},Labeled {label = TokSpan 1049 1051, unLabel = PatBind (Labeled {label = TokSpan 1049 1049, unLabel = VarPat (Labeled {label = TokSpan 1049 1049, unLabel = Ident {unIdent = "Packet_Data"}})}) (Labeled {label = TokSpan 1051 1051, unLabel = Var (Labeled {label = TokSpan 1051 1051, unLabel = Ident {unIdent = "Transport_Primitive"}})})},Labeled {label = TokSpan 1052 1057, unLabel = DataType (Labeled {label = TokSpan 1053 1053, unLabel = Ident {unIdent = "Function"}}) [Labeled {label = TokSpan 1055 1055, unLabel = Constructor (Labeled {label = TokSpan 1055 1055, unLabel = Ident {unIdent = "Forward"}}) Nothing},Labeled {label = TokSpan 1057 1057, unLabel = Constructor (Labeled {label = TokSpan 1057 1057, unLabel = Ident {unIdent = "Reverse"}}) Nothing}]},Labeled {label = TokSpan 1058 1065, unLabel = NameType (Labeled {label = TokSpan 1059 1059, unLabel = Ident {unIdent = "Packet_Addr"}}) (Labeled {label = TokSpan 1061 1065, unLabel = TypeDot [Labeled {label = TokSpan 1061 1061, unLabel = Var (Labeled {label = TokSpan 1061 1061, unLabel = Ident {unIdent = "Host"}})},Labeled {label = TokSpan 1063 1063, unLabel = Var (Labeled {label = TokSpan 1063 1063, unLabel = Ident {unIdent = "Direction"}})},Labeled {label = TokSpan 1065 1065, unLabel = Var (Labeled {label = TokSpan 1065 1065, unLabel = Ident {unIdent = "Function"}})}]})},Labeled {label = TokSpan 1066 1071, unLabel = Channel [Labeled {label = TokSpan 1067 1067, unLabel = Ident {unIdent = "packet"}}] (Just (Labeled {label = TokSpan 1069 1071, unLabel = TypeDot [Labeled {label = TokSpan 1069 1069, unLabel = Var (Labeled {label = TokSpan 1069 1069, unLabel = Ident {unIdent = "Packet_Addr"}})},Labeled {label = TokSpan 1071 1071, unLabel = Var (Labeled {label = TokSpan 1071 1071, unLabel = Ident {unIdent = "Packet_Data"}})}]}))},Labeled {label = TokSpan 1072 1072, unLabel = FunBind (Labeled {label = TokSpan 1072 1072, unLabel = Ident {unIdent = "Packet_Data_Sent"}}) [FunCase [[Labeled {label = TokSpan 1074 1074, unLabel = VarPat (Labeled {label = TokSpan 1074 1074, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 1077 1094, unLabel = SetComprehension ([Labeled {label = TokSpan 1078 1082, unLabel = DotTuple [Labeled {label = TokSpan 1078 1078, unLabel = Var (Labeled {label = TokSpan 1078 1078, unLabel = Ident {unIdent = "TData"}})},Labeled {label = TokSpan 1080 1080, unLabel = Var (Labeled {label = TokSpan 1080 1080, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1082 1082, unLabel = Var (Labeled {label = TokSpan 1082 1082, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 1084 1086, unLabel = Generator (Labeled {label = TokSpan 1084 1084, unLabel = VarPat (Labeled {label = TokSpan 1084 1084, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1086 1086, unLabel = Var (Labeled {label = TokSpan 1086 1086, unLabel = Ident {unIdent = "MySeq"}})})},Labeled {label = TokSpan 1088 1093, unLabel = Generator (Labeled {label = TokSpan 1088 1088, unLabel = VarPat (Labeled {label = TokSpan 1088 1088, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1090 1093, unLabel = CallFunction (Labeled {label = TokSpan 1090 1090, unLabel = Var (Labeled {label = TokSpan 1090 1090, unLabel = Ident {unIdent = "Transport_Data_Sent"}})}) [[Labeled {label = TokSpan 1092 1092, unLabel = Var (Labeled {label = TokSpan 1092 1092, unLabel = Ident {unIdent = "host"}})}]]})}])})]},Labeled {label = TokSpan 1095 1095, unLabel = FunBind (Labeled {label = TokSpan 1095 1095, unLabel = Ident {unIdent = "Packet_Data_Recd"}}) [FunCase [[Labeled {label = TokSpan 1097 1097, unLabel = VarPat (Labeled {label = TokSpan 1097 1097, unLabel = Ident {unIdent = "host"}})}]] (Labeled {label = TokSpan 1100 1117, unLabel = SetComprehension ([Labeled {label = TokSpan 1101 1105, unLabel = DotTuple [Labeled {label = TokSpan 1101 1101, unLabel = Var (Labeled {label = TokSpan 1101 1101, unLabel = Ident {unIdent = "TData"}})},Labeled {label = TokSpan 1103 1103, unLabel = Var (Labeled {label = TokSpan 1103 1103, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1105 1105, unLabel = Var (Labeled {label = TokSpan 1105 1105, unLabel = Ident {unIdent = "d"}})}]}],[Labeled {label = TokSpan 1107 1109, unLabel = Generator (Labeled {label = TokSpan 1107 1107, unLabel = VarPat (Labeled {label = TokSpan 1107 1107, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1109 1109, unLabel = Var (Labeled {label = TokSpan 1109 1109, unLabel = Ident {unIdent = "MySeq"}})})},Labeled {label = TokSpan 1111 1116, unLabel = Generator (Labeled {label = TokSpan 1111 1111, unLabel = VarPat (Labeled {label = TokSpan 1111 1111, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1113 1116, unLabel = CallFunction (Labeled {label = TokSpan 1113 1113, unLabel = Var (Labeled {label = TokSpan 1113 1113, unLabel = Ident {unIdent = "Transport_Data_Recd"}})}) [[Labeled {label = TokSpan 1115 1115, unLabel = Var (Labeled {label = TokSpan 1115 1115, unLabel = Ident {unIdent = "host"}})}]]})}])})]},Labeled {label = TokSpan 1118 1118, unLabel = FunBind (Labeled {label = TokSpan 1118 1118, unLabel = Ident {unIdent = "PacketPair"}}) [FunCase [[Labeled {label = TokSpan 1120 1120, unLabel = VarPat (Labeled {label = TokSpan 1120 1120, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1122 1122, unLabel = VarPat (Labeled {label = TokSpan 1122 1122, unLabel = Ident {unIdent = "d"}})}]] (Labeled {label = TokPos 1160, unLabel = Fun2 "|||" (Labeled {label = TokSpan 1125 1159, unLabel = CallFunction (Labeled {label = TokSpan 1125 1125, unLabel = Var (Labeled {label = TokSpan 1125 1125, unLabel = Ident {unIdent = "FAULTY"}})}) [[Labeled {label = TokSpan 1127 1127, unLabel = IntExp 1},Labeled {label = TokSpan 1129 1133, unLabel = DotTuple [Labeled {label = TokSpan 1129 1129, unLabel = Var (Labeled {label = TokSpan 1129 1129, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1131 1131, unLabel = Var (Labeled {label = TokSpan 1131 1131, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1133 1133, unLabel = Var (Labeled {label = TokSpan 1133 1133, unLabel = Ident {unIdent = "Forward"}})}]},Labeled {label = TokSpan 1135 1139, unLabel = DotTuple [Labeled {label = TokSpan 1135 1135, unLabel = Var (Labeled {label = TokSpan 1135 1135, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1137 1137, unLabel = Var (Labeled {label = TokSpan 1137 1137, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1139 1139, unLabel = Var (Labeled {label = TokSpan 1139 1139, unLabel = Ident {unIdent = "Forward"}})}]},Labeled {label = TokSpan 1141 1158, unLabel = CallBuiltIn (Labeled {label = TokSpan 1141 1141, unLabel = BuiltIn "inter"}) [[Labeled {label = TokSpan 1143 1149, unLabel = CallFunction (Labeled {label = TokSpan 1143 1143, unLabel = Var (Labeled {label = TokSpan 1143 1143, unLabel = Ident {unIdent = "Packet_Data_Sent"}})}) [[Labeled {label = TokSpan 1145 1148, unLabel = CallFunction (Labeled {label = TokSpan 1145 1145, unLabel = Var (Labeled {label = TokSpan 1145 1145, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 1147 1147, unLabel = Var (Labeled {label = TokSpan 1147 1147, unLabel = Ident {unIdent = "s"}})}]]}]]},Labeled {label = TokSpan 1151 1157, unLabel = CallFunction (Labeled {label = TokSpan 1151 1151, unLabel = Var (Labeled {label = TokSpan 1151 1151, unLabel = Ident {unIdent = "Packet_Data_Recd"}})}) [[Labeled {label = TokSpan 1153 1156, unLabel = CallFunction (Labeled {label = TokSpan 1153 1153, unLabel = Var (Labeled {label = TokSpan 1153 1153, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 1155 1155, unLabel = Var (Labeled {label = TokSpan 1155 1155, unLabel = Ident {unIdent = "d"}})}]]}]]}]]}]]}) (Labeled {label = TokSpan 1161 1180, unLabel = CallFunction (Labeled {label = TokSpan 1161 1161, unLabel = Var (Labeled {label = TokSpan 1161 1161, unLabel = Ident {unIdent = "FAULTY"}})}) [[Labeled {label = TokSpan 1163 1163, unLabel = IntExp 1},Labeled {label = TokSpan 1165 1169, unLabel = DotTuple [Labeled {label = TokSpan 1165 1165, unLabel = Var (Labeled {label = TokSpan 1165 1165, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1167 1167, unLabel = Var (Labeled {label = TokSpan 1167 1167, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1169 1169, unLabel = Var (Labeled {label = TokSpan 1169 1169, unLabel = Ident {unIdent = "Reverse"}})}]},Labeled {label = TokSpan 1171 1175, unLabel = DotTuple [Labeled {label = TokSpan 1171 1171, unLabel = Var (Labeled {label = TokSpan 1171 1171, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1173 1173, unLabel = Var (Labeled {label = TokSpan 1173 1173, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1175 1175, unLabel = Var (Labeled {label = TokSpan 1175 1175, unLabel = Ident {unIdent = "Reverse"}})}]},Labeled {label = TokSpan 1177 1179, unLabel = Closure [Labeled {label = TokSpan 1178 1178, unLabel = Var (Labeled {label = TokSpan 1178 1178, unLabel = Ident {unIdent = "TAck"}})}]}]]})})]},Labeled {label = TokSpan 1181 1205, unLabel = PatBind (Labeled {label = TokSpan 1181 1181, unLabel = VarPat (Labeled {label = TokSpan 1181 1181, unLabel = Ident {unIdent = "PacketService"}})}) (Labeled {label = TokSpan 1183 1205, unLabel = ProcRepInterleave [Labeled {label = TokSpan 1184 1186, unLabel = Generator (Labeled {label = TokSpan 1184 1184, unLabel = VarPat (Labeled {label = TokSpan 1184 1184, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1186 1186, unLabel = Var (Labeled {label = TokSpan 1186 1186, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1188 1190, unLabel = Generator (Labeled {label = TokSpan 1188 1188, unLabel = VarPat (Labeled {label = TokSpan 1188 1188, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1190 1190, unLabel = Var (Labeled {label = TokSpan 1190 1190, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1192 1194, unLabel = Guard (Labeled {label = TokPos 1193, unLabel = Fun2 "!=" (Labeled {label = TokSpan 1192 1192, unLabel = Var (Labeled {label = TokSpan 1192 1192, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1194 1194, unLabel = Var (Labeled {label = TokSpan 1194 1194, unLabel = Ident {unIdent = "d"}})})})}] (Labeled {label = TokSpan 1196 1205, unLabel = CallFunction (Labeled {label = TokSpan 1196 1196, unLabel = Var (Labeled {label = TokSpan 1196 1196, unLabel = Ident {unIdent = "PacketPair"}})}) [[Labeled {label = TokSpan 1198 1200, unLabel = DotTuple [Labeled {label = TokSpan 1198 1198, unLabel = Var (Labeled {label = TokSpan 1198 1198, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1200 1200, unLabel = Var (Labeled {label = TokSpan 1200 1200, unLabel = Ident {unIdent = "Outbound"}})}]},Labeled {label = TokSpan 1202 1204, unLabel = DotTuple [Labeled {label = TokSpan 1202 1202, unLabel = Var (Labeled {label = TokSpan 1202 1202, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1204 1204, unLabel = Var (Labeled {label = TokSpan 1204 1204, unLabel = Ident {unIdent = "Inbound"}})}]}]]})})},Labeled {label = TokSpan 1206 1206, unLabel = FunBind (Labeled {label = TokSpan 1206 1206, unLabel = Ident {unIdent = "TransportSender"}}) [FunCase [[Labeled {label = TokSpan 1208 1208, unLabel = VarPat (Labeled {label = TokSpan 1208 1208, unLabel = Ident {unIdent = "taddr"}})}]] (Labeled {label = TokSpan 1211 1311, unLabel = Let [Labeled {label = TokSpan 1212 1217, unLabel = PatBind (Labeled {label = TokSpan 1212 1212, unLabel = VarPat (Labeled {label = TokSpan 1212 1212, unLabel = Ident {unIdent = "h"}})}) (Labeled {label = TokSpan 1214 1217, unLabel = CallFunction (Labeled {label = TokSpan 1214 1214, unLabel = Var (Labeled {label = TokSpan 1214 1214, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 1216 1216, unLabel = Var (Labeled {label = TokSpan 1216 1216, unLabel = Ident {unIdent = "taddr"}})}]]})},Labeled {label = TokSpan 1218 1218, unLabel = FunBind (Labeled {label = TokSpan 1218 1218, unLabel = Ident {unIdent = "TS"}}) [FunCase [[Labeled {label = TokSpan 1220 1220, unLabel = VarPat (Labeled {label = TokSpan 1220 1220, unLabel = Ident {unIdent = "vs"}})},Labeled {label = TokSpan 1222 1222, unLabel = VarPat (Labeled {label = TokSpan 1222 1222, unLabel = Ident {unIdent = "seq"}})}]] (Labeled {label = TokPos 1277, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1225 1276, unLabel = Parens (Labeled {label = TokSpan 1226 1275, unLabel = Ifte (Labeled {label = TokSpan 1227 1230, unLabel = CallBuiltIn (Labeled {label = TokSpan 1227 1227, unLabel = BuiltIn "null"}) [[Labeled {label = TokSpan 1229 1229, unLabel = Var (Labeled {label = TokSpan 1229 1229, unLabel = Ident {unIdent = "vs"}})}]]}) (Labeled {label = TokSpan 1232 1253, unLabel = PrefixExp (Labeled {label = TokSpan 1232 1232, unLabel = Var (Labeled {label = TokSpan 1232 1232, unLabel = Ident {unIdent = "transport"}})}) [Labeled {label = TokSpan 1233 1234, unLabel = OutComm (Labeled {label = TokSpan 1234 1234, unLabel = Var (Labeled {label = TokSpan 1234 1234, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1235 1241, unLabel = InCommGuarded (Labeled {label = TokSpan 1236 1236, unLabel = VarPat (Labeled {label = TokSpan 1236 1236, unLabel = Ident {unIdent = "tdata"}})}) (Labeled {label = TokSpan 1238 1241, unLabel = CallFunction (Labeled {label = TokSpan 1238 1238, unLabel = Var (Labeled {label = TokSpan 1238 1238, unLabel = Ident {unIdent = "Transport_Data_Sent"}})}) [[Labeled {label = TokSpan 1240 1240, unLabel = Var (Labeled {label = TokSpan 1240 1240, unLabel = Ident {unIdent = "h"}})}]]})}] (Labeled {label = TokSpan 1243 1253, unLabel = CallFunction (Labeled {label = TokSpan 1243 1243, unLabel = Var (Labeled {label = TokSpan 1243 1243, unLabel = Ident {unIdent = "TS"}})}) [[Labeled {label = TokSpan 1245 1247, unLabel = ListEnum [Labeled {label = TokSpan 1246 1246, unLabel = Var (Labeled {label = TokSpan 1246 1246, unLabel = Ident {unIdent = "tdata"}})}]},Labeled {label = TokSpan 1249 1252, unLabel = CallFunction (Labeled {label = TokSpan 1249 1249, unLabel = Var (Labeled {label = TokSpan 1249 1249, unLabel = Ident {unIdent = "seq_next"}})}) [[Labeled {label = TokSpan 1251 1251, unLabel = Var (Labeled {label = TokSpan 1251 1251, unLabel = Ident {unIdent = "seq"}})}]]}]]})}) (Labeled {label = TokSpan 1255 1275, unLabel = PrefixExp (Labeled {label = TokSpan 1255 1255, unLabel = Var (Labeled {label = TokSpan 1255 1255, unLabel = Ident {unIdent = "packet"}})}) [Labeled {label = TokSpan 1256 1257, unLabel = OutComm (Labeled {label = TokSpan 1257 1257, unLabel = Var (Labeled {label = TokSpan 1257 1257, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1258 1259, unLabel = OutComm (Labeled {label = TokSpan 1259 1259, unLabel = Var (Labeled {label = TokSpan 1259 1259, unLabel = Ident {unIdent = "Forward"}})})},Labeled {label = TokSpan 1260 1261, unLabel = OutComm (Labeled {label = TokSpan 1261 1261, unLabel = Var (Labeled {label = TokSpan 1261 1261, unLabel = Ident {unIdent = "TData"}})})},Labeled {label = TokSpan 1262 1263, unLabel = OutComm (Labeled {label = TokSpan 1263 1263, unLabel = Var (Labeled {label = TokSpan 1263 1263, unLabel = Ident {unIdent = "seq"}})})},Labeled {label = TokSpan 1264 1268, unLabel = OutComm (Labeled {label = TokSpan 1265 1268, unLabel = CallBuiltIn (Labeled {label = TokSpan 1265 1265, unLabel = BuiltIn "head"}) [[Labeled {label = TokSpan 1267 1267, unLabel = Var (Labeled {label = TokSpan 1267 1267, unLabel = Ident {unIdent = "vs"}})}]]})}] (Labeled {label = TokSpan 1270 1275, unLabel = CallFunction (Labeled {label = TokSpan 1270 1270, unLabel = Var (Labeled {label = TokSpan 1270 1270, unLabel = Ident {unIdent = "TS"}})}) [[Labeled {label = TokSpan 1272 1272, unLabel = Var (Labeled {label = TokSpan 1272 1272, unLabel = Ident {unIdent = "vs"}})},Labeled {label = TokSpan 1274 1274, unLabel = Var (Labeled {label = TokSpan 1274 1274, unLabel = Ident {unIdent = "seq"}})}]]})})})}) (Labeled {label = TokSpan 1278 1303, unLabel = Parens (Labeled {label = TokSpan 1279 1302, unLabel = PrefixExp (Labeled {label = TokSpan 1279 1279, unLabel = Var (Labeled {label = TokSpan 1279 1279, unLabel = Ident {unIdent = "packet"}})}) [Labeled {label = TokSpan 1280 1281, unLabel = OutComm (Labeled {label = TokSpan 1281 1281, unLabel = Var (Labeled {label = TokSpan 1281 1281, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1282 1283, unLabel = OutComm (Labeled {label = TokSpan 1283 1283, unLabel = Var (Labeled {label = TokSpan 1283 1283, unLabel = Ident {unIdent = "Reverse"}})})},Labeled {label = TokSpan 1284 1285, unLabel = OutComm (Labeled {label = TokSpan 1285 1285, unLabel = Var (Labeled {label = TokSpan 1285 1285, unLabel = Ident {unIdent = "TAck"}})})},Labeled {label = TokSpan 1286 1287, unLabel = InComm (Labeled {label = TokSpan 1287 1287, unLabel = VarPat (Labeled {label = TokSpan 1287 1287, unLabel = Ident {unIdent = "s"}})})}] (Labeled {label = TokSpan 1289 1302, unLabel = CallFunction (Labeled {label = TokSpan 1289 1289, unLabel = Var (Labeled {label = TokSpan 1289 1289, unLabel = Ident {unIdent = "TS"}})}) [[Labeled {label = TokSpan 1291 1299, unLabel = Ifte (Labeled {label = TokPos 1293, unLabel = Fun2 "==" (Labeled {label = TokSpan 1292 1292, unLabel = Var (Labeled {label = TokSpan 1292 1292, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1294 1294, unLabel = Var (Labeled {label = TokSpan 1294 1294, unLabel = Ident {unIdent = "seq"}})})}) (Labeled {label = TokSpan 1296 1297, unLabel = ListEnum []}) (Labeled {label = TokSpan 1299 1299, unLabel = Var (Labeled {label = TokSpan 1299 1299, unLabel = Ident {unIdent = "vs"}})})},Labeled {label = TokSpan 1301 1301, unLabel = Var (Labeled {label = TokSpan 1301 1301, unLabel = Ident {unIdent = "seq"}})}]]})})})})]}] (Labeled {label = TokSpan 1305 1311, unLabel = CallFunction (Labeled {label = TokSpan 1305 1305, unLabel = Var (Labeled {label = TokSpan 1305 1305, unLabel = Ident {unIdent = "TS"}})}) [[Labeled {label = TokSpan 1307 1308, unLabel = ListEnum []},Labeled {label = TokSpan 1310 1310, unLabel = Var (Labeled {label = TokSpan 1310 1310, unLabel = Ident {unIdent = "seq1"}})}]]})})]},Labeled {label = TokSpan 1312 1312, unLabel = FunBind (Labeled {label = TokSpan 1312 1312, unLabel = Ident {unIdent = "TransportReceiver"}}) [FunCase [[Labeled {label = TokSpan 1314 1314, unLabel = VarPat (Labeled {label = TokSpan 1314 1314, unLabel = Ident {unIdent = "taddr"}})}]] (Labeled {label = TokSpan 1317 1391, unLabel = Let [Labeled {label = TokSpan 1318 1323, unLabel = PatBind (Labeled {label = TokSpan 1318 1318, unLabel = VarPat (Labeled {label = TokSpan 1318 1318, unLabel = Ident {unIdent = "h"}})}) (Labeled {label = TokSpan 1320 1323, unLabel = CallFunction (Labeled {label = TokSpan 1320 1320, unLabel = Var (Labeled {label = TokSpan 1320 1320, unLabel = Ident {unIdent = "hostof"}})}) [[Labeled {label = TokSpan 1322 1322, unLabel = Var (Labeled {label = TokSpan 1322 1322, unLabel = Ident {unIdent = "taddr"}})}]]})},Labeled {label = TokSpan 1324 1324, unLabel = FunBind (Labeled {label = TokSpan 1324 1324, unLabel = Ident {unIdent = "TR"}}) [FunCase [[Labeled {label = TokSpan 1326 1326, unLabel = VarPat (Labeled {label = TokSpan 1326 1326, unLabel = Ident {unIdent = "seq"}})}]] (Labeled {label = TokPos 1346, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1329 1345, unLabel = PrefixExp (Labeled {label = TokSpan 1329 1329, unLabel = Var (Labeled {label = TokSpan 1329 1329, unLabel = Ident {unIdent = "packet"}})}) [Labeled {label = TokSpan 1330 1331, unLabel = OutComm (Labeled {label = TokSpan 1331 1331, unLabel = Var (Labeled {label = TokSpan 1331 1331, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1332 1333, unLabel = OutComm (Labeled {label = TokSpan 1333 1333, unLabel = Var (Labeled {label = TokSpan 1333 1333, unLabel = Ident {unIdent = "Reverse"}})})},Labeled {label = TokSpan 1334 1335, unLabel = OutComm (Labeled {label = TokSpan 1335 1335, unLabel = Var (Labeled {label = TokSpan 1335 1335, unLabel = Ident {unIdent = "TAck"}})})},Labeled {label = TokSpan 1336 1340, unLabel = OutComm (Labeled {label = TokSpan 1337 1340, unLabel = CallFunction (Labeled {label = TokSpan 1337 1337, unLabel = Var (Labeled {label = TokSpan 1337 1337, unLabel = Ident {unIdent = "seq_next"}})}) [[Labeled {label = TokSpan 1339 1339, unLabel = Var (Labeled {label = TokSpan 1339 1339, unLabel = Ident {unIdent = "seq"}})}]]})}] (Labeled {label = TokSpan 1342 1345, unLabel = CallFunction (Labeled {label = TokSpan 1342 1342, unLabel = Var (Labeled {label = TokSpan 1342 1342, unLabel = Ident {unIdent = "TR"}})}) [[Labeled {label = TokSpan 1344 1344, unLabel = Var (Labeled {label = TokSpan 1344 1344, unLabel = Ident {unIdent = "seq"}})}]]})}) (Labeled {label = TokSpan 1347 1386, unLabel = PrefixExp (Labeled {label = TokSpan 1347 1347, unLabel = Var (Labeled {label = TokSpan 1347 1347, unLabel = Ident {unIdent = "packet"}})}) [Labeled {label = TokSpan 1348 1349, unLabel = OutComm (Labeled {label = TokSpan 1349 1349, unLabel = Var (Labeled {label = TokSpan 1349 1349, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1350 1351, unLabel = OutComm (Labeled {label = TokSpan 1351 1351, unLabel = Var (Labeled {label = TokSpan 1351 1351, unLabel = Ident {unIdent = "Forward"}})})},Labeled {label = TokSpan 1352 1353, unLabel = OutComm (Labeled {label = TokSpan 1353 1353, unLabel = Var (Labeled {label = TokSpan 1353 1353, unLabel = Ident {unIdent = "TData"}})})},Labeled {label = TokSpan 1354 1355, unLabel = InComm (Labeled {label = TokSpan 1355 1355, unLabel = VarPat (Labeled {label = TokSpan 1355 1355, unLabel = Ident {unIdent = "s"}})})},Labeled {label = TokSpan 1356 1362, unLabel = InCommGuarded (Labeled {label = TokSpan 1357 1357, unLabel = VarPat (Labeled {label = TokSpan 1357 1357, unLabel = Ident {unIdent = "v"}})}) (Labeled {label = TokSpan 1359 1362, unLabel = CallFunction (Labeled {label = TokSpan 1359 1359, unLabel = Var (Labeled {label = TokSpan 1359 1359, unLabel = Ident {unIdent = "Transport_Data_Recd"}})}) [[Labeled {label = TokSpan 1361 1361, unLabel = Var (Labeled {label = TokSpan 1361 1361, unLabel = Ident {unIdent = "h"}})}]]})}] (Labeled {label = TokSpan 1364 1386, unLabel = Ifte (Labeled {label = TokPos 1366, unLabel = Fun2 "==" (Labeled {label = TokSpan 1365 1365, unLabel = Var (Labeled {label = TokSpan 1365 1365, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1367 1367, unLabel = Var (Labeled {label = TokSpan 1367 1367, unLabel = Ident {unIdent = "seq"}})})}) (Labeled {label = TokSpan 1369 1381, unLabel = PrefixExp (Labeled {label = TokSpan 1369 1369, unLabel = Var (Labeled {label = TokSpan 1369 1369, unLabel = Ident {unIdent = "transport"}})}) [Labeled {label = TokSpan 1370 1371, unLabel = OutComm (Labeled {label = TokSpan 1371 1371, unLabel = Var (Labeled {label = TokSpan 1371 1371, unLabel = Ident {unIdent = "taddr"}})})},Labeled {label = TokSpan 1372 1373, unLabel = OutComm (Labeled {label = TokSpan 1373 1373, unLabel = Var (Labeled {label = TokSpan 1373 1373, unLabel = Ident {unIdent = "v"}})})}] (Labeled {label = TokSpan 1375 1381, unLabel = CallFunction (Labeled {label = TokSpan 1375 1375, unLabel = Var (Labeled {label = TokSpan 1375 1375, unLabel = Ident {unIdent = "TR"}})}) [[Labeled {label = TokSpan 1377 1380, unLabel = CallFunction (Labeled {label = TokSpan 1377 1377, unLabel = Var (Labeled {label = TokSpan 1377 1377, unLabel = Ident {unIdent = "seq_next"}})}) [[Labeled {label = TokSpan 1379 1379, unLabel = Var (Labeled {label = TokSpan 1379 1379, unLabel = Ident {unIdent = "seq"}})}]]}]]})}) (Labeled {label = TokSpan 1383 1386, unLabel = CallFunction (Labeled {label = TokSpan 1383 1383, unLabel = Var (Labeled {label = TokSpan 1383 1383, unLabel = Ident {unIdent = "TR"}})}) [[Labeled {label = TokSpan 1385 1385, unLabel = Var (Labeled {label = TokSpan 1385 1385, unLabel = Ident {unIdent = "seq"}})}]]})})})})]}] (Labeled {label = TokSpan 1388 1391, unLabel = CallFunction (Labeled {label = TokSpan 1388 1388, unLabel = Var (Labeled {label = TokSpan 1388 1388, unLabel = Ident {unIdent = "TR"}})}) [[Labeled {label = TokSpan 1390 1390, unLabel = Var (Labeled {label = TokSpan 1390 1390, unLabel = Ident {unIdent = "seq0"}})}]]})})]},Labeled {label = TokSpan 1392 1392, unLabel = FunBind (Labeled {label = TokSpan 1392 1392, unLabel = Ident {unIdent = "SenderInterface"}}) [FunCase [[Labeled {label = TokSpan 1394 1394, unLabel = VarPat (Labeled {label = TokSpan 1394 1394, unLabel = Ident {unIdent = "h"}})}]] (Labeled {label = TokSpan 1397 1424, unLabel = ClosureComprehension ([Labeled {label = TokSpan 1398 1406, unLabel = DotTuple [Labeled {label = TokSpan 1398 1398, unLabel = Var (Labeled {label = TokSpan 1398 1398, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1400 1400, unLabel = Var (Labeled {label = TokSpan 1400 1400, unLabel = Ident {unIdent = "h"}})},Labeled {label = TokSpan 1402 1402, unLabel = Var (Labeled {label = TokSpan 1402 1402, unLabel = Ident {unIdent = "Outbound"}})},Labeled {label = TokSpan 1404 1404, unLabel = Var (Labeled {label = TokSpan 1404 1404, unLabel = Ident {unIdent = "Forward"}})},Labeled {label = TokSpan 1406 1406, unLabel = Var (Labeled {label = TokSpan 1406 1406, unLabel = Ident {unIdent = "d"}})}]},Labeled {label = TokSpan 1408 1416, unLabel = DotTuple [Labeled {label = TokSpan 1408 1408, unLabel = Var (Labeled {label = TokSpan 1408 1408, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1410 1410, unLabel = Var (Labeled {label = TokSpan 1410 1410, unLabel = Ident {unIdent = "h"}})},Labeled {label = TokSpan 1412 1412, unLabel = Var (Labeled {label = TokSpan 1412 1412, unLabel = Ident {unIdent = "Outbound"}})},Labeled {label = TokSpan 1414 1414, unLabel = Var (Labeled {label = TokSpan 1414 1414, unLabel = Ident {unIdent = "Reverse"}})},Labeled {label = TokSpan 1416 1416, unLabel = Var (Labeled {label = TokSpan 1416 1416, unLabel = Ident {unIdent = "TAck"}})}]}],[Labeled {label = TokSpan 1418 1423, unLabel = Generator (Labeled {label = TokSpan 1418 1418, unLabel = VarPat (Labeled {label = TokSpan 1418 1418, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1420 1423, unLabel = CallFunction (Labeled {label = TokSpan 1420 1420, unLabel = Var (Labeled {label = TokSpan 1420 1420, unLabel = Ident {unIdent = "Packet_Data_Sent"}})}) [[Labeled {label = TokSpan 1422 1422, unLabel = Var (Labeled {label = TokSpan 1422 1422, unLabel = Ident {unIdent = "h"}})}]]})}])})]},Labeled {label = TokSpan 1425 1425, unLabel = FunBind (Labeled {label = TokSpan 1425 1425, unLabel = Ident {unIdent = "ReceiverInterface"}}) [FunCase [[Labeled {label = TokSpan 1427 1427, unLabel = VarPat (Labeled {label = TokSpan 1427 1427, unLabel = Ident {unIdent = "h"}})}]] (Labeled {label = TokSpan 1430 1457, unLabel = ClosureComprehension ([Labeled {label = TokSpan 1431 1439, unLabel = DotTuple [Labeled {label = TokSpan 1431 1431, unLabel = Var (Labeled {label = TokSpan 1431 1431, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1433 1433, unLabel = Var (Labeled {label = TokSpan 1433 1433, unLabel = Ident {unIdent = "h"}})},Labeled {label = TokSpan 1435 1435, unLabel = Var (Labeled {label = TokSpan 1435 1435, unLabel = Ident {unIdent = "Inbound"}})},Labeled {label = TokSpan 1437 1437, unLabel = Var (Labeled {label = TokSpan 1437 1437, unLabel = Ident {unIdent = "Forward"}})},Labeled {label = TokSpan 1439 1439, unLabel = Var (Labeled {label = TokSpan 1439 1439, unLabel = Ident {unIdent = "d"}})}]},Labeled {label = TokSpan 1441 1449, unLabel = DotTuple [Labeled {label = TokSpan 1441 1441, unLabel = Var (Labeled {label = TokSpan 1441 1441, unLabel = Ident {unIdent = "packet"}})},Labeled {label = TokSpan 1443 1443, unLabel = Var (Labeled {label = TokSpan 1443 1443, unLabel = Ident {unIdent = "h"}})},Labeled {label = TokSpan 1445 1445, unLabel = Var (Labeled {label = TokSpan 1445 1445, unLabel = Ident {unIdent = "Inbound"}})},Labeled {label = TokSpan 1447 1447, unLabel = Var (Labeled {label = TokSpan 1447 1447, unLabel = Ident {unIdent = "Reverse"}})},Labeled {label = TokSpan 1449 1449, unLabel = Var (Labeled {label = TokSpan 1449 1449, unLabel = Ident {unIdent = "TAck"}})}]}],[Labeled {label = TokSpan 1451 1456, unLabel = Generator (Labeled {label = TokSpan 1451 1451, unLabel = VarPat (Labeled {label = TokSpan 1451 1451, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1453 1456, unLabel = CallFunction (Labeled {label = TokSpan 1453 1453, unLabel = Var (Labeled {label = TokSpan 1453 1453, unLabel = Ident {unIdent = "Packet_Data_Recd"}})}) [[Labeled {label = TokSpan 1455 1455, unLabel = Var (Labeled {label = TokSpan 1455 1455, unLabel = Ident {unIdent = "h"}})}]]})}])})]},Labeled {label = TokSpan 1458 1541, unLabel = PatBind (Labeled {label = TokSpan 1458 1458, unLabel = VarPat (Labeled {label = TokSpan 1458 1458, unLabel = Ident {unIdent = "TransportLayer"}})}) (Labeled {label = TokSpan 1460 1541, unLabel = Let [Labeled {label = TokSpan 1461 1461, unLabel = FunBind (Labeled {label = TokSpan 1461 1461, unLabel = Ident {unIdent = "Trans"}}) [FunCase [[Labeled {label = TokSpan 1463 1463, unLabel = VarPat (Labeled {label = TokSpan 1463 1463, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1465 1465, unLabel = VarPat (Labeled {label = TokSpan 1465 1465, unLabel = Ident {unIdent = "d"}})}]] (Labeled {label = TokSpan 1468 1518, unLabel = Let [Labeled {label = TokSpan 1469 1474, unLabel = PatBind (Labeled {label = TokSpan 1469 1469, unLabel = VarPat (Labeled {label = TokSpan 1469 1469, unLabel = Ident {unIdent = "si"}})}) (Labeled {label = TokSpan 1471 1474, unLabel = CallFunction (Labeled {label = TokSpan 1471 1471, unLabel = Var (Labeled {label = TokSpan 1471 1471, unLabel = Ident {unIdent = "SenderInterface"}})}) [[Labeled {label = TokSpan 1473 1473, unLabel = Var (Labeled {label = TokSpan 1473 1473, unLabel = Ident {unIdent = "s"}})}]]})},Labeled {label = TokSpan 1475 1480, unLabel = PatBind (Labeled {label = TokSpan 1475 1475, unLabel = VarPat (Labeled {label = TokSpan 1475 1475, unLabel = Ident {unIdent = "ri"}})}) (Labeled {label = TokSpan 1477 1480, unLabel = CallFunction (Labeled {label = TokSpan 1477 1477, unLabel = Var (Labeled {label = TokSpan 1477 1477, unLabel = Ident {unIdent = "ReceiverInterface"}})}) [[Labeled {label = TokSpan 1479 1479, unLabel = Var (Labeled {label = TokSpan 1479 1479, unLabel = Ident {unIdent = "d"}})}]]})},Labeled {label = TokSpan 1481 1495, unLabel = PatBind (Labeled {label = TokSpan 1481 1481, unLabel = VarPat (Labeled {label = TokSpan 1481 1481, unLabel = Ident {unIdent = "sr"}})}) (Labeled {label = TokPos 1489, unLabel = Fun2 "|||" (Labeled {label = TokSpan 1483 1488, unLabel = CallFunction (Labeled {label = TokSpan 1483 1483, unLabel = Var (Labeled {label = TokSpan 1483 1483, unLabel = Ident {unIdent = "TransportSender"}})}) [[Labeled {label = TokSpan 1485 1487, unLabel = DotTuple [Labeled {label = TokSpan 1485 1485, unLabel = Var (Labeled {label = TokSpan 1485 1485, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1487 1487, unLabel = Var (Labeled {label = TokSpan 1487 1487, unLabel = Ident {unIdent = "Outbound"}})}]}]]}) (Labeled {label = TokSpan 1490 1495, unLabel = CallFunction (Labeled {label = TokSpan 1490 1490, unLabel = Var (Labeled {label = TokSpan 1490 1490, unLabel = Ident {unIdent = "TransportReceiver"}})}) [[Labeled {label = TokSpan 1492 1494, unLabel = DotTuple [Labeled {label = TokSpan 1492 1492, unLabel = Var (Labeled {label = TokSpan 1492 1492, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1494 1494, unLabel = Var (Labeled {label = TokSpan 1494 1494, unLabel = Ident {unIdent = "Inbound"}})}]}]]})})}] (Labeled {label = TokSpan 1497 1518, unLabel = CallFunction (Labeled {label = TokSpan 1497 1497, unLabel = Var (Labeled {label = TokSpan 1497 1497, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1499 1499, unLabel = Var (Labeled {label = TokSpan 1499 1499, unLabel = Ident {unIdent = "sr"}})},Labeled {label = TokSpan 1501 1506, unLabel = CallBuiltIn (Labeled {label = TokSpan 1501 1501, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 1503 1503, unLabel = Var (Labeled {label = TokSpan 1503 1503, unLabel = Ident {unIdent = "si"}})},Labeled {label = TokSpan 1505 1505, unLabel = Var (Labeled {label = TokSpan 1505 1505, unLabel = Ident {unIdent = "ri"}})}]]},Labeled {label = TokSpan 1508 1517, unLabel = CallFunction (Labeled {label = TokSpan 1508 1508, unLabel = Var (Labeled {label = TokSpan 1508 1508, unLabel = Ident {unIdent = "PacketPair"}})}) [[Labeled {label = TokSpan 1510 1512, unLabel = DotTuple [Labeled {label = TokSpan 1510 1510, unLabel = Var (Labeled {label = TokSpan 1510 1510, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1512 1512, unLabel = Var (Labeled {label = TokSpan 1512 1512, unLabel = Ident {unIdent = "Outbound"}})}]},Labeled {label = TokSpan 1514 1516, unLabel = DotTuple [Labeled {label = TokSpan 1514 1514, unLabel = Var (Labeled {label = TokSpan 1514 1514, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1516 1516, unLabel = Var (Labeled {label = TokSpan 1516 1516, unLabel = Ident {unIdent = "Inbound"}})}]}]]}]]})})]}] (Labeled {label = TokSpan 1520 1541, unLabel = ProcRepInterleave [Labeled {label = TokSpan 1521 1523, unLabel = Generator (Labeled {label = TokSpan 1521 1521, unLabel = VarPat (Labeled {label = TokSpan 1521 1521, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1523 1523, unLabel = Var (Labeled {label = TokSpan 1523 1523, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1525 1527, unLabel = Generator (Labeled {label = TokSpan 1525 1525, unLabel = VarPat (Labeled {label = TokSpan 1525 1525, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1527 1527, unLabel = Var (Labeled {label = TokSpan 1527 1527, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1529 1531, unLabel = Guard (Labeled {label = TokPos 1530, unLabel = Fun2 "!=" (Labeled {label = TokSpan 1529 1529, unLabel = Var (Labeled {label = TokSpan 1529 1529, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1531 1531, unLabel = Var (Labeled {label = TokSpan 1531 1531, unLabel = Ident {unIdent = "d"}})})})}] (Labeled {label = TokSpan 1533 1541, unLabel = CallFunction (Labeled {label = TokSpan 1533 1533, unLabel = Var (Labeled {label = TokSpan 1533 1533, unLabel = Ident {unIdent = "normal"}})}) [[Labeled {label = TokSpan 1535 1540, unLabel = CallFunction (Labeled {label = TokSpan 1535 1535, unLabel = Var (Labeled {label = TokSpan 1535 1535, unLabel = Ident {unIdent = "Trans"}})}) [[Labeled {label = TokSpan 1537 1537, unLabel = Var (Labeled {label = TokSpan 1537 1537, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1539 1539, unLabel = Var (Labeled {label = TokSpan 1539 1539, unLabel = Ident {unIdent = "d"}})}]]}]]})})})},Labeled {label = TokSpan 1542 1545, unLabel = AssertRef (Labeled {label = TokSpan 1543 1543, unLabel = Var (Labeled {label = TokSpan 1543 1543, unLabel = Ident {unIdent = "TransportService"}})}) "[F=" (Labeled {label = TokSpan 1545 1545, unLabel = Var (Labeled {label = TokSpan 1545 1545, unLabel = Ident {unIdent = "TransportLayer"}})})},Labeled {label = TokSpan 1546 1557, unLabel = PatBind (Labeled {label = TokSpan 1546 1546, unLabel = VarPat (Labeled {label = TokSpan 1546 1546, unLabel = Ident {unIdent = "NetworkLayer2"}})}) (Labeled {label = TokSpan 1548 1557, unLabel = CallFunction (Labeled {label = TokSpan 1548 1548, unLabel = Var (Labeled {label = TokSpan 1548 1548, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1550 1550, unLabel = Var (Labeled {label = TokSpan 1550 1550, unLabel = Ident {unIdent = "NetImp"}})},Labeled {label = TokSpan 1552 1554, unLabel = Closure [Labeled {label = TokSpan 1553 1553, unLabel = Var (Labeled {label = TokSpan 1553 1553, unLabel = Ident {unIdent = "transport"}})}]},Labeled {label = TokSpan 1556 1556, unLabel = Var (Labeled {label = TokSpan 1556 1556, unLabel = Ident {unIdent = "TransportLayer"}})}]]})},Labeled {label = TokSpan 1559 1570, unLabel = PatBind (Labeled {label = TokSpan 1559 1559, unLabel = VarPat (Labeled {label = TokSpan 1559 1559, unLabel = Ident {unIdent = "ConnectionLayer3"}})}) (Labeled {label = TokSpan 1561 1570, unLabel = CallFunction (Labeled {label = TokSpan 1561 1561, unLabel = Var (Labeled {label = TokSpan 1561 1561, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1563 1563, unLabel = Var (Labeled {label = TokSpan 1563 1563, unLabel = Ident {unIdent = "ConImp"}})},Labeled {label = TokSpan 1565 1567, unLabel = Closure [Labeled {label = TokSpan 1566 1566, unLabel = Var (Labeled {label = TokSpan 1566 1566, unLabel = Ident {unIdent = "network"}})}]},Labeled {label = TokSpan 1569 1569, unLabel = Var (Labeled {label = TokSpan 1569 1569, unLabel = Ident {unIdent = "NetworkLayer2"}})}]]})},Labeled {label = TokSpan 1571 1574, unLabel = AssertRef (Labeled {label = TokSpan 1572 1572, unLabel = Var (Labeled {label = TokSpan 1572 1572, unLabel = Ident {unIdent = "ConnectionService"}})}) "[F=" (Labeled {label = TokSpan 1574 1574, unLabel = Var (Labeled {label = TokSpan 1574 1574, unLabel = Ident {unIdent = "ConnectionLayer3"}})})},Labeled {label = TokSpan 1576 1645, unLabel = PatBind (Labeled {label = TokSpan 1576 1576, unLabel = VarPat (Labeled {label = TokSpan 1576 1576, unLabel = Ident {unIdent = "FaultyConnectionLayer"}})}) (Labeled {label = TokSpan 1578 1645, unLabel = Let [Labeled {label = TokSpan 1579 1622, unLabel = PatBind (Labeled {label = TokSpan 1579 1579, unLabel = VarPat (Labeled {label = TokSpan 1579 1579, unLabel = Ident {unIdent = "FaultyTransportService"}})}) (Labeled {label = TokSpan 1581 1622, unLabel = ProcRepInterleave [Labeled {label = TokSpan 1582 1584, unLabel = Generator (Labeled {label = TokSpan 1582 1582, unLabel = VarPat (Labeled {label = TokSpan 1582 1582, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1584 1584, unLabel = Var (Labeled {label = TokSpan 1584 1584, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1586 1588, unLabel = Generator (Labeled {label = TokSpan 1586 1586, unLabel = VarPat (Labeled {label = TokSpan 1586 1586, unLabel = Ident {unIdent = "d"}})}) (Labeled {label = TokSpan 1588 1588, unLabel = Var (Labeled {label = TokSpan 1588 1588, unLabel = Ident {unIdent = "Host"}})})},Labeled {label = TokSpan 1590 1592, unLabel = Guard (Labeled {label = TokPos 1591, unLabel = Fun2 "!=" (Labeled {label = TokSpan 1590 1590, unLabel = Var (Labeled {label = TokSpan 1590 1590, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 1592 1592, unLabel = Var (Labeled {label = TokSpan 1592 1592, unLabel = Ident {unIdent = "d"}})})})}] (Labeled {label = TokSpan 1594 1622, unLabel = CallFunction (Labeled {label = TokSpan 1594 1594, unLabel = Var (Labeled {label = TokSpan 1594 1594, unLabel = Ident {unIdent = "FAULTY"}})}) [[Labeled {label = TokSpan 1596 1596, unLabel = IntExp 1},Labeled {label = TokSpan 1598 1602, unLabel = DotTuple [Labeled {label = TokSpan 1598 1598, unLabel = Var (Labeled {label = TokSpan 1598 1598, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 1600 1600, unLabel = Var (Labeled {label = TokSpan 1600 1600, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 1602 1602, unLabel = Var (Labeled {label = TokSpan 1602 1602, unLabel = Ident {unIdent = "Outbound"}})}]},Labeled {label = TokSpan 1604 1608, unLabel = DotTuple [Labeled {label = TokSpan 1604 1604, unLabel = Var (Labeled {label = TokSpan 1604 1604, unLabel = Ident {unIdent = "transport"}})},Labeled {label = TokSpan 1606 1606, unLabel = Var (Labeled {label = TokSpan 1606 1606, unLabel = Ident {unIdent = "d"}})},Labeled {label = TokSpan 1608 1608, unLabel = Var (Labeled {label = TokSpan 1608 1608, unLabel = Ident {unIdent = "Inbound"}})}]},Labeled {label = TokSpan 1610 1621, unLabel = CallBuiltIn (Labeled {label = TokSpan 1610 1610, unLabel = BuiltIn "inter"}) [[Labeled {label = TokSpan 1612 1615, unLabel = CallFunction (Labeled {label = TokSpan 1612 1612, unLabel = Var (Labeled {label = TokSpan 1612 1612, unLabel = Ident {unIdent = "Transport_Data_Sent"}})}) [[Labeled {label = TokSpan 1614 1614, unLabel = Var (Labeled {label = TokSpan 1614 1614, unLabel = Ident {unIdent = "s"}})}]]},Labeled {label = TokSpan 1617 1620, unLabel = CallFunction (Labeled {label = TokSpan 1617 1617, unLabel = Var (Labeled {label = TokSpan 1617 1617, unLabel = Ident {unIdent = "Transport_Data_Recd"}})}) [[Labeled {label = TokSpan 1619 1619, unLabel = Var (Labeled {label = TokSpan 1619 1619, unLabel = Ident {unIdent = "d"}})}]]}]]}]]})})},Labeled {label = TokSpan 1623 1634, unLabel = PatBind (Labeled {label = TokSpan 1623 1623, unLabel = VarPat (Labeled {label = TokSpan 1623 1623, unLabel = Ident {unIdent = "FaultyNetworkLayer"}})}) (Labeled {label = TokSpan 1625 1634, unLabel = CallFunction (Labeled {label = TokSpan 1625 1625, unLabel = Var (Labeled {label = TokSpan 1625 1625, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1627 1627, unLabel = Var (Labeled {label = TokSpan 1627 1627, unLabel = Ident {unIdent = "NetImp"}})},Labeled {label = TokSpan 1629 1631, unLabel = Closure [Labeled {label = TokSpan 1630 1630, unLabel = Var (Labeled {label = TokSpan 1630 1630, unLabel = Ident {unIdent = "transport"}})}]},Labeled {label = TokSpan 1633 1633, unLabel = Var (Labeled {label = TokSpan 1633 1633, unLabel = Ident {unIdent = "FaultyTransportService"}})}]]})}] (Labeled {label = TokSpan 1636 1645, unLabel = CallFunction (Labeled {label = TokSpan 1636 1636, unLabel = Var (Labeled {label = TokSpan 1636 1636, unLabel = Ident {unIdent = "wire"}})}) [[Labeled {label = TokSpan 1638 1638, unLabel = Var (Labeled {label = TokSpan 1638 1638, unLabel = Ident {unIdent = "ConImp"}})},Labeled {label = TokSpan 1640 1642, unLabel = Closure [Labeled {label = TokSpan 1641 1641, unLabel = Var (Labeled {label = TokSpan 1641 1641, unLabel = Ident {unIdent = "network"}})}]},Labeled {label = TokSpan 1644 1644, unLabel = Var (Labeled {label = TokSpan 1644 1644, unLabel = Ident {unIdent = "FaultyNetworkLayer"}})}]]})})},Labeled {label = TokSpan 1646 1649, unLabel = AssertRef (Labeled {label = TokSpan 1647 1647, unLabel = Var (Labeled {label = TokSpan 1647 1647, unLabel = Ident {unIdent = "ConnectionService"}})}) "[F=" (Labeled {label = TokSpan 1649 1649, unLabel = Var (Labeled {label = TokSpan 1649 1649, unLabel = Ident {unIdent = "FaultyConnectionLayer"}})})}]}
