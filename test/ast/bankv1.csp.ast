Labeled {label = TokSpan 2 633, unLabel = Module [Labeled {label = TokSpan 2 8, unLabel = PatBind (Labeled {label = TokSpan 2 2, unLabel = VarPat (Labeled {label = TokSpan 2 2, unLabel = Ident {unIdent = "QUEUENUM"}})}) (Labeled {label = TokSpan 4 8, unLabel = SetClose (Labeled {label = TokSpan 5 5, unLabel = IntExp 1},Labeled {label = TokSpan 7 7, unLabel = IntExp 3})})},Labeled {label = TokSpan 9 16, unLabel = DataType (Labeled {label = TokSpan 10 10, unLabel = Ident {unIdent = "CUSTOMER"}}) [Labeled {label = TokSpan 12 12, unLabel = Constructor (Labeled {label = TokSpan 12 12, unLabel = Ident {unIdent = "c1"}}) Nothing},Labeled {label = TokSpan 14 14, unLabel = Constructor (Labeled {label = TokSpan 14 14, unLabel = Ident {unIdent = "c2"}}) Nothing},Labeled {label = TokSpan 16 16, unLabel = Constructor (Labeled {label = TokSpan 16 16, unLabel = Ident {unIdent = "c3"}}) Nothing}]},Labeled {label = TokSpan 17 22, unLabel = DataType (Labeled {label = TokSpan 18 18, unLabel = Ident {unIdent = "STATUS"}}) [Labeled {label = TokSpan 20 20, unLabel = Constructor (Labeled {label = TokSpan 20 20, unLabel = Ident {unIdent = "success"}}) Nothing},Labeled {label = TokSpan 22 22, unLabel = Constructor (Labeled {label = TokSpan 22 22, unLabel = Ident {unIdent = "fail"}}) Nothing}]},Labeled {label = TokSpan 23 28, unLabel = DataType (Labeled {label = TokSpan 24 24, unLabel = Ident {unIdent = "QSTATUS"}}) [Labeled {label = TokSpan 26 26, unLabel = Constructor (Labeled {label = TokSpan 26 26, unLabel = Ident {unIdent = "yes"}}) Nothing},Labeled {label = TokSpan 28 28, unLabel = Constructor (Labeled {label = TokSpan 28 28, unLabel = Ident {unIdent = "no"}}) Nothing}]},Labeled {label = TokSpan 29 31, unLabel = PatBind (Labeled {label = TokSpan 29 29, unLabel = VarPat (Labeled {label = TokSpan 29 29, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 31 31, unLabel = IntExp 2})},Labeled {label = TokSpan 32 34, unLabel = PatBind (Labeled {label = TokSpan 32 32, unLabel = VarPat (Labeled {label = TokSpan 32 32, unLabel = Ident {unIdent = "defaultCounter"}})}) (Labeled {label = TokSpan 34 34, unLabel = IntExp 1})},Labeled {label = TokSpan 35 37, unLabel = PatBind (Labeled {label = TokSpan 35 35, unLabel = VarPat (Labeled {label = TokSpan 35 35, unLabel = Ident {unIdent = "defaultCustomer"}})}) (Labeled {label = TokSpan 37 37, unLabel = Var (Labeled {label = TokSpan 37 37, unLabel = Ident {unIdent = "c1"}})})},Labeled {label = TokSpan 38 42, unLabel = PatBind (Labeled {label = TokSpan 38 38, unLabel = VarPat (Labeled {label = TokSpan 38 38, unLabel = Ident {unIdent = "maxQueueingCustomers"}})}) (Labeled {label = TokPos 41, unLabel = Fun2 "-" (Labeled {label = TokSpan 40 40, unLabel = Var (Labeled {label = TokSpan 40 40, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 42 42, unLabel = IntExp 1})})},Labeled {label = TokSpan 43 45, unLabel = PatBind (Labeled {label = TokSpan 43 43, unLabel = VarPat (Labeled {label = TokSpan 43 43, unLabel = Ident {unIdent = "numQueues"}})}) (Labeled {label = TokSpan 45 45, unLabel = IntExp 2})},Labeled {label = TokSpan 47 50, unLabel = Channel [Labeled {label = TokSpan 48 48, unLabel = Ident {unIdent = "enterBank"}}] (Just (Labeled {label = TokSpan 50 50, unLabel = TypeDot [Labeled {label = TokSpan 50 50, unLabel = Var (Labeled {label = TokSpan 50 50, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 51 54, unLabel = Channel [Labeled {label = TokSpan 52 52, unLabel = Ident {unIdent = "leaveBank"}}] (Just (Labeled {label = TokSpan 54 54, unLabel = TypeDot [Labeled {label = TokSpan 54 54, unLabel = Var (Labeled {label = TokSpan 54 54, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 55 58, unLabel = Channel [Labeled {label = TokSpan 56 56, unLabel = Ident {unIdent = "report"}}] (Just (Labeled {label = TokSpan 58 58, unLabel = TypeDot [Labeled {label = TokSpan 58 58, unLabel = Var (Labeled {label = TokSpan 58 58, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 60 63, unLabel = Channel [Labeled {label = TokSpan 61 61, unLabel = Ident {unIdent = "com1"}}] (Just (Labeled {label = TokSpan 63 63, unLabel = TypeDot [Labeled {label = TokSpan 63 63, unLabel = Var (Labeled {label = TokSpan 63 63, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 64 67, unLabel = Channel [Labeled {label = TokSpan 65 65, unLabel = Ident {unIdent = "com2"}}] (Just (Labeled {label = TokSpan 67 67, unLabel = TypeDot [Labeled {label = TokSpan 67 67, unLabel = Var (Labeled {label = TokSpan 67 67, unLabel = Ident {unIdent = "QUEUENUM"}})}]}))},Labeled {label = TokSpan 68 73, unLabel = Channel [Labeled {label = TokSpan 69 69, unLabel = Ident {unIdent = "com3"}}] (Just (Labeled {label = TokSpan 71 73, unLabel = TypeDot [Labeled {label = TokSpan 71 71, unLabel = Var (Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "CUSTOMER"}})},Labeled {label = TokSpan 73 73, unLabel = Var (Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "QUEUENUM"}})}]}))},Labeled {label = TokSpan 74 77, unLabel = Channel [Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "canJoinResponse"}}] (Just (Labeled {label = TokSpan 77 77, unLabel = TypeDot [Labeled {label = TokSpan 77 77, unLabel = Var (Labeled {label = TokSpan 77 77, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 78 79, unLabel = Channel [Labeled {label = TokSpan 79 79, unLabel = Ident {unIdent = "retrieveCustomer"}}] Nothing},Labeled {label = TokSpan 81 84, unLabel = Channel [Labeled {label = TokSpan 82 82, unLabel = Ident {unIdent = "joinQueue"}}] (Just (Labeled {label = TokSpan 84 84, unLabel = TypeDot [Labeled {label = TokSpan 84 84, unLabel = Var (Labeled {label = TokSpan 84 84, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 85 90, unLabel = Channel [Labeled {label = TokSpan 86 86, unLabel = Ident {unIdent = "leaveQueue"}}] (Just (Labeled {label = TokSpan 88 90, unLabel = TypeDot [Labeled {label = TokSpan 88 88, unLabel = Var (Labeled {label = TokSpan 88 88, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 90 90, unLabel = Var (Labeled {label = TokSpan 90 90, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 91 96, unLabel = Channel [Labeled {label = TokSpan 92 92, unLabel = Ident {unIdent = "queryQueueEmpty"}}] (Just (Labeled {label = TokSpan 94 96, unLabel = TypeDot [Labeled {label = TokSpan 94 94, unLabel = Var (Labeled {label = TokSpan 94 94, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 96 96, unLabel = Var (Labeled {label = TokSpan 96 96, unLabel = Ident {unIdent = "QSTATUS"}})}]}))},Labeled {label = TokSpan 97 102, unLabel = Channel [Labeled {label = TokSpan 98 98, unLabel = Ident {unIdent = "queryIsInQueue"}}] (Just (Labeled {label = TokSpan 100 102, unLabel = TypeDot [Labeled {label = TokSpan 100 100, unLabel = Var (Labeled {label = TokSpan 100 100, unLabel = Ident {unIdent = "CUSTOMER"}})},Labeled {label = TokSpan 102 102, unLabel = Var (Labeled {label = TokSpan 102 102, unLabel = Ident {unIdent = "QSTATUS"}})}]}))},Labeled {label = TokSpan 103 106, unLabel = Channel [Labeled {label = TokSpan 104 104, unLabel = Ident {unIdent = "getQueueNo"}}] (Just (Labeled {label = TokSpan 106 106, unLabel = TypeDot [Labeled {label = TokSpan 106 106, unLabel = Var (Labeled {label = TokSpan 106 106, unLabel = Ident {unIdent = "QUEUENUM"}})}]}))},Labeled {label = TokSpan 107 110, unLabel = Channel [Labeled {label = TokSpan 108 108, unLabel = Ident {unIdent = "setNextQueue"}}] (Just (Labeled {label = TokSpan 110 110, unLabel = TypeDot [Labeled {label = TokSpan 110 110, unLabel = Var (Labeled {label = TokSpan 110 110, unLabel = Ident {unIdent = "QUEUENUM"}})}]}))},Labeled {label = TokSpan 111 114, unLabel = Channel [Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "setCustomer"}}] (Just (Labeled {label = TokSpan 114 114, unLabel = TypeDot [Labeled {label = TokSpan 114 114, unLabel = Var (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 115 118, unLabel = Channel [Labeled {label = TokSpan 116 116, unLabel = Ident {unIdent = "getCustomer"}}] (Just (Labeled {label = TokSpan 118 118, unLabel = TypeDot [Labeled {label = TokSpan 118 118, unLabel = Var (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 119 119, unLabel = FunBind (Labeled {label = TokSpan 119 119, unLabel = Ident {unIdent = "inc"}}) [FunCase [[Labeled {label = TokSpan 121 121, unLabel = VarPat (Labeled {label = TokSpan 121 121, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokPos 129, unLabel = Fun2 "+" (Labeled {label = TokSpan 124 128, unLabel = Parens (Labeled {label = TokPos 126, unLabel = Fun2 "%" (Labeled {label = TokSpan 125 125, unLabel = Var (Labeled {label = TokSpan 125 125, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 127 127, unLabel = Var (Labeled {label = TokSpan 127 127, unLabel = Ident {unIdent = "numQueues"}})})})}) (Labeled {label = TokSpan 130 130, unLabel = IntExp 1})})]},Labeled {label = TokSpan 140 145, unLabel = PatBind (Labeled {label = TokSpan 140 140, unLabel = VarPat (Labeled {label = TokSpan 140 140, unLabel = Ident {unIdent = "BankCounterCtrl"}})}) (Labeled {label = TokSpan 142 145, unLabel = CallFunction (Labeled {label = TokSpan 142 142, unLabel = Var (Labeled {label = TokSpan 142 142, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 144 144, unLabel = IntExp 0}]]})},Labeled {label = TokSpan 146 146, unLabel = FunBind (Labeled {label = TokSpan 146 146, unLabel = Ident {unIdent = "CurrentCtrl"}}) [FunCase [[Labeled {label = TokSpan 148 148, unLabel = VarPat (Labeled {label = TokSpan 148 148, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 155, unLabel = Fun2 "[]" (Labeled {label = TokSpan 151 154, unLabel = CallFunction (Labeled {label = TokSpan 151 151, unLabel = Var (Labeled {label = TokSpan 151 151, unLabel = Ident {unIdent = "JoinCtrl"}})}) [[Labeled {label = TokSpan 153 153, unLabel = Var (Labeled {label = TokSpan 153 153, unLabel = Ident {unIdent = "num"}})}]]}) (Labeled {label = TokSpan 156 159, unLabel = CallFunction (Labeled {label = TokSpan 156 156, unLabel = Var (Labeled {label = TokSpan 156 156, unLabel = Ident {unIdent = "LeaveCtrl"}})}) [[Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "num"}})}]]})})]},Labeled {label = TokSpan 163 163, unLabel = FunBind (Labeled {label = TokSpan 163 163, unLabel = Ident {unIdent = "JoinCtrl"}}) [FunCase [[Labeled {label = TokSpan 165 165, unLabel = VarPat (Labeled {label = TokSpan 165 165, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 171, unLabel = Fun2 "&" (Labeled {label = TokPos 169, unLabel = Fun2 "<" (Labeled {label = TokSpan 168 168, unLabel = Var (Labeled {label = TokSpan 168 168, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 170 170, unLabel = Var (Labeled {label = TokSpan 170 170, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 172 256, unLabel = PrefixExp (Labeled {label = TokSpan 172 172, unLabel = Var (Labeled {label = TokSpan 172 172, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 173 174, unLabel = InComm (Labeled {label = TokSpan 174 174, unLabel = VarPat (Labeled {label = TokSpan 174 174, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 176 256, unLabel = Parens (Labeled {label = TokPos 197, unLabel = Fun2 "[]" (Labeled {label = TokSpan 177 196, unLabel = Parens (Labeled {label = TokPos 181, unLabel = Fun2 "&" (Labeled {label = TokPos 179, unLabel = Fun2 "==" (Labeled {label = TokSpan 178 178, unLabel = Var (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 180 180, unLabel = IntExp 0})}) (Labeled {label = TokSpan 182 195, unLabel = PrefixExp (Labeled {label = TokSpan 182 182, unLabel = Var (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 183 184, unLabel = OutComm (Labeled {label = TokSpan 184 184, unLabel = Var (Labeled {label = TokSpan 184 184, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 186 195, unLabel = PrefixExp (Labeled {label = TokSpan 186 186, unLabel = Var (Labeled {label = TokSpan 186 186, unLabel = Ident {unIdent = "setCustomer"}})}) [Labeled {label = TokSpan 187 188, unLabel = OutComm (Labeled {label = TokSpan 188 188, unLabel = Var (Labeled {label = TokSpan 188 188, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 190 195, unLabel = CallFunction (Labeled {label = TokSpan 190 190, unLabel = Var (Labeled {label = TokSpan 190 190, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 193, unLabel = Fun2 "+" (Labeled {label = TokSpan 192 192, unLabel = Var (Labeled {label = TokSpan 192 192, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 194 194, unLabel = IntExp 1})}]]})})})})}) (Labeled {label = TokSpan 198 255, unLabel = Parens (Labeled {label = TokPos 202, unLabel = Fun2 "&" (Labeled {label = TokPos 201, unLabel = Fun2 ">" (Labeled {label = TokSpan 199 199, unLabel = Var (Labeled {label = TokSpan 199 199, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 201 201, unLabel = IntExp 0})}) (Labeled {label = TokSpan 203 254, unLabel = PrefixExp (Labeled {label = TokSpan 203 203, unLabel = Var (Labeled {label = TokSpan 203 203, unLabel = Ident {unIdent = "getCustomer"}})}) [Labeled {label = TokSpan 204 205, unLabel = InComm (Labeled {label = TokSpan 205 205, unLabel = VarPat (Labeled {label = TokSpan 205 205, unLabel = Ident {unIdent = "currentCust"}})})}] (Labeled {label = TokSpan 207 254, unLabel = Ifte (Labeled {label = TokSpan 208 212, unLabel = Parens (Labeled {label = TokPos 210, unLabel = Fun2 "==" (Labeled {label = TokSpan 209 209, unLabel = Var (Labeled {label = TokSpan 209 209, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 211 211, unLabel = Var (Labeled {label = TokSpan 211 211, unLabel = Ident {unIdent = "currentCust"}})})})}) (Labeled {label = TokSpan 214 221, unLabel = PrefixExp (Labeled {label = TokSpan 214 214, unLabel = Var (Labeled {label = TokSpan 214 214, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 215 216, unLabel = OutComm (Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 218 221, unLabel = CallFunction (Labeled {label = TokSpan 218 218, unLabel = Var (Labeled {label = TokSpan 218 218, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 220 220, unLabel = Var (Labeled {label = TokSpan 220 220, unLabel = Ident {unIdent = "num"}})}]]})}) (Labeled {label = TokSpan 223 254, unLabel = PrefixExp (Labeled {label = TokSpan 223 223, unLabel = Var (Labeled {label = TokSpan 223 223, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 224 225, unLabel = OutComm (Labeled {label = TokSpan 225 225, unLabel = Var (Labeled {label = TokSpan 225 225, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 227 254, unLabel = PrefixExp (Labeled {label = TokSpan 227 227, unLabel = Var (Labeled {label = TokSpan 227 227, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 228 229, unLabel = InComm (Labeled {label = TokSpan 229 229, unLabel = VarPat (Labeled {label = TokSpan 229 229, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 231 254, unLabel = PrefixExp (Labeled {label = TokSpan 231 231, unLabel = Var (Labeled {label = TokSpan 231 231, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 232 233, unLabel = OutComm (Labeled {label = TokSpan 233 233, unLabel = Var (Labeled {label = TokSpan 233 233, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 235 254, unLabel = Parens (Labeled {label = TokSpan 236 253, unLabel = Ifte (Labeled {label = TokSpan 237 241, unLabel = Parens (Labeled {label = TokPos 239, unLabel = Fun2 "==" (Labeled {label = TokSpan 238 238, unLabel = Var (Labeled {label = TokSpan 238 238, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 240 240, unLabel = Var (Labeled {label = TokSpan 240 240, unLabel = Ident {unIdent = "success"}})})})}) (Labeled {label = TokSpan 243 248, unLabel = CallFunction (Labeled {label = TokSpan 243 243, unLabel = Var (Labeled {label = TokSpan 243 243, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 246, unLabel = Fun2 "+" (Labeled {label = TokSpan 245 245, unLabel = Var (Labeled {label = TokSpan 245 245, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 247 247, unLabel = IntExp 1})}]]}) (Labeled {label = TokSpan 250 253, unLabel = CallFunction (Labeled {label = TokSpan 250 250, unLabel = Var (Labeled {label = TokSpan 250 250, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 252 252, unLabel = Var (Labeled {label = TokSpan 252 252, unLabel = Ident {unIdent = "num"}})}]]})})})})})})})})})})})})})})]},Labeled {label = TokSpan 266 266, unLabel = FunBind (Labeled {label = TokSpan 266 266, unLabel = Ident {unIdent = "LeaveCtrl"}}) [FunCase [[Labeled {label = TokSpan 268 268, unLabel = VarPat (Labeled {label = TokSpan 268 268, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 293, unLabel = Fun2 "[]" (Labeled {label = TokSpan 271 292, unLabel = Parens (Labeled {label = TokPos 275, unLabel = Fun2 "&" (Labeled {label = TokPos 273, unLabel = Fun2 "==" (Labeled {label = TokSpan 272 272, unLabel = Var (Labeled {label = TokSpan 272 272, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 274 274, unLabel = IntExp 1})}) (Labeled {label = TokSpan 276 291, unLabel = PrefixExp (Labeled {label = TokSpan 276 276, unLabel = Var (Labeled {label = TokSpan 276 276, unLabel = Ident {unIdent = "getCustomer"}})}) [Labeled {label = TokSpan 277 278, unLabel = InComm (Labeled {label = TokSpan 278 278, unLabel = VarPat (Labeled {label = TokSpan 278 278, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 280 291, unLabel = PrefixExp (Labeled {label = TokSpan 280 280, unLabel = Var (Labeled {label = TokSpan 280 280, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 281 282, unLabel = OutComm (Labeled {label = TokSpan 282 282, unLabel = Var (Labeled {label = TokSpan 282 282, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 284 291, unLabel = PrefixExp (Labeled {label = TokSpan 284 284, unLabel = Var (Labeled {label = TokSpan 284 284, unLabel = Ident {unIdent = "setCustomer"}})}) [Labeled {label = TokSpan 285 286, unLabel = OutComm (Labeled {label = TokSpan 286 286, unLabel = Var (Labeled {label = TokSpan 286 286, unLabel = Ident {unIdent = "defaultCustomer"}})})}] (Labeled {label = TokSpan 288 291, unLabel = CallFunction (Labeled {label = TokSpan 288 288, unLabel = Var (Labeled {label = TokSpan 288 288, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 290 290, unLabel = IntExp 0}]]})})})})})}) (Labeled {label = TokSpan 294 335, unLabel = Parens (Labeled {label = TokPos 298, unLabel = Fun2 "&" (Labeled {label = TokPos 297, unLabel = Fun2 ">" (Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 297 297, unLabel = IntExp 1})}) (Labeled {label = TokSpan 299 334, unLabel = PrefixExp (Labeled {label = TokSpan 299 299, unLabel = Var (Labeled {label = TokSpan 299 299, unLabel = Ident {unIdent = "getCustomer"}})}) [Labeled {label = TokSpan 300 301, unLabel = InComm (Labeled {label = TokSpan 301 301, unLabel = VarPat (Labeled {label = TokSpan 301 301, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 303 334, unLabel = PrefixExp (Labeled {label = TokSpan 303 303, unLabel = Var (Labeled {label = TokSpan 303 303, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 304 305, unLabel = OutComm (Labeled {label = TokSpan 305 305, unLabel = Var (Labeled {label = TokSpan 305 305, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 307 334, unLabel = PrefixExp (Labeled {label = TokSpan 307 307, unLabel = Var (Labeled {label = TokSpan 307 307, unLabel = Ident {unIdent = "getQueueNo"}})}) [Labeled {label = TokSpan 308 309, unLabel = InComm (Labeled {label = TokSpan 309 309, unLabel = VarPat (Labeled {label = TokSpan 309 309, unLabel = Ident {unIdent = "qNo"}})})}] (Labeled {label = TokSpan 311 334, unLabel = PrefixExp (Labeled {label = TokSpan 311 311, unLabel = Var (Labeled {label = TokSpan 311 311, unLabel = Ident {unIdent = "com2"}})}) [Labeled {label = TokSpan 312 313, unLabel = OutComm (Labeled {label = TokSpan 313 313, unLabel = Var (Labeled {label = TokSpan 313 313, unLabel = Ident {unIdent = "qNo"}})})}] (Labeled {label = TokSpan 315 334, unLabel = PrefixExp (Labeled {label = TokSpan 315 315, unLabel = Var (Labeled {label = TokSpan 315 315, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 316 317, unLabel = InComm (Labeled {label = TokSpan 317 317, unLabel = VarPat (Labeled {label = TokSpan 317 317, unLabel = Ident {unIdent = "newCust"}})})},Labeled {label = TokSpan 318 319, unLabel = InComm (Labeled {label = TokSpan 319 319, unLabel = VarPat (Labeled {label = TokSpan 319 319, unLabel = Ident {unIdent = "newQNo"}})})}] (Labeled {label = TokSpan 321 334, unLabel = PrefixExp (Labeled {label = TokSpan 321 321, unLabel = Var (Labeled {label = TokSpan 321 321, unLabel = Ident {unIdent = "setCustomer"}})}) [Labeled {label = TokSpan 322 323, unLabel = OutComm (Labeled {label = TokSpan 323 323, unLabel = Var (Labeled {label = TokSpan 323 323, unLabel = Ident {unIdent = "newCust"}})})}] (Labeled {label = TokSpan 325 334, unLabel = PrefixExp (Labeled {label = TokSpan 325 325, unLabel = Var (Labeled {label = TokSpan 325 325, unLabel = Ident {unIdent = "setNextQueue"}})}) [Labeled {label = TokSpan 326 327, unLabel = OutComm (Labeled {label = TokSpan 327 327, unLabel = Var (Labeled {label = TokSpan 327 327, unLabel = Ident {unIdent = "newQNo"}})})}] (Labeled {label = TokSpan 329 334, unLabel = CallFunction (Labeled {label = TokSpan 329 329, unLabel = Var (Labeled {label = TokSpan 329 329, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 332, unLabel = Fun2 "-" (Labeled {label = TokSpan 331 331, unLabel = Var (Labeled {label = TokSpan 331 331, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 333 333, unLabel = IntExp 1})}]]})})})})})})})})})})})]},Labeled {label = TokSpan 340 345, unLabel = PatBind (Labeled {label = TokSpan 340 340, unLabel = VarPat (Labeled {label = TokSpan 340 340, unLabel = Ident {unIdent = "QueuesCtrl"}})}) (Labeled {label = TokSpan 342 345, unLabel = CallFunction (Labeled {label = TokSpan 342 342, unLabel = Var (Labeled {label = TokSpan 342 342, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 344 344, unLabel = IntExp 0}]]})},Labeled {label = TokSpan 346 346, unLabel = FunBind (Labeled {label = TokSpan 346 346, unLabel = Ident {unIdent = "QCtrl"}}) [FunCase [[Labeled {label = TokSpan 348 348, unLabel = VarPat (Labeled {label = TokSpan 348 348, unLabel = Ident {unIdent = "s"}})}]] (Labeled {label = TokPos 397, unLabel = Fun2 "[]" (Labeled {label = TokSpan 351 396, unLabel = Parens (Labeled {label = TokPos 355, unLabel = Fun2 "&" (Labeled {label = TokPos 353, unLabel = Fun2 "<" (Labeled {label = TokSpan 352 352, unLabel = Var (Labeled {label = TokSpan 352 352, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 354 354, unLabel = Var (Labeled {label = TokSpan 354 354, unLabel = Ident {unIdent = "maxQueueingCustomers"}})})}) (Labeled {label = TokSpan 356 395, unLabel = PrefixExp (Labeled {label = TokSpan 356 356, unLabel = Var (Labeled {label = TokSpan 356 356, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 357 358, unLabel = InComm (Labeled {label = TokSpan 358 358, unLabel = VarPat (Labeled {label = TokSpan 358 358, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 360 395, unLabel = PrefixExp (Labeled {label = TokSpan 360 360, unLabel = Var (Labeled {label = TokSpan 360 360, unLabel = Ident {unIdent = "queryIsInQueue"}})}) [Labeled {label = TokSpan 361 362, unLabel = OutComm (Labeled {label = TokSpan 362 362, unLabel = Var (Labeled {label = TokSpan 362 362, unLabel = Ident {unIdent = "cc"}})})},Labeled {label = TokSpan 363 364, unLabel = InComm (Labeled {label = TokSpan 364 364, unLabel = VarPat (Labeled {label = TokSpan 364 364, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 366 395, unLabel = Ifte (Labeled {label = TokSpan 367 371, unLabel = Parens (Labeled {label = TokPos 369, unLabel = Fun2 "==" (Labeled {label = TokSpan 368 368, unLabel = Var (Labeled {label = TokSpan 368 368, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 370 370, unLabel = Var (Labeled {label = TokSpan 370 370, unLabel = Ident {unIdent = "yes"}})})})}) (Labeled {label = TokSpan 373 380, unLabel = PrefixExp (Labeled {label = TokSpan 373 373, unLabel = Var (Labeled {label = TokSpan 373 373, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 374 375, unLabel = OutComm (Labeled {label = TokSpan 375 375, unLabel = Var (Labeled {label = TokSpan 375 375, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 377 380, unLabel = CallFunction (Labeled {label = TokSpan 377 377, unLabel = Var (Labeled {label = TokSpan 377 377, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 379 379, unLabel = Var (Labeled {label = TokSpan 379 379, unLabel = Ident {unIdent = "s"}})}]]})}) (Labeled {label = TokSpan 382 395, unLabel = PrefixExp (Labeled {label = TokSpan 382 382, unLabel = Var (Labeled {label = TokSpan 382 382, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 383 384, unLabel = OutComm (Labeled {label = TokSpan 384 384, unLabel = Var (Labeled {label = TokSpan 384 384, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 386 395, unLabel = PrefixExp (Labeled {label = TokSpan 386 386, unLabel = Var (Labeled {label = TokSpan 386 386, unLabel = Ident {unIdent = "joinQueue"}})}) [Labeled {label = TokSpan 387 388, unLabel = OutComm (Labeled {label = TokSpan 388 388, unLabel = Var (Labeled {label = TokSpan 388 388, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 390 395, unLabel = CallFunction (Labeled {label = TokSpan 390 390, unLabel = Var (Labeled {label = TokSpan 390 390, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 393, unLabel = Fun2 "+" (Labeled {label = TokSpan 392 392, unLabel = Var (Labeled {label = TokSpan 392 392, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 394 394, unLabel = IntExp 1})}]]})})})})})})})}) (Labeled {label = TokSpan 398 413, unLabel = Parens (Labeled {label = TokPos 402, unLabel = Fun2 "&" (Labeled {label = TokPos 401, unLabel = Fun2 ">" (Labeled {label = TokSpan 399 399, unLabel = Var (Labeled {label = TokSpan 399 399, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 401 401, unLabel = IntExp 0})}) (Labeled {label = TokSpan 403 412, unLabel = PrefixExp (Labeled {label = TokSpan 403 403, unLabel = Var (Labeled {label = TokSpan 403 403, unLabel = Ident {unIdent = "com2"}})}) [Labeled {label = TokSpan 404 405, unLabel = InComm (Labeled {label = TokSpan 405 405, unLabel = VarPat (Labeled {label = TokSpan 405 405, unLabel = Ident {unIdent = "qNo"}})})}] (Labeled {label = TokSpan 407 412, unLabel = CallFunction (Labeled {label = TokSpan 407 407, unLabel = Var (Labeled {label = TokSpan 407 407, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 409 409, unLabel = Var (Labeled {label = TokSpan 409 409, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 411 411, unLabel = Var (Labeled {label = TokSpan 411 411, unLabel = Ident {unIdent = "qNo"}})}]]})})})})})]},Labeled {label = TokSpan 415 415, unLabel = FunBind (Labeled {label = TokSpan 415 415, unLabel = Ident {unIdent = "NextQCtrl"}}) [FunCase [[Labeled {label = TokSpan 417 417, unLabel = VarPat (Labeled {label = TokSpan 417 417, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 419 419, unLabel = VarPat (Labeled {label = TokSpan 419 419, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokSpan 422 465, unLabel = PrefixExp (Labeled {label = TokSpan 422 422, unLabel = Var (Labeled {label = TokSpan 422 422, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 423 424, unLabel = OutComm (Labeled {label = TokSpan 424 424, unLabel = Var (Labeled {label = TokSpan 424 424, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 425 426, unLabel = InComm (Labeled {label = TokSpan 426 426, unLabel = VarPat (Labeled {label = TokSpan 426 426, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 428 465, unLabel = Ifte (Labeled {label = TokSpan 429 433, unLabel = Parens (Labeled {label = TokPos 431, unLabel = Fun2 "==" (Labeled {label = TokSpan 430 430, unLabel = Var (Labeled {label = TokSpan 430 430, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 432 432, unLabel = Var (Labeled {label = TokSpan 432 432, unLabel = Ident {unIdent = "no"}})})})}) (Labeled {label = TokSpan 435 455, unLabel = PrefixExp (Labeled {label = TokSpan 435 435, unLabel = Var (Labeled {label = TokSpan 435 435, unLabel = Ident {unIdent = "leaveQueue"}})}) [Labeled {label = TokSpan 436 437, unLabel = OutComm (Labeled {label = TokSpan 437 437, unLabel = Var (Labeled {label = TokSpan 437 437, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 438 439, unLabel = InComm (Labeled {label = TokSpan 439 439, unLabel = VarPat (Labeled {label = TokSpan 439 439, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 441 455, unLabel = PrefixExp (Labeled {label = TokSpan 441 441, unLabel = Var (Labeled {label = TokSpan 441 441, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 442 443, unLabel = OutComm (Labeled {label = TokSpan 443 443, unLabel = Var (Labeled {label = TokSpan 443 443, unLabel = Ident {unIdent = "cc"}})})},Labeled {label = TokSpan 444 448, unLabel = OutComm (Labeled {label = TokSpan 445 448, unLabel = CallFunction (Labeled {label = TokSpan 445 445, unLabel = Var (Labeled {label = TokSpan 445 445, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 447 447, unLabel = Var (Labeled {label = TokSpan 447 447, unLabel = Ident {unIdent = "queueNo"}})}]]})}] (Labeled {label = TokSpan 450 455, unLabel = CallFunction (Labeled {label = TokSpan 450 450, unLabel = Var (Labeled {label = TokSpan 450 450, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 453, unLabel = Fun2 "-" (Labeled {label = TokSpan 452 452, unLabel = Var (Labeled {label = TokSpan 452 452, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 454 454, unLabel = IntExp 1})}]]})})}) (Labeled {label = TokSpan 457 465, unLabel = CallFunction (Labeled {label = TokSpan 457 457, unLabel = Var (Labeled {label = TokSpan 457 457, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 459 459, unLabel = Var (Labeled {label = TokSpan 459 459, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 461 464, unLabel = CallFunction (Labeled {label = TokSpan 461 461, unLabel = Var (Labeled {label = TokSpan 461 461, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 463 463, unLabel = Var (Labeled {label = TokSpan 463 463, unLabel = Ident {unIdent = "queueNo"}})}]]}]]})})})]},Labeled {label = TokSpan 466 478, unLabel = PatBind (Labeled {label = TokSpan 466 466, unLabel = VarPat (Labeled {label = TokSpan 466 466, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 468 478, unLabel = Closure [Labeled {label = TokSpan 469 469, unLabel = Var (Labeled {label = TokSpan 469 469, unLabel = Ident {unIdent = "com1"}})},Labeled {label = TokSpan 471 471, unLabel = Var (Labeled {label = TokSpan 471 471, unLabel = Ident {unIdent = "com2"}})},Labeled {label = TokSpan 473 473, unLabel = Var (Labeled {label = TokSpan 473 473, unLabel = Ident {unIdent = "com3"}})},Labeled {label = TokSpan 475 475, unLabel = Var (Labeled {label = TokSpan 475 475, unLabel = Ident {unIdent = "canJoinResponse"}})},Labeled {label = TokSpan 477 477, unLabel = Var (Labeled {label = TokSpan 477 477, unLabel = Ident {unIdent = "retrieveCustomer"}})}]})},Labeled {label = TokSpan 479 497, unLabel = PatBind (Labeled {label = TokSpan 479 479, unLabel = VarPat (Labeled {label = TokSpan 479 479, unLabel = Ident {unIdent = "B"}})}) (Labeled {label = TokSpan 481 497, unLabel = Closure [Labeled {label = TokSpan 482 482, unLabel = Var (Labeled {label = TokSpan 482 482, unLabel = Ident {unIdent = "joinQueue"}})},Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "leaveQueue"}})},Labeled {label = TokSpan 486 486, unLabel = Var (Labeled {label = TokSpan 486 486, unLabel = Ident {unIdent = "queryQueueEmpty"}})},Labeled {label = TokSpan 488 488, unLabel = Var (Labeled {label = TokSpan 488 488, unLabel = Ident {unIdent = "queryIsInQueue"}})},Labeled {label = TokSpan 490 490, unLabel = Var (Labeled {label = TokSpan 490 490, unLabel = Ident {unIdent = "getCustomer"}})},Labeled {label = TokSpan 492 492, unLabel = Var (Labeled {label = TokSpan 492 492, unLabel = Ident {unIdent = "setCustomer"}})},Labeled {label = TokSpan 494 494, unLabel = Var (Labeled {label = TokSpan 494 494, unLabel = Ident {unIdent = "getQueueNo"}})},Labeled {label = TokSpan 496 496, unLabel = Var (Labeled {label = TokSpan 496 496, unLabel = Ident {unIdent = "setNextQueue"}})}]})},Labeled {label = TokSpan 498 513, unLabel = PatBind (Labeled {label = TokSpan 498 498, unLabel = VarPat (Labeled {label = TokSpan 498 498, unLabel = Ident {unIdent = "BankSystem"}})}) (Labeled {label = TokPos 507, unLabel = Fun2 "\\" (Labeled {label = TokSpan 500 506, unLabel = Parens (Labeled {label = TokSpan 502 504, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 503 503, unLabel = Var (Labeled {label = TokSpan 503 503, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 501 501, unLabel = Var (Labeled {label = TokSpan 501 501, unLabel = Ident {unIdent = "BankCounterCtrl"}})}) (Labeled {label = TokSpan 505 505, unLabel = Var (Labeled {label = TokSpan 505 505, unLabel = Ident {unIdent = "QueuesCtrl"}})})})}) (Labeled {label = TokSpan 508 513, unLabel = CallBuiltIn (Labeled {label = TokSpan 508 508, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 510 510, unLabel = Var (Labeled {label = TokSpan 510 510, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 512 512, unLabel = Var (Labeled {label = TokSpan 512 512, unLabel = Ident {unIdent = "B"}})}]]})})},Labeled {label = TokSpan 514 520, unLabel = PatBind (Labeled {label = TokSpan 514 514, unLabel = VarPat (Labeled {label = TokSpan 514 514, unLabel = Ident {unIdent = "BankSystemNoHide"}})}) (Labeled {label = TokSpan 517 519, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 518 518, unLabel = Var (Labeled {label = TokSpan 518 518, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 516 516, unLabel = Var (Labeled {label = TokSpan 516 516, unLabel = Ident {unIdent = "BankCounterCtrl"}})}) (Labeled {label = TokSpan 520 520, unLabel = Var (Labeled {label = TokSpan 520 520, unLabel = Ident {unIdent = "QueuesCtrl"}})})})},Labeled {label = TokSpan 521 532, unLabel = PatBind (Labeled {label = TokSpan 521 521, unLabel = VarPat (Labeled {label = TokSpan 521 521, unLabel = Ident {unIdent = "SPEC"}})}) (Labeled {label = TokSpan 523 532, unLabel = ProcRepInterleave [Labeled {label = TokSpan 524 530, unLabel = Generator (Labeled {label = TokSpan 524 524, unLabel = VarPat (Labeled {label = TokSpan 524 524, unLabel = Ident {unIdent = "i"}})}) (Labeled {label = TokSpan 526 530, unLabel = SetClose (Labeled {label = TokSpan 527 527, unLabel = IntExp 1},Labeled {label = TokSpan 529 529, unLabel = Var (Labeled {label = TokSpan 529 529, unLabel = Ident {unIdent = "maxLimit"}})})})}] (Labeled {label = TokSpan 532 532, unLabel = Var (Labeled {label = TokSpan 532 532, unLabel = Ident {unIdent = "CUST"}})})})},Labeled {label = TokSpan 533 555, unLabel = PatBind (Labeled {label = TokSpan 533 533, unLabel = VarPat (Labeled {label = TokSpan 533 533, unLabel = Ident {unIdent = "CUST"}})}) (Labeled {label = TokSpan 535 555, unLabel = PrefixExp (Labeled {label = TokSpan 535 535, unLabel = Var (Labeled {label = TokSpan 535 535, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 536 537, unLabel = InComm (Labeled {label = TokSpan 537 537, unLabel = VarPat (Labeled {label = TokSpan 537 537, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 539 555, unLabel = Parens (Labeled {label = TokPos 545, unLabel = Fun2 "[]" (Labeled {label = TokSpan 540 544, unLabel = PrefixExp (Labeled {label = TokSpan 540 540, unLabel = Var (Labeled {label = TokSpan 540 540, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 541 542, unLabel = OutComm (Labeled {label = TokSpan 542 542, unLabel = Var (Labeled {label = TokSpan 542 542, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "CUST"}})})}) (Labeled {label = TokSpan 546 554, unLabel = PrefixExp (Labeled {label = TokSpan 546 546, unLabel = Var (Labeled {label = TokSpan 546 546, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 547 548, unLabel = OutComm (Labeled {label = TokSpan 548 548, unLabel = Var (Labeled {label = TokSpan 548 548, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 550 554, unLabel = PrefixExp (Labeled {label = TokSpan 550 550, unLabel = Var (Labeled {label = TokSpan 550 550, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 551 552, unLabel = OutComm (Labeled {label = TokSpan 552 552, unLabel = Var (Labeled {label = TokSpan 552 552, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 554 554, unLabel = Var (Labeled {label = TokSpan 554 554, unLabel = Ident {unIdent = "CUST"}})})})})})})})},Labeled {label = TokSpan 558 563, unLabel = PatBind (Labeled {label = TokSpan 558 558, unLabel = VarPat (Labeled {label = TokSpan 558 558, unLabel = Ident {unIdent = "SPEC2"}})}) (Labeled {label = TokSpan 560 563, unLabel = CallFunction (Labeled {label = TokSpan 560 560, unLabel = Var (Labeled {label = TokSpan 560 560, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 562 562, unLabel = IntExp 0}]]})},Labeled {label = TokSpan 564 564, unLabel = FunBind (Labeled {label = TokSpan 564 564, unLabel = Ident {unIdent = "NEWSPEC"}}) [FunCase [[Labeled {label = TokSpan 566 566, unLabel = VarPat (Labeled {label = TokSpan 566 566, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 598, unLabel = Fun2 "[]" (Labeled {label = TokPos 572, unLabel = Fun2 "&" (Labeled {label = TokPos 570, unLabel = Fun2 "<" (Labeled {label = TokSpan 569 569, unLabel = Var (Labeled {label = TokSpan 569 569, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 571 571, unLabel = Var (Labeled {label = TokSpan 571 571, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 573 597, unLabel = PrefixExp (Labeled {label = TokSpan 573 573, unLabel = Var (Labeled {label = TokSpan 573 573, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 574 575, unLabel = InComm (Labeled {label = TokSpan 575 575, unLabel = VarPat (Labeled {label = TokSpan 575 575, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 577 597, unLabel = Parens (Labeled {label = TokPos 588, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 578 587, unLabel = PrefixExp (Labeled {label = TokSpan 578 578, unLabel = Var (Labeled {label = TokSpan 578 578, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 579 580, unLabel = OutComm (Labeled {label = TokSpan 580 580, unLabel = Var (Labeled {label = TokSpan 580 580, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 582 587, unLabel = CallFunction (Labeled {label = TokSpan 582 582, unLabel = Var (Labeled {label = TokSpan 582 582, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 585, unLabel = Fun2 "+" (Labeled {label = TokSpan 584 584, unLabel = Var (Labeled {label = TokSpan 584 584, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 586 586, unLabel = IntExp 1})}]]})}) (Labeled {label = TokSpan 589 596, unLabel = PrefixExp (Labeled {label = TokSpan 589 589, unLabel = Var (Labeled {label = TokSpan 589 589, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 590 591, unLabel = OutComm (Labeled {label = TokSpan 591 591, unLabel = Var (Labeled {label = TokSpan 591 591, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 593 596, unLabel = CallFunction (Labeled {label = TokSpan 593 593, unLabel = Var (Labeled {label = TokSpan 593 593, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 595 595, unLabel = Var (Labeled {label = TokSpan 595 595, unLabel = Ident {unIdent = "num"}})}]]})})})})})}) (Labeled {label = TokPos 602, unLabel = Fun2 "&" (Labeled {label = TokPos 601, unLabel = Fun2 ">" (Labeled {label = TokSpan 599 599, unLabel = Var (Labeled {label = TokSpan 599 599, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 601 601, unLabel = IntExp 0})}) (Labeled {label = TokSpan 603 617, unLabel = ProcRepInternalChoice [Labeled {label = TokSpan 604 606, unLabel = Generator (Labeled {label = TokSpan 604 604, unLabel = VarPat (Labeled {label = TokSpan 604 604, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 606 606, unLabel = Var (Labeled {label = TokSpan 606 606, unLabel = Ident {unIdent = "CUSTOMER"}})})}] (Labeled {label = TokSpan 608 617, unLabel = PrefixExp (Labeled {label = TokSpan 608 608, unLabel = Var (Labeled {label = TokSpan 608 608, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 609 610, unLabel = OutComm (Labeled {label = TokSpan 610 610, unLabel = Var (Labeled {label = TokSpan 610 610, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 612 617, unLabel = CallFunction (Labeled {label = TokSpan 612 612, unLabel = Var (Labeled {label = TokSpan 612 612, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 615, unLabel = Fun2 "-" (Labeled {label = TokSpan 614 614, unLabel = Var (Labeled {label = TokSpan 614 614, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 616 616, unLabel = IntExp 1})}]]})})})})})]},Labeled {label = TokSpan 618 621, unLabel = AssertRef (Labeled {label = TokSpan 619 619, unLabel = Var (Labeled {label = TokSpan 619 619, unLabel = Ident {unIdent = "SPEC"}})}) "[T=" (Labeled {label = TokSpan 621 621, unLabel = Var (Labeled {label = TokSpan 621 621, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 622 625, unLabel = AssertRef (Labeled {label = TokSpan 623 623, unLabel = Var (Labeled {label = TokSpan 623 623, unLabel = Ident {unIdent = "SPEC"}})}) "[F=" (Labeled {label = TokSpan 625 625, unLabel = Var (Labeled {label = TokSpan 625 625, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 626 629, unLabel = AssertRef (Labeled {label = TokSpan 627 627, unLabel = Var (Labeled {label = TokSpan 627 627, unLabel = Ident {unIdent = "SPEC2"}})}) "[T=" (Labeled {label = TokSpan 629 629, unLabel = Var (Labeled {label = TokSpan 629 629, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 630 633, unLabel = AssertRef (Labeled {label = TokSpan 631 631, unLabel = Var (Labeled {label = TokSpan 631 631, unLabel = Ident {unIdent = "SPEC2"}})}) "[F=" (Labeled {label = TokSpan 633 633, unLabel = Var (Labeled {label = TokSpan 633 633, unLabel = Ident {unIdent = "BankSystem"}})})}]}
