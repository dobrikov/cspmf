Labeled {label = TokSpan 5 776, unLabel = Module [Labeled {label = TokSpan 5 11, unLabel = PatBind (Labeled {label = TokSpan 5 5, unLabel = VarPat (Labeled {label = TokSpan 5 5, unLabel = Ident {unIdent = "QUEUENUM"}})}) (Labeled {label = TokSpan 7 11, unLabel = SetClose (Labeled {label = TokSpan 8 8, unLabel = IntExp 1},Labeled {label = TokSpan 10 10, unLabel = Var (Labeled {label = TokSpan 10 10, unLabel = Ident {unIdent = "numQueues"}})})})},Labeled {label = TokSpan 12 25, unLabel = DataType (Labeled {label = TokSpan 13 13, unLabel = Ident {unIdent = "CUSTOMER"}}) [Labeled {label = TokSpan 15 15, unLabel = Constructor (Labeled {label = TokSpan 15 15, unLabel = Ident {unIdent = "c1"}}) Nothing},Labeled {label = TokSpan 17 17, unLabel = Constructor (Labeled {label = TokSpan 17 17, unLabel = Ident {unIdent = "c2"}}) Nothing},Labeled {label = TokSpan 19 19, unLabel = Constructor (Labeled {label = TokSpan 19 19, unLabel = Ident {unIdent = "c3"}}) Nothing},Labeled {label = TokSpan 21 21, unLabel = Constructor (Labeled {label = TokSpan 21 21, unLabel = Ident {unIdent = "c4"}}) Nothing},Labeled {label = TokSpan 23 23, unLabel = Constructor (Labeled {label = TokSpan 23 23, unLabel = Ident {unIdent = "c5"}}) Nothing},Labeled {label = TokSpan 25 25, unLabel = Constructor (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "c6"}}) Nothing}]},Labeled {label = TokSpan 26 31, unLabel = DataType (Labeled {label = TokSpan 27 27, unLabel = Ident {unIdent = "STATUS"}}) [Labeled {label = TokSpan 29 29, unLabel = Constructor (Labeled {label = TokSpan 29 29, unLabel = Ident {unIdent = "success"}}) Nothing},Labeled {label = TokSpan 31 31, unLabel = Constructor (Labeled {label = TokSpan 31 31, unLabel = Ident {unIdent = "fail"}}) Nothing}]},Labeled {label = TokSpan 32 37, unLabel = DataType (Labeled {label = TokSpan 33 33, unLabel = Ident {unIdent = "QSTATUS"}}) [Labeled {label = TokSpan 35 35, unLabel = Constructor (Labeled {label = TokSpan 35 35, unLabel = Ident {unIdent = "yes"}}) Nothing},Labeled {label = TokSpan 37 37, unLabel = Constructor (Labeled {label = TokSpan 37 37, unLabel = Ident {unIdent = "no"}}) Nothing}]},Labeled {label = TokSpan 38 40, unLabel = PatBind (Labeled {label = TokSpan 38 38, unLabel = VarPat (Labeled {label = TokSpan 38 38, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 40 40, unLabel = IntExp 2})},Labeled {label = TokSpan 41 43, unLabel = PatBind (Labeled {label = TokSpan 41 41, unLabel = VarPat (Labeled {label = TokSpan 41 41, unLabel = Ident {unIdent = "defaultCounter"}})}) (Labeled {label = TokSpan 43 43, unLabel = IntExp 1})},Labeled {label = TokSpan 44 46, unLabel = PatBind (Labeled {label = TokSpan 44 44, unLabel = VarPat (Labeled {label = TokSpan 44 44, unLabel = Ident {unIdent = "defaultCustomer"}})}) (Labeled {label = TokSpan 46 46, unLabel = Var (Labeled {label = TokSpan 46 46, unLabel = Ident {unIdent = "c1"}})})},Labeled {label = TokSpan 47 51, unLabel = PatBind (Labeled {label = TokSpan 47 47, unLabel = VarPat (Labeled {label = TokSpan 47 47, unLabel = Ident {unIdent = "maxQueueingCustomers"}})}) (Labeled {label = TokPos 50, unLabel = Fun2 "-" (Labeled {label = TokSpan 49 49, unLabel = Var (Labeled {label = TokSpan 49 49, unLabel = Ident {unIdent = "maxLimit"}})}) (Labeled {label = TokSpan 51 51, unLabel = IntExp 1})})},Labeled {label = TokSpan 52 54, unLabel = PatBind (Labeled {label = TokSpan 52 52, unLabel = VarPat (Labeled {label = TokSpan 52 52, unLabel = Ident {unIdent = "numQueues"}})}) (Labeled {label = TokSpan 54 54, unLabel = IntExp 3})},Labeled {label = TokSpan 56 59, unLabel = Channel [Labeled {label = TokSpan 57 57, unLabel = Ident {unIdent = "enterBank"}}] (Just (Labeled {label = TokSpan 59 59, unLabel = TypeDot [Labeled {label = TokSpan 59 59, unLabel = Var (Labeled {label = TokSpan 59 59, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 60 63, unLabel = Channel [Labeled {label = TokSpan 61 61, unLabel = Ident {unIdent = "leaveBank"}}] (Just (Labeled {label = TokSpan 63 63, unLabel = TypeDot [Labeled {label = TokSpan 63 63, unLabel = Var (Labeled {label = TokSpan 63 63, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 64 67, unLabel = Channel [Labeled {label = TokSpan 65 65, unLabel = Ident {unIdent = "report"}}] (Just (Labeled {label = TokSpan 67 67, unLabel = TypeDot [Labeled {label = TokSpan 67 67, unLabel = Var (Labeled {label = TokSpan 67 67, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 69 72, unLabel = Channel [Labeled {label = TokSpan 70 70, unLabel = Ident {unIdent = "com1"}}] (Just (Labeled {label = TokSpan 72 72, unLabel = TypeDot [Labeled {label = TokSpan 72 72, unLabel = Var (Labeled {label = TokSpan 72 72, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 73 76, unLabel = Channel [Labeled {label = TokSpan 74 74, unLabel = Ident {unIdent = "com3"}}] (Just (Labeled {label = TokSpan 76 76, unLabel = TypeDot [Labeled {label = TokSpan 76 76, unLabel = Var (Labeled {label = TokSpan 76 76, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 77 80, unLabel = Channel [Labeled {label = TokSpan 78 78, unLabel = Ident {unIdent = "canJoinResponse"}}] (Just (Labeled {label = TokSpan 80 80, unLabel = TypeDot [Labeled {label = TokSpan 80 80, unLabel = Var (Labeled {label = TokSpan 80 80, unLabel = Ident {unIdent = "STATUS"}})}]}))},Labeled {label = TokSpan 81 82, unLabel = Channel [Labeled {label = TokSpan 82 82, unLabel = Ident {unIdent = "retrieveCustomer"}}] Nothing},Labeled {label = TokSpan 84 87, unLabel = Channel [Labeled {label = TokSpan 85 85, unLabel = Ident {unIdent = "joinQueue"}}] (Just (Labeled {label = TokSpan 87 87, unLabel = TypeDot [Labeled {label = TokSpan 87 87, unLabel = Var (Labeled {label = TokSpan 87 87, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 88 93, unLabel = Channel [Labeled {label = TokSpan 89 89, unLabel = Ident {unIdent = "leaveQueue"}}] (Just (Labeled {label = TokSpan 91 93, unLabel = TypeDot [Labeled {label = TokSpan 91 91, unLabel = Var (Labeled {label = TokSpan 91 91, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 93 93, unLabel = Var (Labeled {label = TokSpan 93 93, unLabel = Ident {unIdent = "CUSTOMER"}})}]}))},Labeled {label = TokSpan 94 99, unLabel = Channel [Labeled {label = TokSpan 95 95, unLabel = Ident {unIdent = "queryQueueEmpty"}}] (Just (Labeled {label = TokSpan 97 99, unLabel = TypeDot [Labeled {label = TokSpan 97 97, unLabel = Var (Labeled {label = TokSpan 97 97, unLabel = Ident {unIdent = "QUEUENUM"}})},Labeled {label = TokSpan 99 99, unLabel = Var (Labeled {label = TokSpan 99 99, unLabel = Ident {unIdent = "QSTATUS"}})}]}))},Labeled {label = TokSpan 100 100, unLabel = FunBind (Labeled {label = TokSpan 100 100, unLabel = Ident {unIdent = "inc"}}) [FunCase [[Labeled {label = TokSpan 102 102, unLabel = VarPat (Labeled {label = TokSpan 102 102, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokPos 110, unLabel = Fun2 "+" (Labeled {label = TokSpan 105 109, unLabel = Parens (Labeled {label = TokPos 107, unLabel = Fun2 "%" (Labeled {label = TokSpan 106 106, unLabel = Var (Labeled {label = TokSpan 106 106, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 108 108, unLabel = Var (Labeled {label = TokSpan 108 108, unLabel = Ident {unIdent = "numQueues"}})})})}) (Labeled {label = TokSpan 111 111, unLabel = IntExp 1})})]},Labeled {label = TokSpan 112 112, unLabel = FunBind (Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "dec"}}) [FunCase [[Labeled {label = TokSpan 114 114, unLabel = VarPat (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "queueNo"}})}]] (Labeled {label = TokPos 126, unLabel = Fun2 "+" (Labeled {label = TokSpan 117 125, unLabel = Parens (Labeled {label = TokPos 123, unLabel = Fun2 "%" (Labeled {label = TokSpan 118 122, unLabel = Parens (Labeled {label = TokPos 120, unLabel = Fun2 "-" (Labeled {label = TokSpan 119 119, unLabel = Var (Labeled {label = TokSpan 119 119, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 121 121, unLabel = IntExp 2})})}) (Labeled {label = TokSpan 124 124, unLabel = Var (Labeled {label = TokSpan 124 124, unLabel = Ident {unIdent = "numQueues"}})})})}) (Labeled {label = TokSpan 127 127, unLabel = IntExp 1})})]},Labeled {label = TokSpan 137 144, unLabel = PatBind (Labeled {label = TokSpan 137 137, unLabel = VarPat (Labeled {label = TokSpan 137 137, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 139 144, unLabel = CallFunction (Labeled {label = TokSpan 139 139, unLabel = Var (Labeled {label = TokSpan 139 139, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 141 141, unLabel = IntExp 0},Labeled {label = TokSpan 143 143, unLabel = Var (Labeled {label = TokSpan 143 143, unLabel = Ident {unIdent = "defaultCustomer"}})}]]})},Labeled {label = TokSpan 145 145, unLabel = FunBind (Labeled {label = TokSpan 145 145, unLabel = Ident {unIdent = "CurrentCtrl"}}) [FunCase [[Labeled {label = TokSpan 147 147, unLabel = VarPat (Labeled {label = TokSpan 147 147, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 149 149, unLabel = VarPat (Labeled {label = TokSpan 149 149, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 158, unLabel = Fun2 "[]" (Labeled {label = TokSpan 152 157, unLabel = CallFunction (Labeled {label = TokSpan 152 152, unLabel = Var (Labeled {label = TokSpan 152 152, unLabel = Ident {unIdent = "JoinCtrl"}})}) [[Labeled {label = TokSpan 154 154, unLabel = Var (Labeled {label = TokSpan 154 154, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 156 156, unLabel = Var (Labeled {label = TokSpan 156 156, unLabel = Ident {unIdent = "currentCust"}})}]]}) (Labeled {label = TokSpan 159 164, unLabel = CallFunction (Labeled {label = TokSpan 159 159, unLabel = Var (Labeled {label = TokSpan 159 159, unLabel = Ident {unIdent = "LeaveCtrl"}})}) [[Labeled {label = TokSpan 161 161, unLabel = Var (Labeled {label = TokSpan 161 161, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 163 163, unLabel = Var (Labeled {label = TokSpan 163 163, unLabel = Ident {unIdent = "currentCust"}})}]]})})]},Labeled {label = TokSpan 168 168, unLabel = FunBind (Labeled {label = TokSpan 168 168, unLabel = Ident {unIdent = "JoinCtrl"}}) [FunCase [[Labeled {label = TokSpan 170 170, unLabel = VarPat (Labeled {label = TokSpan 170 170, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 172 172, unLabel = VarPat (Labeled {label = TokSpan 172 172, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 178, unLabel = Fun2 "&" (Labeled {label = TokPos 176, unLabel = Fun2 "<" (Labeled {label = TokSpan 175 175, unLabel = Var (Labeled {label = TokSpan 175 175, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 177 177, unLabel = Var (Labeled {label = TokSpan 177 177, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 179 277, unLabel = PrefixExp (Labeled {label = TokSpan 179 179, unLabel = Var (Labeled {label = TokSpan 179 179, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 180 181, unLabel = InComm (Labeled {label = TokSpan 181 181, unLabel = VarPat (Labeled {label = TokSpan 181 181, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 183 277, unLabel = Parens (Labeled {label = TokPos 252, unLabel = Fun2 "[]" (Labeled {label = TokPos 202, unLabel = Fun2 "[]" (Labeled {label = TokSpan 184 201, unLabel = Parens (Labeled {label = TokPos 188, unLabel = Fun2 "&" (Labeled {label = TokPos 186, unLabel = Fun2 "==" (Labeled {label = TokSpan 185 185, unLabel = Var (Labeled {label = TokSpan 185 185, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 187 187, unLabel = IntExp 0})}) (Labeled {label = TokSpan 189 200, unLabel = PrefixExp (Labeled {label = TokSpan 189 189, unLabel = Var (Labeled {label = TokSpan 189 189, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 190 191, unLabel = OutComm (Labeled {label = TokSpan 191 191, unLabel = Var (Labeled {label = TokSpan 191 191, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 193 200, unLabel = CallFunction (Labeled {label = TokSpan 193 193, unLabel = Var (Labeled {label = TokSpan 193 193, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 196, unLabel = Fun2 "+" (Labeled {label = TokSpan 195 195, unLabel = Var (Labeled {label = TokSpan 195 195, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 197 197, unLabel = IntExp 1})},Labeled {label = TokSpan 199 199, unLabel = Var (Labeled {label = TokSpan 199 199, unLabel = Ident {unIdent = "cc"}})}]]})})})}) (Labeled {label = TokSpan 203 251, unLabel = Parens (Labeled {label = TokPos 216, unLabel = Fun2 "&" (Labeled {label = TokSpan 204 215, unLabel = Parens (Labeled {label = TokPos 208, unLabel = AndExp (Labeled {label = TokPos 207, unLabel = Fun2 ">" (Labeled {label = TokSpan 205 205, unLabel = Var (Labeled {label = TokSpan 205 205, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 207 207, unLabel = IntExp 0})}) (Labeled {label = TokPos 209, unLabel = NotExp (Labeled {label = TokSpan 210 214, unLabel = Parens (Labeled {label = TokPos 212, unLabel = Fun2 "==" (Labeled {label = TokSpan 211 211, unLabel = Var (Labeled {label = TokSpan 211 211, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 213 213, unLabel = Var (Labeled {label = TokSpan 213 213, unLabel = Ident {unIdent = "currentCust"}})})})})})})}) (Labeled {label = TokSpan 217 250, unLabel = PrefixExp (Labeled {label = TokSpan 217 217, unLabel = Var (Labeled {label = TokSpan 217 217, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 218 219, unLabel = OutComm (Labeled {label = TokSpan 219 219, unLabel = Var (Labeled {label = TokSpan 219 219, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 221 250, unLabel = PrefixExp (Labeled {label = TokSpan 221 221, unLabel = Var (Labeled {label = TokSpan 221 221, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 222 223, unLabel = InComm (Labeled {label = TokSpan 223 223, unLabel = VarPat (Labeled {label = TokSpan 223 223, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 225 250, unLabel = PrefixExp (Labeled {label = TokSpan 225 225, unLabel = Var (Labeled {label = TokSpan 225 225, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 226 227, unLabel = OutComm (Labeled {label = TokSpan 227 227, unLabel = Var (Labeled {label = TokSpan 227 227, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 229 250, unLabel = Ifte (Labeled {label = TokSpan 230 234, unLabel = Parens (Labeled {label = TokPos 232, unLabel = Fun2 "==" (Labeled {label = TokSpan 231 231, unLabel = Var (Labeled {label = TokSpan 231 231, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 233 233, unLabel = Var (Labeled {label = TokSpan 233 233, unLabel = Ident {unIdent = "success"}})})})}) (Labeled {label = TokSpan 236 243, unLabel = CallFunction (Labeled {label = TokSpan 236 236, unLabel = Var (Labeled {label = TokSpan 236 236, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 239, unLabel = Fun2 "+" (Labeled {label = TokSpan 238 238, unLabel = Var (Labeled {label = TokSpan 238 238, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 240 240, unLabel = IntExp 1})},Labeled {label = TokSpan 242 242, unLabel = Var (Labeled {label = TokSpan 242 242, unLabel = Ident {unIdent = "currentCust"}})}]]}) (Labeled {label = TokSpan 245 250, unLabel = CallFunction (Labeled {label = TokSpan 245 245, unLabel = Var (Labeled {label = TokSpan 245 245, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 247 247, unLabel = Var (Labeled {label = TokSpan 247 247, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 249 249, unLabel = Var (Labeled {label = TokSpan 249 249, unLabel = Ident {unIdent = "currentCust"}})}]]})})})})})})})}) (Labeled {label = TokSpan 253 276, unLabel = Parens (Labeled {label = TokPos 265, unLabel = Fun2 "&" (Labeled {label = TokSpan 254 264, unLabel = Parens (Labeled {label = TokPos 258, unLabel = AndExp (Labeled {label = TokPos 257, unLabel = Fun2 ">" (Labeled {label = TokSpan 255 255, unLabel = Var (Labeled {label = TokSpan 255 255, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 257 257, unLabel = IntExp 0})}) (Labeled {label = TokSpan 259 263, unLabel = Parens (Labeled {label = TokPos 261, unLabel = Fun2 "==" (Labeled {label = TokSpan 260 260, unLabel = Var (Labeled {label = TokSpan 260 260, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 262 262, unLabel = Var (Labeled {label = TokSpan 262 262, unLabel = Ident {unIdent = "currentCust"}})})})})})}) (Labeled {label = TokSpan 266 275, unLabel = PrefixExp (Labeled {label = TokSpan 266 266, unLabel = Var (Labeled {label = TokSpan 266 266, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 267 268, unLabel = OutComm (Labeled {label = TokSpan 268 268, unLabel = Var (Labeled {label = TokSpan 268 268, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 270 275, unLabel = CallFunction (Labeled {label = TokSpan 270 270, unLabel = Var (Labeled {label = TokSpan 270 270, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 272 272, unLabel = Var (Labeled {label = TokSpan 272 272, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 274 274, unLabel = Var (Labeled {label = TokSpan 274 274, unLabel = Ident {unIdent = "currentCust"}})}]]})})})})})})})})]},Labeled {label = TokSpan 287 287, unLabel = FunBind (Labeled {label = TokSpan 287 287, unLabel = Ident {unIdent = "LeaveCtrl"}}) [FunCase [[Labeled {label = TokSpan 289 289, unLabel = VarPat (Labeled {label = TokSpan 289 289, unLabel = Ident {unIdent = "num"}})},Labeled {label = TokSpan 291 291, unLabel = VarPat (Labeled {label = TokSpan 291 291, unLabel = Ident {unIdent = "currentCust"}})}]] (Labeled {label = TokPos 310, unLabel = Fun2 "[]" (Labeled {label = TokSpan 294 309, unLabel = Parens (Labeled {label = TokPos 298, unLabel = Fun2 "&" (Labeled {label = TokPos 296, unLabel = Fun2 "==" (Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 297 297, unLabel = IntExp 1})}) (Labeled {label = TokSpan 299 308, unLabel = PrefixExp (Labeled {label = TokSpan 299 299, unLabel = Var (Labeled {label = TokSpan 299 299, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 300 301, unLabel = OutComm (Labeled {label = TokSpan 301 301, unLabel = Var (Labeled {label = TokSpan 301 301, unLabel = Ident {unIdent = "currentCust"}})})}] (Labeled {label = TokSpan 303 308, unLabel = CallFunction (Labeled {label = TokSpan 303 303, unLabel = Var (Labeled {label = TokSpan 303 303, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokSpan 305 305, unLabel = IntExp 0},Labeled {label = TokSpan 307 307, unLabel = Var (Labeled {label = TokSpan 307 307, unLabel = Ident {unIdent = "defaultCustomer"}})}]]})})})}) (Labeled {label = TokSpan 311 334, unLabel = Parens (Labeled {label = TokPos 315, unLabel = Fun2 "&" (Labeled {label = TokPos 314, unLabel = Fun2 ">" (Labeled {label = TokSpan 312 312, unLabel = Var (Labeled {label = TokSpan 312 312, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 314 314, unLabel = IntExp 1})}) (Labeled {label = TokSpan 316 333, unLabel = PrefixExp (Labeled {label = TokSpan 316 316, unLabel = Var (Labeled {label = TokSpan 316 316, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 317 318, unLabel = OutComm (Labeled {label = TokSpan 318 318, unLabel = Var (Labeled {label = TokSpan 318 318, unLabel = Ident {unIdent = "currentCust"}})})}] (Labeled {label = TokSpan 320 333, unLabel = PrefixExp (Labeled {label = TokSpan 320 320, unLabel = Var (Labeled {label = TokSpan 320 320, unLabel = Ident {unIdent = "retrieveCustomer"}})}) [] (Labeled {label = TokSpan 322 333, unLabel = PrefixExp (Labeled {label = TokSpan 322 322, unLabel = Var (Labeled {label = TokSpan 322 322, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 323 324, unLabel = InComm (Labeled {label = TokSpan 324 324, unLabel = VarPat (Labeled {label = TokSpan 324 324, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 326 333, unLabel = CallFunction (Labeled {label = TokSpan 326 326, unLabel = Var (Labeled {label = TokSpan 326 326, unLabel = Ident {unIdent = "CurrentCtrl"}})}) [[Labeled {label = TokPos 329, unLabel = Fun2 "-" (Labeled {label = TokSpan 328 328, unLabel = Var (Labeled {label = TokSpan 328 328, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 330 330, unLabel = IntExp 1})},Labeled {label = TokSpan 332 332, unLabel = Var (Labeled {label = TokSpan 332 332, unLabel = Ident {unIdent = "cc"}})}]]})})})})})})})]},Labeled {label = TokSpan 337 347, unLabel = PatBind (Labeled {label = TokSpan 337 337, unLabel = VarPat (Labeled {label = TokSpan 337 337, unLabel = Ident {unIdent = "QueuesCtrl"}})}) (Labeled {label = TokSpan 339 347, unLabel = CallFunction (Labeled {label = TokSpan 339 339, unLabel = Var (Labeled {label = TokSpan 339 339, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 341 341, unLabel = IntExp 0},Labeled {label = TokSpan 343 343, unLabel = IntExp 1},Labeled {label = TokSpan 345 346, unLabel = SetEnum []}]]})},Labeled {label = TokSpan 348 348, unLabel = FunBind (Labeled {label = TokSpan 348 348, unLabel = Ident {unIdent = "QCtrl"}}) [FunCase [[Labeled {label = TokSpan 350 350, unLabel = VarPat (Labeled {label = TokSpan 350 350, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 352 352, unLabel = VarPat (Labeled {label = TokSpan 352 352, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 354 354, unLabel = VarPat (Labeled {label = TokSpan 354 354, unLabel = Ident {unIdent = "custSet"}})}]] (Labeled {label = TokPos 415, unLabel = Fun2 "[]" (Labeled {label = TokSpan 357 414, unLabel = Parens (Labeled {label = TokPos 361, unLabel = Fun2 "&" (Labeled {label = TokPos 359, unLabel = Fun2 "<" (Labeled {label = TokSpan 358 358, unLabel = Var (Labeled {label = TokSpan 358 358, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 360 360, unLabel = Var (Labeled {label = TokSpan 360 360, unLabel = Ident {unIdent = "maxQueueingCustomers"}})})}) (Labeled {label = TokSpan 362 413, unLabel = PrefixExp (Labeled {label = TokSpan 362 362, unLabel = Var (Labeled {label = TokSpan 362 362, unLabel = Ident {unIdent = "com1"}})}) [Labeled {label = TokSpan 363 364, unLabel = InComm (Labeled {label = TokSpan 364 364, unLabel = VarPat (Labeled {label = TokSpan 364 364, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 366 413, unLabel = Ifte (Labeled {label = TokSpan 367 374, unLabel = Parens (Labeled {label = TokSpan 368 373, unLabel = CallBuiltIn (Labeled {label = TokSpan 368 368, unLabel = BuiltIn "member"}) [[Labeled {label = TokSpan 370 370, unLabel = Var (Labeled {label = TokSpan 370 370, unLabel = Ident {unIdent = "cc"}})},Labeled {label = TokSpan 372 372, unLabel = Var (Labeled {label = TokSpan 372 372, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 376 387, unLabel = PrefixExp (Labeled {label = TokSpan 376 376, unLabel = Var (Labeled {label = TokSpan 376 376, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 377 378, unLabel = OutComm (Labeled {label = TokSpan 378 378, unLabel = Var (Labeled {label = TokSpan 378 378, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 380 387, unLabel = CallFunction (Labeled {label = TokSpan 380 380, unLabel = Var (Labeled {label = TokSpan 380 380, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokSpan 382 382, unLabel = Var (Labeled {label = TokSpan 382 382, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 384 384, unLabel = Var (Labeled {label = TokSpan 384 384, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 386 386, unLabel = Var (Labeled {label = TokSpan 386 386, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 389 413, unLabel = PrefixExp (Labeled {label = TokSpan 389 389, unLabel = Var (Labeled {label = TokSpan 389 389, unLabel = Ident {unIdent = "canJoinResponse"}})}) [Labeled {label = TokSpan 390 391, unLabel = OutComm (Labeled {label = TokSpan 391 391, unLabel = Var (Labeled {label = TokSpan 391 391, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 393 413, unLabel = PrefixExp (Labeled {label = TokSpan 393 393, unLabel = Var (Labeled {label = TokSpan 393 393, unLabel = Ident {unIdent = "joinQueue"}})}) [Labeled {label = TokSpan 394 395, unLabel = OutComm (Labeled {label = TokSpan 395 395, unLabel = Var (Labeled {label = TokSpan 395 395, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 397 413, unLabel = CallFunction (Labeled {label = TokSpan 397 397, unLabel = Var (Labeled {label = TokSpan 397 397, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 400, unLabel = Fun2 "+" (Labeled {label = TokSpan 399 399, unLabel = Var (Labeled {label = TokSpan 399 399, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 401 401, unLabel = IntExp 1})},Labeled {label = TokSpan 403 403, unLabel = Var (Labeled {label = TokSpan 403 403, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 405 412, unLabel = CallBuiltIn (Labeled {label = TokSpan 405 405, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 407 407, unLabel = Var (Labeled {label = TokSpan 407 407, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 409 411, unLabel = SetEnum [Labeled {label = TokSpan 410 410, unLabel = Var (Labeled {label = TokSpan 410 410, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})})})})})})}) (Labeled {label = TokSpan 416 436, unLabel = Parens (Labeled {label = TokPos 420, unLabel = Fun2 "&" (Labeled {label = TokPos 419, unLabel = Fun2 ">" (Labeled {label = TokSpan 417 417, unLabel = Var (Labeled {label = TokSpan 417 417, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 419 419, unLabel = IntExp 0})}) (Labeled {label = TokSpan 421 435, unLabel = PrefixExp (Labeled {label = TokSpan 421 421, unLabel = Var (Labeled {label = TokSpan 421 421, unLabel = Ident {unIdent = "retrieveCustomer"}})}) [] (Labeled {label = TokSpan 423 435, unLabel = CallFunction (Labeled {label = TokSpan 423 423, unLabel = Var (Labeled {label = TokSpan 423 423, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 425 425, unLabel = Var (Labeled {label = TokSpan 425 425, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 427 427, unLabel = Var (Labeled {label = TokSpan 427 427, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 429 432, unLabel = CallFunction (Labeled {label = TokSpan 429 429, unLabel = Var (Labeled {label = TokSpan 429 429, unLabel = Ident {unIdent = "dec"}})}) [[Labeled {label = TokSpan 431 431, unLabel = Var (Labeled {label = TokSpan 431 431, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 434 434, unLabel = Var (Labeled {label = TokSpan 434 434, unLabel = Ident {unIdent = "custSet"}})}]]})})})})})]},Labeled {label = TokSpan 439 439, unLabel = FunBind (Labeled {label = TokSpan 439 439, unLabel = Ident {unIdent = "NextQCtrl"}}) [FunCase [[Labeled {label = TokSpan 441 441, unLabel = VarPat (Labeled {label = TokSpan 441 441, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 443 443, unLabel = VarPat (Labeled {label = TokSpan 443 443, unLabel = Ident {unIdent = "queueNo"}})},Labeled {label = TokSpan 445 445, unLabel = VarPat (Labeled {label = TokSpan 445 445, unLabel = Ident {unIdent = "lastQueueNo"}})},Labeled {label = TokSpan 447 447, unLabel = VarPat (Labeled {label = TokSpan 447 447, unLabel = Ident {unIdent = "custSet"}})}]] (Labeled {label = TokPos 587, unLabel = Fun2 "[]" (Labeled {label = TokPos 528, unLabel = Fun2 "[]" (Labeled {label = TokSpan 450 527, unLabel = Parens (Labeled {label = TokPos 457, unLabel = Fun2 "&" (Labeled {label = TokPos 451, unLabel = NotExp (Labeled {label = TokSpan 452 456, unLabel = Parens (Labeled {label = TokPos 454, unLabel = Fun2 "==" (Labeled {label = TokSpan 453 453, unLabel = Var (Labeled {label = TokSpan 453 453, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 455 455, unLabel = Var (Labeled {label = TokSpan 455 455, unLabel = Ident {unIdent = "lastQueueNo"}})})})})}) (Labeled {label = TokSpan 458 526, unLabel = PrefixExp (Labeled {label = TokSpan 458 458, unLabel = Var (Labeled {label = TokSpan 458 458, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 459 460, unLabel = OutComm (Labeled {label = TokSpan 460 460, unLabel = Var (Labeled {label = TokSpan 460 460, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 461 462, unLabel = InComm (Labeled {label = TokSpan 462 462, unLabel = VarPat (Labeled {label = TokSpan 462 462, unLabel = Ident {unIdent = "bb"}})})}] (Labeled {label = TokSpan 464 526, unLabel = Ifte (Labeled {label = TokSpan 465 469, unLabel = Parens (Labeled {label = TokPos 467, unLabel = Fun2 "==" (Labeled {label = TokSpan 466 466, unLabel = Var (Labeled {label = TokSpan 466 466, unLabel = Ident {unIdent = "bb"}})}) (Labeled {label = TokSpan 468 468, unLabel = Var (Labeled {label = TokSpan 468 468, unLabel = Ident {unIdent = "no"}})})})}) (Labeled {label = TokSpan 471 512, unLabel = PrefixExp (Labeled {label = TokSpan 471 471, unLabel = Var (Labeled {label = TokSpan 471 471, unLabel = Ident {unIdent = "leaveQueue"}})}) [Labeled {label = TokSpan 472 473, unLabel = OutComm (Labeled {label = TokSpan 473 473, unLabel = Var (Labeled {label = TokSpan 473 473, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 474 475, unLabel = InComm (Labeled {label = TokSpan 475 475, unLabel = VarPat (Labeled {label = TokSpan 475 475, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 477 512, unLabel = Ifte (Labeled {label = TokSpan 478 485, unLabel = Parens (Labeled {label = TokSpan 479 484, unLabel = CallBuiltIn (Labeled {label = TokSpan 479 479, unLabel = BuiltIn "member"}) [[Labeled {label = TokSpan 481 481, unLabel = Var (Labeled {label = TokSpan 481 481, unLabel = Ident {unIdent = "cc"}})},Labeled {label = TokSpan 483 483, unLabel = Var (Labeled {label = TokSpan 483 483, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 487 510, unLabel = PrefixExp (Labeled {label = TokSpan 487 487, unLabel = Var (Labeled {label = TokSpan 487 487, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 488 489, unLabel = OutComm (Labeled {label = TokSpan 489 489, unLabel = Var (Labeled {label = TokSpan 489 489, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 491 510, unLabel = CallFunction (Labeled {label = TokSpan 491 491, unLabel = Var (Labeled {label = TokSpan 491 491, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 494, unLabel = Fun2 "-" (Labeled {label = TokSpan 493 493, unLabel = Var (Labeled {label = TokSpan 493 493, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 495 495, unLabel = IntExp 1})},Labeled {label = TokSpan 497 500, unLabel = CallFunction (Labeled {label = TokSpan 497 497, unLabel = Var (Labeled {label = TokSpan 497 497, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 499 499, unLabel = Var (Labeled {label = TokSpan 499 499, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 502 509, unLabel = CallBuiltIn (Labeled {label = TokSpan 502 502, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 504 504, unLabel = Var (Labeled {label = TokSpan 504 504, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 506 508, unLabel = SetEnum [Labeled {label = TokSpan 507 507, unLabel = Var (Labeled {label = TokSpan 507 507, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})}) (Labeled {label = TokSpan 512 512, unLabel = Var (Labeled {label = TokSpan 512 512, unLabel = Ident {unIdent = "DIV"}})})})}) (Labeled {label = TokSpan 514 526, unLabel = CallFunction (Labeled {label = TokSpan 514 514, unLabel = Var (Labeled {label = TokSpan 514 514, unLabel = Ident {unIdent = "NextQCtrl"}})}) [[Labeled {label = TokSpan 516 516, unLabel = Var (Labeled {label = TokSpan 516 516, unLabel = Ident {unIdent = "s"}})},Labeled {label = TokSpan 518 521, unLabel = CallFunction (Labeled {label = TokSpan 518 518, unLabel = Var (Labeled {label = TokSpan 518 518, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 520 520, unLabel = Var (Labeled {label = TokSpan 520 520, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 523 523, unLabel = Var (Labeled {label = TokSpan 523 523, unLabel = Ident {unIdent = "lastQueueNo"}})},Labeled {label = TokSpan 525 525, unLabel = Var (Labeled {label = TokSpan 525 525, unLabel = Ident {unIdent = "custSet"}})}]]})})})})}) (Labeled {label = TokSpan 529 586, unLabel = Parens (Labeled {label = TokPos 535, unLabel = Fun2 "&" (Labeled {label = TokSpan 530 534, unLabel = Parens (Labeled {label = TokPos 532, unLabel = Fun2 "==" (Labeled {label = TokSpan 531 531, unLabel = Var (Labeled {label = TokSpan 531 531, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 533 533, unLabel = Var (Labeled {label = TokSpan 533 533, unLabel = Ident {unIdent = "lastQueueNo"}})})})}) (Labeled {label = TokSpan 536 585, unLabel = PrefixExp (Labeled {label = TokSpan 536 536, unLabel = Var (Labeled {label = TokSpan 536 536, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 537 538, unLabel = OutComm (Labeled {label = TokSpan 538 538, unLabel = Var (Labeled {label = TokSpan 538 538, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 539 540, unLabel = OutComm (Labeled {label = TokSpan 540 540, unLabel = Var (Labeled {label = TokSpan 540 540, unLabel = Ident {unIdent = "no"}})})}] (Labeled {label = TokSpan 542 585, unLabel = PrefixExp (Labeled {label = TokSpan 542 542, unLabel = Var (Labeled {label = TokSpan 542 542, unLabel = Ident {unIdent = "leaveQueue"}})}) [Labeled {label = TokSpan 543 544, unLabel = OutComm (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 545 546, unLabel = InComm (Labeled {label = TokSpan 546 546, unLabel = VarPat (Labeled {label = TokSpan 546 546, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 548 585, unLabel = Parens (Labeled {label = TokSpan 549 584, unLabel = Ifte (Labeled {label = TokSpan 550 557, unLabel = Parens (Labeled {label = TokSpan 551 556, unLabel = CallBuiltIn (Labeled {label = TokSpan 551 551, unLabel = BuiltIn "member"}) [[Labeled {label = TokSpan 553 553, unLabel = Var (Labeled {label = TokSpan 553 553, unLabel = Ident {unIdent = "cc"}})},Labeled {label = TokSpan 555 555, unLabel = Var (Labeled {label = TokSpan 555 555, unLabel = Ident {unIdent = "custSet"}})}]]})}) (Labeled {label = TokSpan 559 582, unLabel = PrefixExp (Labeled {label = TokSpan 559 559, unLabel = Var (Labeled {label = TokSpan 559 559, unLabel = Ident {unIdent = "com3"}})}) [Labeled {label = TokSpan 560 561, unLabel = OutComm (Labeled {label = TokSpan 561 561, unLabel = Var (Labeled {label = TokSpan 561 561, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 563 582, unLabel = CallFunction (Labeled {label = TokSpan 563 563, unLabel = Var (Labeled {label = TokSpan 563 563, unLabel = Ident {unIdent = "QCtrl"}})}) [[Labeled {label = TokPos 566, unLabel = Fun2 "-" (Labeled {label = TokSpan 565 565, unLabel = Var (Labeled {label = TokSpan 565 565, unLabel = Ident {unIdent = "s"}})}) (Labeled {label = TokSpan 567 567, unLabel = IntExp 1})},Labeled {label = TokSpan 569 572, unLabel = CallFunction (Labeled {label = TokSpan 569 569, unLabel = Var (Labeled {label = TokSpan 569 569, unLabel = Ident {unIdent = "inc"}})}) [[Labeled {label = TokSpan 571 571, unLabel = Var (Labeled {label = TokSpan 571 571, unLabel = Ident {unIdent = "queueNo"}})}]]},Labeled {label = TokSpan 574 581, unLabel = CallBuiltIn (Labeled {label = TokSpan 574 574, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 576 576, unLabel = Var (Labeled {label = TokSpan 576 576, unLabel = Ident {unIdent = "custSet"}})},Labeled {label = TokSpan 578 580, unLabel = SetEnum [Labeled {label = TokSpan 579 579, unLabel = Var (Labeled {label = TokSpan 579 579, unLabel = Ident {unIdent = "cc"}})}]}]]}]]})}) (Labeled {label = TokSpan 584 584, unLabel = Var (Labeled {label = TokSpan 584 584, unLabel = Ident {unIdent = "DIV"}})})})})})})})})}) (Labeled {label = TokSpan 588 602, unLabel = Parens (Labeled {label = TokPos 594, unLabel = Fun2 "&" (Labeled {label = TokSpan 589 593, unLabel = Parens (Labeled {label = TokPos 591, unLabel = Fun2 "==" (Labeled {label = TokSpan 590 590, unLabel = Var (Labeled {label = TokSpan 590 590, unLabel = Ident {unIdent = "queueNo"}})}) (Labeled {label = TokSpan 592 592, unLabel = Var (Labeled {label = TokSpan 592 592, unLabel = Ident {unIdent = "lastQueueNo"}})})})}) (Labeled {label = TokSpan 595 601, unLabel = PrefixExp (Labeled {label = TokSpan 595 595, unLabel = Var (Labeled {label = TokSpan 595 595, unLabel = Ident {unIdent = "queryQueueEmpty"}})}) [Labeled {label = TokSpan 596 597, unLabel = OutComm (Labeled {label = TokSpan 597 597, unLabel = Var (Labeled {label = TokSpan 597 597, unLabel = Ident {unIdent = "queueNo"}})})},Labeled {label = TokSpan 598 599, unLabel = OutComm (Labeled {label = TokSpan 599 599, unLabel = Var (Labeled {label = TokSpan 599 599, unLabel = Ident {unIdent = "yes"}})})}] (Labeled {label = TokSpan 601 601, unLabel = Var (Labeled {label = TokSpan 601 601, unLabel = Ident {unIdent = "DIV"}})})})})})})]},Labeled {label = TokSpan 608 618, unLabel = PatBind (Labeled {label = TokSpan 608 608, unLabel = VarPat (Labeled {label = TokSpan 608 608, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 610 618, unLabel = Closure [Labeled {label = TokSpan 611 611, unLabel = Var (Labeled {label = TokSpan 611 611, unLabel = Ident {unIdent = "com1"}})},Labeled {label = TokSpan 613 613, unLabel = Var (Labeled {label = TokSpan 613 613, unLabel = Ident {unIdent = "com3"}})},Labeled {label = TokSpan 615 615, unLabel = Var (Labeled {label = TokSpan 615 615, unLabel = Ident {unIdent = "canJoinResponse"}})},Labeled {label = TokSpan 617 617, unLabel = Var (Labeled {label = TokSpan 617 617, unLabel = Ident {unIdent = "retrieveCustomer"}})}]})},Labeled {label = TokSpan 619 627, unLabel = PatBind (Labeled {label = TokSpan 619 619, unLabel = VarPat (Labeled {label = TokSpan 619 619, unLabel = Ident {unIdent = "B"}})}) (Labeled {label = TokSpan 621 627, unLabel = Closure [Labeled {label = TokSpan 622 622, unLabel = Var (Labeled {label = TokSpan 622 622, unLabel = Ident {unIdent = "joinQueue"}})},Labeled {label = TokSpan 624 624, unLabel = Var (Labeled {label = TokSpan 624 624, unLabel = Ident {unIdent = "leaveQueue"}})},Labeled {label = TokSpan 626 626, unLabel = Var (Labeled {label = TokSpan 626 626, unLabel = Ident {unIdent = "queryQueueEmpty"}})}]})},Labeled {label = TokSpan 628 641, unLabel = PatBind (Labeled {label = TokSpan 628 628, unLabel = VarPat (Labeled {label = TokSpan 628 628, unLabel = Ident {unIdent = "BankSystem"}})}) (Labeled {label = TokPos 635, unLabel = Fun2 "\\" (Labeled {label = TokSpan 631 633, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 632 632, unLabel = Var (Labeled {label = TokSpan 632 632, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 630 630, unLabel = Var (Labeled {label = TokSpan 630 630, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 634 634, unLabel = Var (Labeled {label = TokSpan 634 634, unLabel = Ident {unIdent = "QueuesCtrl"}})})}) (Labeled {label = TokSpan 636 641, unLabel = CallBuiltIn (Labeled {label = TokSpan 636 636, unLabel = BuiltIn "union"}) [[Labeled {label = TokSpan 638 638, unLabel = Var (Labeled {label = TokSpan 638 638, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 640 640, unLabel = Var (Labeled {label = TokSpan 640 640, unLabel = Ident {unIdent = "B"}})}]]})})},Labeled {label = TokSpan 642 648, unLabel = PatBind (Labeled {label = TokSpan 642 642, unLabel = VarPat (Labeled {label = TokSpan 642 642, unLabel = Ident {unIdent = "FullBankSystem"}})}) (Labeled {label = TokSpan 645 647, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 646 646, unLabel = Var (Labeled {label = TokSpan 646 646, unLabel = Ident {unIdent = "A"}})}) (Labeled {label = TokSpan 644 644, unLabel = Var (Labeled {label = TokSpan 644 644, unLabel = Ident {unIdent = "CounterCtrl"}})}) (Labeled {label = TokSpan 648 648, unLabel = Var (Labeled {label = TokSpan 648 648, unLabel = Ident {unIdent = "QueuesCtrl"}})})})},Labeled {label = TokSpan 649 660, unLabel = PatBind (Labeled {label = TokSpan 649 649, unLabel = VarPat (Labeled {label = TokSpan 649 649, unLabel = Ident {unIdent = "SPEC"}})}) (Labeled {label = TokSpan 651 660, unLabel = ProcRepInterleave [Labeled {label = TokSpan 652 658, unLabel = Generator (Labeled {label = TokSpan 652 652, unLabel = VarPat (Labeled {label = TokSpan 652 652, unLabel = Ident {unIdent = "i"}})}) (Labeled {label = TokSpan 654 658, unLabel = SetClose (Labeled {label = TokSpan 655 655, unLabel = IntExp 1},Labeled {label = TokSpan 657 657, unLabel = Var (Labeled {label = TokSpan 657 657, unLabel = Ident {unIdent = "maxLimit"}})})})}] (Labeled {label = TokSpan 660 660, unLabel = Var (Labeled {label = TokSpan 660 660, unLabel = Ident {unIdent = "CUST"}})})})},Labeled {label = TokSpan 661 683, unLabel = PatBind (Labeled {label = TokSpan 661 661, unLabel = VarPat (Labeled {label = TokSpan 661 661, unLabel = Ident {unIdent = "CUST"}})}) (Labeled {label = TokSpan 663 683, unLabel = PrefixExp (Labeled {label = TokSpan 663 663, unLabel = Var (Labeled {label = TokSpan 663 663, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 664 665, unLabel = InComm (Labeled {label = TokSpan 665 665, unLabel = VarPat (Labeled {label = TokSpan 665 665, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 667 683, unLabel = Parens (Labeled {label = TokPos 673, unLabel = Fun2 "[]" (Labeled {label = TokSpan 668 672, unLabel = PrefixExp (Labeled {label = TokSpan 668 668, unLabel = Var (Labeled {label = TokSpan 668 668, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 669 670, unLabel = OutComm (Labeled {label = TokSpan 670 670, unLabel = Var (Labeled {label = TokSpan 670 670, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 672 672, unLabel = Var (Labeled {label = TokSpan 672 672, unLabel = Ident {unIdent = "CUST"}})})}) (Labeled {label = TokSpan 674 682, unLabel = PrefixExp (Labeled {label = TokSpan 674 674, unLabel = Var (Labeled {label = TokSpan 674 674, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 675 676, unLabel = OutComm (Labeled {label = TokSpan 676 676, unLabel = Var (Labeled {label = TokSpan 676 676, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 678 682, unLabel = PrefixExp (Labeled {label = TokSpan 678 678, unLabel = Var (Labeled {label = TokSpan 678 678, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 679 680, unLabel = OutComm (Labeled {label = TokSpan 680 680, unLabel = Var (Labeled {label = TokSpan 680 680, unLabel = Ident {unIdent = "i"}})})}] (Labeled {label = TokSpan 682 682, unLabel = Var (Labeled {label = TokSpan 682 682, unLabel = Ident {unIdent = "CUST"}})})})})})})})},Labeled {label = TokSpan 686 689, unLabel = AssertRef (Labeled {label = TokSpan 687 687, unLabel = Var (Labeled {label = TokSpan 687 687, unLabel = Ident {unIdent = "SPEC"}})}) "[T=" (Labeled {label = TokSpan 689 689, unLabel = Var (Labeled {label = TokSpan 689 689, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 690 693, unLabel = AssertRef (Labeled {label = TokSpan 691 691, unLabel = Var (Labeled {label = TokSpan 691 691, unLabel = Ident {unIdent = "SPEC"}})}) "[F=" (Labeled {label = TokSpan 693 693, unLabel = Var (Labeled {label = TokSpan 693 693, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 695 700, unLabel = PatBind (Labeled {label = TokSpan 695 695, unLabel = VarPat (Labeled {label = TokSpan 695 695, unLabel = Ident {unIdent = "SPEC2"}})}) (Labeled {label = TokSpan 697 700, unLabel = CallFunction (Labeled {label = TokSpan 697 697, unLabel = Var (Labeled {label = TokSpan 697 697, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 699 699, unLabel = IntExp 0}]]})},Labeled {label = TokSpan 701 701, unLabel = FunBind (Labeled {label = TokSpan 701 701, unLabel = Ident {unIdent = "NEWSPEC"}}) [FunCase [[Labeled {label = TokSpan 703 703, unLabel = VarPat (Labeled {label = TokSpan 703 703, unLabel = Ident {unIdent = "num"}})}]] (Labeled {label = TokPos 735, unLabel = Fun2 "[]" (Labeled {label = TokPos 709, unLabel = Fun2 "&" (Labeled {label = TokPos 707, unLabel = Fun2 "<" (Labeled {label = TokSpan 706 706, unLabel = Var (Labeled {label = TokSpan 706 706, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 708 708, unLabel = Var (Labeled {label = TokSpan 708 708, unLabel = Ident {unIdent = "maxLimit"}})})}) (Labeled {label = TokSpan 710 734, unLabel = PrefixExp (Labeled {label = TokSpan 710 710, unLabel = Var (Labeled {label = TokSpan 710 710, unLabel = Ident {unIdent = "enterBank"}})}) [Labeled {label = TokSpan 711 712, unLabel = InComm (Labeled {label = TokSpan 712 712, unLabel = VarPat (Labeled {label = TokSpan 712 712, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 714 734, unLabel = Parens (Labeled {label = TokPos 725, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 715 724, unLabel = PrefixExp (Labeled {label = TokSpan 715 715, unLabel = Var (Labeled {label = TokSpan 715 715, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 716 717, unLabel = OutComm (Labeled {label = TokSpan 717 717, unLabel = Var (Labeled {label = TokSpan 717 717, unLabel = Ident {unIdent = "success"}})})}] (Labeled {label = TokSpan 719 724, unLabel = CallFunction (Labeled {label = TokSpan 719 719, unLabel = Var (Labeled {label = TokSpan 719 719, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 722, unLabel = Fun2 "+" (Labeled {label = TokSpan 721 721, unLabel = Var (Labeled {label = TokSpan 721 721, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 723 723, unLabel = IntExp 1})}]]})}) (Labeled {label = TokSpan 726 733, unLabel = PrefixExp (Labeled {label = TokSpan 726 726, unLabel = Var (Labeled {label = TokSpan 726 726, unLabel = Ident {unIdent = "report"}})}) [Labeled {label = TokSpan 727 728, unLabel = OutComm (Labeled {label = TokSpan 728 728, unLabel = Var (Labeled {label = TokSpan 728 728, unLabel = Ident {unIdent = "fail"}})})}] (Labeled {label = TokSpan 730 733, unLabel = CallFunction (Labeled {label = TokSpan 730 730, unLabel = Var (Labeled {label = TokSpan 730 730, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokSpan 732 732, unLabel = Var (Labeled {label = TokSpan 732 732, unLabel = Ident {unIdent = "num"}})}]]})})})})})}) (Labeled {label = TokPos 739, unLabel = Fun2 "&" (Labeled {label = TokPos 738, unLabel = Fun2 ">" (Labeled {label = TokSpan 736 736, unLabel = Var (Labeled {label = TokSpan 736 736, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 738 738, unLabel = IntExp 0})}) (Labeled {label = TokSpan 740 754, unLabel = ProcRepInternalChoice [Labeled {label = TokSpan 741 743, unLabel = Generator (Labeled {label = TokSpan 741 741, unLabel = VarPat (Labeled {label = TokSpan 741 741, unLabel = Ident {unIdent = "cc"}})}) (Labeled {label = TokSpan 743 743, unLabel = Var (Labeled {label = TokSpan 743 743, unLabel = Ident {unIdent = "CUSTOMER"}})})}] (Labeled {label = TokSpan 745 754, unLabel = PrefixExp (Labeled {label = TokSpan 745 745, unLabel = Var (Labeled {label = TokSpan 745 745, unLabel = Ident {unIdent = "leaveBank"}})}) [Labeled {label = TokSpan 746 747, unLabel = OutComm (Labeled {label = TokSpan 747 747, unLabel = Var (Labeled {label = TokSpan 747 747, unLabel = Ident {unIdent = "cc"}})})}] (Labeled {label = TokSpan 749 754, unLabel = CallFunction (Labeled {label = TokSpan 749 749, unLabel = Var (Labeled {label = TokSpan 749 749, unLabel = Ident {unIdent = "NEWSPEC"}})}) [[Labeled {label = TokPos 752, unLabel = Fun2 "-" (Labeled {label = TokSpan 751 751, unLabel = Var (Labeled {label = TokSpan 751 751, unLabel = Ident {unIdent = "num"}})}) (Labeled {label = TokSpan 753 753, unLabel = IntExp 1})}]]})})})})})]},Labeled {label = TokSpan 755 758, unLabel = AssertRef (Labeled {label = TokSpan 756 756, unLabel = Var (Labeled {label = TokSpan 756 756, unLabel = Ident {unIdent = "SPEC2"}})}) "[T=" (Labeled {label = TokSpan 758 758, unLabel = Var (Labeled {label = TokSpan 758 758, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 759 762, unLabel = AssertRef (Labeled {label = TokSpan 760 760, unLabel = Var (Labeled {label = TokSpan 760 760, unLabel = Ident {unIdent = "SPEC2"}})}) "[F=" (Labeled {label = TokSpan 762 762, unLabel = Var (Labeled {label = TokSpan 762 762, unLabel = Ident {unIdent = "BankSystem"}})})},Labeled {label = TokSpan 763 764, unLabel = Channel [Labeled {label = TokSpan 764 764, unLabel = Ident {unIdent = "a"}}] Nothing},Labeled {label = TokSpan 765 771, unLabel = PatBind (Labeled {label = TokSpan 765 765, unLabel = VarPat (Labeled {label = TokSpan 765 765, unLabel = Ident {unIdent = "DIV"}})}) (Labeled {label = TokPos 768, unLabel = Fun2 "\\" (Labeled {label = TokSpan 767 767, unLabel = Var (Labeled {label = TokSpan 767 767, unLabel = Ident {unIdent = "LOOP"}})}) (Labeled {label = TokSpan 769 771, unLabel = SetEnum [Labeled {label = TokSpan 770 770, unLabel = Var (Labeled {label = TokSpan 770 770, unLabel = Ident {unIdent = "a"}})}]})})},Labeled {label = TokSpan 772 776, unLabel = PatBind (Labeled {label = TokSpan 772 772, unLabel = VarPat (Labeled {label = TokSpan 772 772, unLabel = Ident {unIdent = "LOOP"}})}) (Labeled {label = TokSpan 774 776, unLabel = PrefixExp (Labeled {label = TokSpan 774 774, unLabel = Var (Labeled {label = TokSpan 774 774, unLabel = Ident {unIdent = "a"}})}) [] (Labeled {label = TokSpan 776 776, unLabel = Var (Labeled {label = TokSpan 776 776, unLabel = Ident {unIdent = "LOOP"}})})})}]}
