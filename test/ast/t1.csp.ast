Labeled {label = TokSpan 6 1419, unLabel = Module [Labeled {label = TokSpan 6 7, unLabel = Channel [Labeled {label = TokSpan 7 7, unLabel = Ident {unIdent = "tock"}}] Nothing},Labeled {label = TokSpan 10 19, unLabel = DataType (Labeled {label = TokSpan 11 11, unLabel = Ident {unIdent = "GateControl"}}) [Labeled {label = TokSpan 13 13, unLabel = Constructor (Labeled {label = TokSpan 13 13, unLabel = Ident {unIdent = "go_down"}}) Nothing},Labeled {label = TokSpan 15 15, unLabel = Constructor (Labeled {label = TokSpan 15 15, unLabel = Ident {unIdent = "go_up"}}) Nothing},Labeled {label = TokSpan 17 17, unLabel = Constructor (Labeled {label = TokSpan 17 17, unLabel = Ident {unIdent = "up"}}) Nothing},Labeled {label = TokSpan 19 19, unLabel = Constructor (Labeled {label = TokSpan 19 19, unLabel = Ident {unIdent = "down"}}) Nothing}]},Labeled {label = TokSpan 22 25, unLabel = Channel [Labeled {label = TokSpan 23 23, unLabel = Ident {unIdent = "gate"}}] (Just (Labeled {label = TokSpan 25 25, unLabel = TypeDot [Labeled {label = TokSpan 25 25, unLabel = Var (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "GateControl"}})}]}))},Labeled {label = TokSpan 27 28, unLabel = Channel [Labeled {label = TokSpan 28 28, unLabel = Ident {unIdent = "error"}}] Nothing},Labeled {label = TokSpan 32 34, unLabel = PatBind (Labeled {label = TokSpan 32 32, unLabel = VarPat (Labeled {label = TokSpan 32 32, unLabel = Ident {unIdent = "Segments"}})}) (Labeled {label = TokSpan 34 34, unLabel = IntExp 5})},Labeled {label = TokSpan 36 40, unLabel = PatBind (Labeled {label = TokSpan 36 36, unLabel = VarPat (Labeled {label = TokSpan 36 36, unLabel = Ident {unIdent = "LastSeg"}})}) (Labeled {label = TokPos 39, unLabel = Fun2 "-" (Labeled {label = TokSpan 38 38, unLabel = Var (Labeled {label = TokSpan 38 38, unLabel = Ident {unIdent = "Segments"}})}) (Labeled {label = TokSpan 40 40, unLabel = IntExp 1})})},Labeled {label = TokSpan 41 47, unLabel = PatBind (Labeled {label = TokSpan 41 41, unLabel = VarPat (Labeled {label = TokSpan 41 41, unLabel = Ident {unIdent = "TRACKS"}})}) (Labeled {label = TokSpan 43 47, unLabel = SetClose (Labeled {label = TokSpan 44 44, unLabel = IntExp 0},Labeled {label = TokSpan 46 46, unLabel = Var (Labeled {label = TokSpan 46 46, unLabel = Ident {unIdent = "LastSeg"}})})})},Labeled {label = TokSpan 48 54, unLabel = PatBind (Labeled {label = TokSpan 48 48, unLabel = VarPat (Labeled {label = TokSpan 48 48, unLabel = Ident {unIdent = "REALTRACKS"}})}) (Labeled {label = TokSpan 50 54, unLabel = SetClose (Labeled {label = TokSpan 51 51, unLabel = IntExp 1},Labeled {label = TokSpan 53 53, unLabel = Var (Labeled {label = TokSpan 53 53, unLabel = Ident {unIdent = "LastSeg"}})})})},Labeled {label = TokSpan 57 59, unLabel = PatBind (Labeled {label = TokSpan 57 57, unLabel = VarPat (Labeled {label = TokSpan 57 57, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 59 59, unLabel = IntExp 3})},Labeled {label = TokSpan 61 66, unLabel = DataType (Labeled {label = TokSpan 62 62, unLabel = Ident {unIdent = "TRAINS"}}) [Labeled {label = TokSpan 64 64, unLabel = Constructor (Labeled {label = TokSpan 64 64, unLabel = Ident {unIdent = "Thomas"}}) Nothing},Labeled {label = TokSpan 66 66, unLabel = Constructor (Labeled {label = TokSpan 66 66, unLabel = Ident {unIdent = "Gordon"}}) Nothing}]},Labeled {label = TokSpan 68 75, unLabel = Channel [Labeled {label = TokSpan 69 69, unLabel = Ident {unIdent = "enter"}},Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "leave"}}] (Just (Labeled {label = TokSpan 73 75, unLabel = TypeDot [Labeled {label = TokSpan 73 73, unLabel = Var (Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "TRACKS"}})},Labeled {label = TokSpan 75 75, unLabel = Var (Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "TRAINS"}})}]}))},Labeled {label = TokSpan 79 84, unLabel = DataType (Labeled {label = TokSpan 80 80, unLabel = Ident {unIdent = "sensed"}}) [Labeled {label = TokSpan 82 82, unLabel = Constructor (Labeled {label = TokSpan 82 82, unLabel = Ident {unIdent = "in"}}) Nothing},Labeled {label = TokSpan 84 84, unLabel = Constructor (Labeled {label = TokSpan 84 84, unLabel = Ident {unIdent = "out"}}) Nothing}]},Labeled {label = TokSpan 85 88, unLabel = Channel [Labeled {label = TokSpan 86 86, unLabel = Ident {unIdent = "sensor"}}] (Just (Labeled {label = TokSpan 88 88, unLabel = TypeDot [Labeled {label = TokSpan 88 88, unLabel = Var (Labeled {label = TokSpan 88 88, unLabel = Ident {unIdent = "sensed"}})}]}))},Labeled {label = TokSpan 91 91, unLabel = FunBind (Labeled {label = TokSpan 91 91, unLabel = Ident {unIdent = "Train"}}) [FunCase [[Labeled {label = TokSpan 93 93, unLabel = VarPat (Labeled {label = TokSpan 93 93, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 95 95, unLabel = VarPat (Labeled {label = TokSpan 95 95, unLabel = Ident {unIdent = "j"}})}]] (Labeled {label = TokSpan 98 129, unLabel = PrefixExp (Labeled {label = TokSpan 98 98, unLabel = Var (Labeled {label = TokSpan 98 98, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 99 108, unLabel = OutComm (Labeled {label = TokSpan 100 108, unLabel = Parens (Labeled {label = TokPos 106, unLabel = Fun2 "%" (Labeled {label = TokSpan 101 105, unLabel = Parens (Labeled {label = TokPos 103, unLabel = Fun2 "+" (Labeled {label = TokSpan 102 102, unLabel = Var (Labeled {label = TokSpan 102 102, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 104 104, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 107 107, unLabel = Var (Labeled {label = TokSpan 107 107, unLabel = Ident {unIdent = "Segments"}})})})})},Labeled {label = TokSpan 109 110, unLabel = OutComm (Labeled {label = TokSpan 110 110, unLabel = Var (Labeled {label = TokSpan 110 110, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 112 129, unLabel = PrefixExp (Labeled {label = TokSpan 112 112, unLabel = Var (Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 113 114, unLabel = OutComm (Labeled {label = TokSpan 114 114, unLabel = Var (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 115 116, unLabel = OutComm (Labeled {label = TokSpan 116 116, unLabel = Var (Labeled {label = TokSpan 116 116, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 118 129, unLabel = CallFunction (Labeled {label = TokSpan 118 118, unLabel = Var (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 120 120, unLabel = Var (Labeled {label = TokSpan 120 120, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokPos 127, unLabel = Fun2 "%" (Labeled {label = TokSpan 122 126, unLabel = Parens (Labeled {label = TokPos 124, unLabel = Fun2 "+" (Labeled {label = TokSpan 123 123, unLabel = Var (Labeled {label = TokSpan 123 123, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 125 125, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 128 128, unLabel = Var (Labeled {label = TokSpan 128 128, unLabel = Ident {unIdent = "Segments"}})})}]]})})})]},Labeled {label = TokSpan 131 145, unLabel = PatBind (Labeled {label = TokSpan 131 131, unLabel = VarPat (Labeled {label = TokSpan 131 131, unLabel = Ident {unIdent = "Trains"}})}) (Labeled {label = TokPos 139, unLabel = Fun2 "|||" (Labeled {label = TokSpan 133 138, unLabel = CallFunction (Labeled {label = TokSpan 133 133, unLabel = Var (Labeled {label = TokSpan 133 133, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 135 135, unLabel = Var (Labeled {label = TokSpan 135 135, unLabel = Ident {unIdent = "Thomas"}})},Labeled {label = TokSpan 137 137, unLabel = IntExp 0}]]}) (Labeled {label = TokSpan 140 145, unLabel = CallFunction (Labeled {label = TokSpan 140 140, unLabel = Var (Labeled {label = TokSpan 140 140, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 142 142, unLabel = Var (Labeled {label = TokSpan 142 142, unLabel = Ident {unIdent = "Gordon"}})},Labeled {label = TokSpan 144 144, unLabel = IntExp 0}]]})})},Labeled {label = TokSpan 148 148, unLabel = FunBind (Labeled {label = TokSpan 148 148, unLabel = Ident {unIdent = "Track"}}) [FunCase [[Labeled {label = TokSpan 150 150, unLabel = VarPat (Labeled {label = TokSpan 150 150, unLabel = Ident {unIdent = "j"}})}]] (Labeled {label = TokSpan 153 204, unLabel = Let [Labeled {label = TokSpan 154 179, unLabel = PatBind (Labeled {label = TokSpan 154 154, unLabel = VarPat (Labeled {label = TokSpan 154 154, unLabel = Ident {unIdent = "Empty"}})}) (Labeled {label = TokSpan 156 179, unLabel = PrefixExp (Labeled {label = TokSpan 156 156, unLabel = Var (Labeled {label = TokSpan 156 156, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 157 158, unLabel = OutComm (Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 159 160, unLabel = InComm (Labeled {label = TokSpan 160 160, unLabel = VarPat (Labeled {label = TokSpan 160 160, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 162 179, unLabel = Ifte (Labeled {label = TokPos 164, unLabel = Fun2 "==" (Labeled {label = TokSpan 163 163, unLabel = Var (Labeled {label = TokSpan 163 163, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 165 165, unLabel = IntExp 1})}) (Labeled {label = TokSpan 167 174, unLabel = PrefixExp (Labeled {label = TokSpan 167 167, unLabel = Var (Labeled {label = TokSpan 167 167, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 168 169, unLabel = OutComm (Labeled {label = TokSpan 169 169, unLabel = Var (Labeled {label = TokSpan 169 169, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 171 174, unLabel = CallFunction (Labeled {label = TokSpan 171 171, unLabel = Var (Labeled {label = TokSpan 171 171, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 173 173, unLabel = Var (Labeled {label = TokSpan 173 173, unLabel = Ident {unIdent = "A"}})}]]})}) (Labeled {label = TokSpan 176 179, unLabel = CallFunction (Labeled {label = TokSpan 176 176, unLabel = Var (Labeled {label = TokSpan 176 176, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 178 178, unLabel = Var (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "A"}})}]]})})})},Labeled {label = TokSpan 180 180, unLabel = FunBind (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "Full"}}) [FunCase [[Labeled {label = TokSpan 182 182, unLabel = VarPat (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "A"}})}]] (Labeled {label = TokSpan 185 202, unLabel = PrefixExp (Labeled {label = TokSpan 185 185, unLabel = Var (Labeled {label = TokSpan 185 185, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 186 187, unLabel = OutComm (Labeled {label = TokSpan 187 187, unLabel = Var (Labeled {label = TokSpan 187 187, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 188 189, unLabel = OutComm (Labeled {label = TokSpan 189 189, unLabel = Var (Labeled {label = TokSpan 189 189, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 191 202, unLabel = Ifte (Labeled {label = TokPos 193, unLabel = Fun2 "==" (Labeled {label = TokSpan 192 192, unLabel = Var (Labeled {label = TokSpan 192 192, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 194 194, unLabel = Var (Labeled {label = TokSpan 194 194, unLabel = Ident {unIdent = "GateSeg"}})})}) (Labeled {label = TokSpan 196 200, unLabel = PrefixExp (Labeled {label = TokSpan 196 196, unLabel = Var (Labeled {label = TokSpan 196 196, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 197 198, unLabel = OutComm (Labeled {label = TokSpan 198 198, unLabel = Var (Labeled {label = TokSpan 198 198, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 200 200, unLabel = Var (Labeled {label = TokSpan 200 200, unLabel = Ident {unIdent = "Empty"}})})}) (Labeled {label = TokSpan 202 202, unLabel = Var (Labeled {label = TokSpan 202 202, unLabel = Ident {unIdent = "Empty"}})})})})]}] (Labeled {label = TokSpan 204 204, unLabel = Var (Labeled {label = TokSpan 204 204, unLabel = Ident {unIdent = "Empty"}})})})]},Labeled {label = TokSpan 207 217, unLabel = PatBind (Labeled {label = TokSpan 207 207, unLabel = VarPat (Labeled {label = TokSpan 207 207, unLabel = Ident {unIdent = "Tracks"}})}) (Labeled {label = TokSpan 209 217, unLabel = ProcRepInterleave [Labeled {label = TokSpan 210 212, unLabel = Generator (Labeled {label = TokSpan 210 210, unLabel = VarPat (Labeled {label = TokSpan 210 210, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 212 212, unLabel = Var (Labeled {label = TokSpan 212 212, unLabel = Ident {unIdent = "REALTRACKS"}})})}] (Labeled {label = TokSpan 214 217, unLabel = CallFunction (Labeled {label = TokSpan 214 214, unLabel = Var (Labeled {label = TokSpan 214 214, unLabel = Ident {unIdent = "Track"}})}) [[Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "j"}})}]]})})},Labeled {label = TokSpan 221 239, unLabel = PatBind (Labeled {label = TokSpan 221 221, unLabel = VarPat (Labeled {label = TokSpan 221 221, unLabel = Ident {unIdent = "Network"}})}) (Labeled {label = TokSpan 224 238, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 225 237, unLabel = ClosureComprehension ([Labeled {label = TokSpan 226 228, unLabel = DotTuple [Labeled {label = TokSpan 226 226, unLabel = Var (Labeled {label = TokSpan 226 226, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 228 228, unLabel = Var (Labeled {label = TokSpan 228 228, unLabel = Ident {unIdent = "j"}})}]},Labeled {label = TokSpan 230 232, unLabel = DotTuple [Labeled {label = TokSpan 230 230, unLabel = Var (Labeled {label = TokSpan 230 230, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 232 232, unLabel = Var (Labeled {label = TokSpan 232 232, unLabel = Ident {unIdent = "j"}})}]}],[Labeled {label = TokSpan 234 236, unLabel = Generator (Labeled {label = TokSpan 234 234, unLabel = VarPat (Labeled {label = TokSpan 234 234, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 236 236, unLabel = Var (Labeled {label = TokSpan 236 236, unLabel = Ident {unIdent = "REALTRACKS"}})})}])}) (Labeled {label = TokSpan 223 223, unLabel = Var (Labeled {label = TokSpan 223 223, unLabel = Ident {unIdent = "Trains"}})}) (Labeled {label = TokSpan 239 239, unLabel = Var (Labeled {label = TokSpan 239 239, unLabel = Ident {unIdent = "Tracks"}})})})},Labeled {label = TokSpan 243 245, unLabel = PatBind (Labeled {label = TokSpan 243 243, unLabel = VarPat (Labeled {label = TokSpan 243 243, unLabel = Ident {unIdent = "SlowTrain"}})}) (Labeled {label = TokSpan 245 245, unLabel = IntExp 4})},Labeled {label = TokSpan 247 249, unLabel = PatBind (Labeled {label = TokSpan 247 247, unLabel = VarPat (Labeled {label = TokSpan 247 247, unLabel = Ident {unIdent = "NormalTrain"}})}) (Labeled {label = TokSpan 249 249, unLabel = IntExp 3})},Labeled {label = TokSpan 250 252, unLabel = PatBind (Labeled {label = TokSpan 250 250, unLabel = VarPat (Labeled {label = TokSpan 250 250, unLabel = Ident {unIdent = "FastTrain"}})}) (Labeled {label = TokSpan 252 252, unLabel = IntExp 2})},Labeled {label = TokSpan 253 255, unLabel = PatBind (Labeled {label = TokSpan 253 253, unLabel = VarPat (Labeled {label = TokSpan 253 253, unLabel = Ident {unIdent = "MaxTocksPerSeg"}})}) (Labeled {label = TokSpan 255 255, unLabel = IntExp 6})},Labeled {label = TokSpan 258 258, unLabel = FunBind (Labeled {label = TokSpan 258 258, unLabel = Ident {unIdent = "SpeedReg"}}) [FunCase [[Labeled {label = TokSpan 260 260, unLabel = VarPat (Labeled {label = TokSpan 260 260, unLabel = Ident {unIdent = "j"}})},Labeled {label = TokSpan 262 262, unLabel = VarPat (Labeled {label = TokSpan 262 262, unLabel = Ident {unIdent = "MinTocksPerSeg"}})}]] (Labeled {label = TokSpan 265 318, unLabel = Let [Labeled {label = TokSpan 266 281, unLabel = PatBind (Labeled {label = TokSpan 266 266, unLabel = VarPat (Labeled {label = TokSpan 266 266, unLabel = Ident {unIdent = "Empty"}})}) (Labeled {label = TokPos 278, unLabel = Fun2 "[]" (Labeled {label = TokSpan 268 277, unLabel = PrefixExp (Labeled {label = TokSpan 268 268, unLabel = Var (Labeled {label = TokSpan 268 268, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 269 270, unLabel = OutComm (Labeled {label = TokSpan 270 270, unLabel = Var (Labeled {label = TokSpan 270 270, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 271 272, unLabel = InComm (Labeled {label = TokSpan 272 272, unLabel = VarPat (Labeled {label = TokSpan 272 272, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 274 277, unLabel = CallFunction (Labeled {label = TokSpan 274 274, unLabel = Var (Labeled {label = TokSpan 274 274, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 276 276, unLabel = IntExp 0}]]})}) (Labeled {label = TokSpan 279 281, unLabel = PrefixExp (Labeled {label = TokSpan 279 279, unLabel = Var (Labeled {label = TokSpan 279 279, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 281 281, unLabel = Var (Labeled {label = TokSpan 281 281, unLabel = Ident {unIdent = "Empty"}})})})})},Labeled {label = TokSpan 282 282, unLabel = FunBind (Labeled {label = TokSpan 282 282, unLabel = Ident {unIdent = "Full"}}) [FunCase [[Labeled {label = TokSpan 284 284, unLabel = VarPat (Labeled {label = TokSpan 284 284, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 299, unLabel = Fun2 "[]" (Labeled {label = TokPos 290, unLabel = Fun2 "&" (Labeled {label = TokPos 288, unLabel = Fun2 "<" (Labeled {label = TokSpan 287 287, unLabel = Var (Labeled {label = TokSpan 287 287, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 289 289, unLabel = Var (Labeled {label = TokSpan 289 289, unLabel = Ident {unIdent = "MaxTocksPerSeg"}})})}) (Labeled {label = TokSpan 291 298, unLabel = PrefixExp (Labeled {label = TokSpan 291 291, unLabel = Var (Labeled {label = TokSpan 291 291, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 293 298, unLabel = CallFunction (Labeled {label = TokSpan 293 293, unLabel = Var (Labeled {label = TokSpan 293 293, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokPos 296, unLabel = Fun2 "+" (Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 297 297, unLabel = IntExp 1})}]]})})}) (Labeled {label = TokPos 303, unLabel = Fun2 "&" (Labeled {label = TokPos 301, unLabel = Fun2 "<=" (Labeled {label = TokSpan 300 300, unLabel = Var (Labeled {label = TokSpan 300 300, unLabel = Ident {unIdent = "MinTocksPerSeg"}})}) (Labeled {label = TokSpan 302 302, unLabel = Var (Labeled {label = TokSpan 302 302, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 304 316, unLabel = PrefixExp (Labeled {label = TokSpan 304 304, unLabel = Var (Labeled {label = TokSpan 304 304, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 305 312, unLabel = OutComm (Labeled {label = TokPos 311, unLabel = Fun2 "%" (Labeled {label = TokSpan 306 310, unLabel = Parens (Labeled {label = TokPos 308, unLabel = Fun2 "+" (Labeled {label = TokSpan 307 307, unLabel = Var (Labeled {label = TokSpan 307 307, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 309 309, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 312 312, unLabel = Var (Labeled {label = TokSpan 312 312, unLabel = Ident {unIdent = "Segments"}})})})},Labeled {label = TokSpan 313 314, unLabel = InComm (Labeled {label = TokSpan 314 314, unLabel = VarPat (Labeled {label = TokSpan 314 314, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 316 316, unLabel = Var (Labeled {label = TokSpan 316 316, unLabel = Ident {unIdent = "Empty"}})})})})})]}] (Labeled {label = TokSpan 318 318, unLabel = Var (Labeled {label = TokSpan 318 318, unLabel = Ident {unIdent = "Empty"}})})})]},Labeled {label = TokSpan 322 338, unLabel = PatBind (Labeled {label = TokSpan 322 322, unLabel = VarPat (Labeled {label = TokSpan 322 322, unLabel = Ident {unIdent = "InSensorTiming"}})}) (Labeled {label = TokPos 327, unLabel = Fun2 "[]" (Labeled {label = TokSpan 324 326, unLabel = PrefixExp (Labeled {label = TokSpan 324 324, unLabel = Var (Labeled {label = TokSpan 324 324, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 326 326, unLabel = Var (Labeled {label = TokSpan 326 326, unLabel = Ident {unIdent = "InSensorTiming"}})})}) (Labeled {label = TokSpan 328 338, unLabel = PrefixExp (Labeled {label = TokSpan 328 328, unLabel = Var (Labeled {label = TokSpan 328 328, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 329 330, unLabel = OutComm (Labeled {label = TokSpan 330 330, unLabel = IntExp 1})},Labeled {label = TokSpan 331 332, unLabel = InComm (Labeled {label = TokSpan 332 332, unLabel = VarPat (Labeled {label = TokSpan 332 332, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 334 338, unLabel = PrefixExp (Labeled {label = TokSpan 334 334, unLabel = Var (Labeled {label = TokSpan 334 334, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 335 336, unLabel = OutComm (Labeled {label = TokSpan 336 336, unLabel = Var (Labeled {label = TokSpan 336 336, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 338 338, unLabel = Var (Labeled {label = TokSpan 338 338, unLabel = Ident {unIdent = "InSensorTiming"}})})})})})},Labeled {label = TokSpan 339 355, unLabel = PatBind (Labeled {label = TokSpan 339 339, unLabel = VarPat (Labeled {label = TokSpan 339 339, unLabel = Ident {unIdent = "OutSensorTiming"}})}) (Labeled {label = TokPos 344, unLabel = Fun2 "[]" (Labeled {label = TokSpan 341 343, unLabel = PrefixExp (Labeled {label = TokSpan 341 341, unLabel = Var (Labeled {label = TokSpan 341 341, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 343 343, unLabel = Var (Labeled {label = TokSpan 343 343, unLabel = Ident {unIdent = "OutSensorTiming"}})})}) (Labeled {label = TokSpan 345 355, unLabel = PrefixExp (Labeled {label = TokSpan 345 345, unLabel = Var (Labeled {label = TokSpan 345 345, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 346 347, unLabel = OutComm (Labeled {label = TokSpan 347 347, unLabel = Var (Labeled {label = TokSpan 347 347, unLabel = Ident {unIdent = "GateSeg"}})})},Labeled {label = TokSpan 348 349, unLabel = InComm (Labeled {label = TokSpan 349 349, unLabel = VarPat (Labeled {label = TokSpan 349 349, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 351 355, unLabel = PrefixExp (Labeled {label = TokSpan 351 351, unLabel = Var (Labeled {label = TokSpan 351 351, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 352 353, unLabel = OutComm (Labeled {label = TokSpan 353 353, unLabel = Var (Labeled {label = TokSpan 353 353, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 355 355, unLabel = Var (Labeled {label = TokSpan 355 355, unLabel = Ident {unIdent = "OutSensorTiming"}})})})})})},Labeled {label = TokSpan 361 361, unLabel = FunBind (Labeled {label = TokSpan 361 361, unLabel = Ident {unIdent = "SpeedRegs"}}) [FunCase [[Labeled {label = TokSpan 363 363, unLabel = VarPat (Labeled {label = TokSpan 363 363, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 366 366, unLabel = Stop})]},Labeled {label = TokSpan 369 377, unLabel = PatBind (Labeled {label = TokSpan 369 369, unLabel = VarPat (Labeled {label = TokSpan 369 369, unLabel = Ident {unIdent = "SensorTiming"}})}) (Labeled {label = TokSpan 372 376, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 373 375, unLabel = Closure [Labeled {label = TokSpan 374 374, unLabel = Var (Labeled {label = TokSpan 374 374, unLabel = Ident {unIdent = "tock"}})}]}) (Labeled {label = TokSpan 371 371, unLabel = Var (Labeled {label = TokSpan 371 371, unLabel = Ident {unIdent = "InSensorTiming"}})}) (Labeled {label = TokSpan 377 377, unLabel = Var (Labeled {label = TokSpan 377 377, unLabel = Ident {unIdent = "OutSensorTiming"}})})})},Labeled {label = TokSpan 378 378, unLabel = FunBind (Labeled {label = TokSpan 378 378, unLabel = Ident {unIdent = "NetworkTiming"}}) [FunCase [[Labeled {label = TokSpan 380 380, unLabel = VarPat (Labeled {label = TokSpan 380 380, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 387 395, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 388 394, unLabel = Closure [Labeled {label = TokSpan 389 389, unLabel = Var (Labeled {label = TokSpan 389 389, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 391 393, unLabel = DotTuple [Labeled {label = TokSpan 391 391, unLabel = Var (Labeled {label = TokSpan 391 391, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 393 393, unLabel = IntExp 1}]}]}) (Labeled {label = TokSpan 383 386, unLabel = CallFunction (Labeled {label = TokSpan 383 383, unLabel = Var (Labeled {label = TokSpan 383 383, unLabel = Ident {unIdent = "SpeedRegs"}})}) [[Labeled {label = TokSpan 385 385, unLabel = Var (Labeled {label = TokSpan 385 385, unLabel = Ident {unIdent = "min"}})}]]}) (Labeled {label = TokSpan 396 396, unLabel = Var (Labeled {label = TokSpan 396 396, unLabel = Ident {unIdent = "SensorTiming"}})})})]},Labeled {label = TokSpan 397 397, unLabel = FunBind (Labeled {label = TokSpan 397 397, unLabel = Ident {unIdent = "TimedNetwork"}}) [FunCase [[Labeled {label = TokSpan 399 399, unLabel = VarPat (Labeled {label = TokSpan 399 399, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 403 413, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 404 412, unLabel = Closure [Labeled {label = TokSpan 405 405, unLabel = Var (Labeled {label = TokSpan 405 405, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 407 407, unLabel = Var (Labeled {label = TokSpan 407 407, unLabel = Ident {unIdent = "sensor"}})},Labeled {label = TokSpan 409 411, unLabel = DotTuple [Labeled {label = TokSpan 409 409, unLabel = Var (Labeled {label = TokSpan 409 409, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 411 411, unLabel = Var (Labeled {label = TokSpan 411 411, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 402 402, unLabel = Var (Labeled {label = TokSpan 402 402, unLabel = Ident {unIdent = "Network"}})}) (Labeled {label = TokSpan 414 417, unLabel = CallFunction (Labeled {label = TokSpan 414 414, unLabel = Var (Labeled {label = TokSpan 414 414, unLabel = Ident {unIdent = "NetworkTiming"}})}) [[Labeled {label = TokSpan 416 416, unLabel = Var (Labeled {label = TokSpan 416 416, unLabel = Ident {unIdent = "min"}})}]]})})]},Labeled {label = TokSpan 426 608, unLabel = PatBind (Labeled {label = TokSpan 426 426, unLabel = VarPat (Labeled {label = TokSpan 426 426, unLabel = Ident {unIdent = "Controller"}})}) (Labeled {label = TokSpan 428 608, unLabel = Let [Labeled {label = TokSpan 434 457, unLabel = PatBind (Labeled {label = TokSpan 434 434, unLabel = VarPat (Labeled {label = TokSpan 434 434, unLabel = Ident {unIdent = "ControllerUp"}})}) (Labeled {label = TokPos 454, unLabel = Fun2 "[]" (Labeled {label = TokPos 448, unLabel = Fun2 "[]" (Labeled {label = TokSpan 436 447, unLabel = PrefixExp (Labeled {label = TokSpan 436 436, unLabel = Var (Labeled {label = TokSpan 436 436, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 437 438, unLabel = OutComm (Labeled {label = TokSpan 438 438, unLabel = Var (Labeled {label = TokSpan 438 438, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 440 447, unLabel = PrefixExp (Labeled {label = TokSpan 440 440, unLabel = Var (Labeled {label = TokSpan 440 440, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 441 442, unLabel = OutComm (Labeled {label = TokSpan 442 442, unLabel = Var (Labeled {label = TokSpan 442 442, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 444 447, unLabel = CallFunction (Labeled {label = TokSpan 444 444, unLabel = Var (Labeled {label = TokSpan 444 444, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 446 446, unLabel = IntExp 1}]]})})}) (Labeled {label = TokSpan 449 453, unLabel = PrefixExp (Labeled {label = TokSpan 449 449, unLabel = Var (Labeled {label = TokSpan 449 449, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 450 451, unLabel = OutComm (Labeled {label = TokSpan 451 451, unLabel = Var (Labeled {label = TokSpan 451 451, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 453 453, unLabel = Var (Labeled {label = TokSpan 453 453, unLabel = Ident {unIdent = "ERROR"}})})})}) (Labeled {label = TokSpan 455 457, unLabel = PrefixExp (Labeled {label = TokSpan 455 455, unLabel = Var (Labeled {label = TokSpan 455 455, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 457 457, unLabel = Var (Labeled {label = TokSpan 457 457, unLabel = Ident {unIdent = "ControllerUp"}})})})})},Labeled {label = TokSpan 467 467, unLabel = FunBind (Labeled {label = TokSpan 467 467, unLabel = Ident {unIdent = "ControllerGoingDown"}}) [FunCase [[Labeled {label = TokSpan 469 469, unLabel = VarPat (Labeled {label = TokSpan 469 469, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 507, unLabel = Fun2 "[]" (Labeled {label = TokPos 500, unLabel = Fun2 "[]" (Labeled {label = TokPos 491, unLabel = Fun2 "[]" (Labeled {label = TokSpan 472 490, unLabel = Parens (Labeled {label = TokSpan 473 489, unLabel = Ifte (Labeled {label = TokPos 475, unLabel = Fun2 "<" (Labeled {label = TokSpan 474 474, unLabel = Var (Labeled {label = TokSpan 474 474, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 476 476, unLabel = Var (Labeled {label = TokSpan 476 476, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 478 478, unLabel = Var (Labeled {label = TokSpan 478 478, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 480 489, unLabel = PrefixExp (Labeled {label = TokSpan 480 480, unLabel = Var (Labeled {label = TokSpan 480 480, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 481 482, unLabel = OutComm (Labeled {label = TokSpan 482 482, unLabel = Var (Labeled {label = TokSpan 482 482, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 484 489, unLabel = CallFunction (Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokPos 487, unLabel = Fun2 "+" (Labeled {label = TokSpan 486 486, unLabel = Var (Labeled {label = TokSpan 486 486, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 488 488, unLabel = IntExp 1})}]]})})})}) (Labeled {label = TokSpan 492 499, unLabel = PrefixExp (Labeled {label = TokSpan 492 492, unLabel = Var (Labeled {label = TokSpan 492 492, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 493 494, unLabel = OutComm (Labeled {label = TokSpan 494 494, unLabel = Var (Labeled {label = TokSpan 494 494, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 496 499, unLabel = CallFunction (Labeled {label = TokSpan 496 496, unLabel = Var (Labeled {label = TokSpan 496 496, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokSpan 498 498, unLabel = Var (Labeled {label = TokSpan 498 498, unLabel = Ident {unIdent = "n"}})}]]})})}) (Labeled {label = TokSpan 501 506, unLabel = PrefixExp (Labeled {label = TokSpan 501 501, unLabel = Var (Labeled {label = TokSpan 501 501, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 503 506, unLabel = CallFunction (Labeled {label = TokSpan 503 503, unLabel = Var (Labeled {label = TokSpan 503 503, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 505 505, unLabel = Var (Labeled {label = TokSpan 505 505, unLabel = Ident {unIdent = "n"}})}]]})})}) (Labeled {label = TokSpan 508 512, unLabel = PrefixExp (Labeled {label = TokSpan 508 508, unLabel = Var (Labeled {label = TokSpan 508 508, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 509 510, unLabel = OutComm (Labeled {label = TokSpan 510 510, unLabel = Var (Labeled {label = TokSpan 510 510, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 512 512, unLabel = Var (Labeled {label = TokSpan 512 512, unLabel = Ident {unIdent = "ERROR"}})})})})]},Labeled {label = TokSpan 519 519, unLabel = FunBind (Labeled {label = TokSpan 519 519, unLabel = Ident {unIdent = "ControllerDown"}}) [FunCase [[Labeled {label = TokSpan 521 521, unLabel = VarPat (Labeled {label = TokSpan 521 521, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 567, unLabel = Fun2 "[]" (Labeled {label = TokPos 543, unLabel = Fun2 "[]" (Labeled {label = TokSpan 524 542, unLabel = Parens (Labeled {label = TokSpan 525 541, unLabel = Ifte (Labeled {label = TokPos 527, unLabel = Fun2 "<" (Labeled {label = TokSpan 526 526, unLabel = Var (Labeled {label = TokSpan 526 526, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 528 528, unLabel = Var (Labeled {label = TokSpan 528 528, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 530 530, unLabel = Var (Labeled {label = TokSpan 530 530, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 532 541, unLabel = PrefixExp (Labeled {label = TokSpan 532 532, unLabel = Var (Labeled {label = TokSpan 532 532, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 533 534, unLabel = OutComm (Labeled {label = TokSpan 534 534, unLabel = Var (Labeled {label = TokSpan 534 534, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 536 541, unLabel = CallFunction (Labeled {label = TokSpan 536 536, unLabel = Var (Labeled {label = TokSpan 536 536, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokPos 539, unLabel = Fun2 "+" (Labeled {label = TokSpan 538 538, unLabel = Var (Labeled {label = TokSpan 538 538, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 540 540, unLabel = IntExp 1})}]]})})})}) (Labeled {label = TokSpan 544 566, unLabel = PrefixExp (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 545 546, unLabel = OutComm (Labeled {label = TokSpan 546 546, unLabel = Var (Labeled {label = TokSpan 546 546, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 548 566, unLabel = Parens (Labeled {label = TokSpan 549 565, unLabel = Ifte (Labeled {label = TokPos 551, unLabel = Fun2 "==" (Labeled {label = TokSpan 550 550, unLabel = Var (Labeled {label = TokSpan 550 550, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 552 552, unLabel = IntExp 1})}) (Labeled {label = TokSpan 554 558, unLabel = PrefixExp (Labeled {label = TokSpan 554 554, unLabel = Var (Labeled {label = TokSpan 554 554, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 555 556, unLabel = OutComm (Labeled {label = TokSpan 556 556, unLabel = Var (Labeled {label = TokSpan 556 556, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 558 558, unLabel = Var (Labeled {label = TokSpan 558 558, unLabel = Ident {unIdent = "ControllerGoingUp"}})})}) (Labeled {label = TokSpan 560 565, unLabel = CallFunction (Labeled {label = TokSpan 560 560, unLabel = Var (Labeled {label = TokSpan 560 560, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokPos 563, unLabel = Fun2 "-" (Labeled {label = TokSpan 562 562, unLabel = Var (Labeled {label = TokSpan 562 562, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 564 564, unLabel = IntExp 1})}]]})})})})}) (Labeled {label = TokSpan 568 573, unLabel = PrefixExp (Labeled {label = TokSpan 568 568, unLabel = Var (Labeled {label = TokSpan 568 568, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 570 573, unLabel = CallFunction (Labeled {label = TokSpan 570 570, unLabel = Var (Labeled {label = TokSpan 570 570, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokSpan 572 572, unLabel = Var (Labeled {label = TokSpan 572 572, unLabel = Ident {unIdent = "n"}})}]]})})})]},Labeled {label = TokSpan 577 606, unLabel = PatBind (Labeled {label = TokSpan 577 577, unLabel = VarPat (Labeled {label = TokSpan 577 577, unLabel = Ident {unIdent = "ControllerGoingUp"}})}) (Labeled {label = TokPos 601, unLabel = Fun2 "[]" (Labeled {label = TokPos 588, unLabel = Fun2 "[]" (Labeled {label = TokPos 584, unLabel = Fun2 "[]" (Labeled {label = TokSpan 579 583, unLabel = PrefixExp (Labeled {label = TokSpan 579 579, unLabel = Var (Labeled {label = TokSpan 579 579, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 580 581, unLabel = OutComm (Labeled {label = TokSpan 581 581, unLabel = Var (Labeled {label = TokSpan 581 581, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 583 583, unLabel = Var (Labeled {label = TokSpan 583 583, unLabel = Ident {unIdent = "ControllerUp"}})})}) (Labeled {label = TokSpan 585 587, unLabel = PrefixExp (Labeled {label = TokSpan 585 585, unLabel = Var (Labeled {label = TokSpan 585 585, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 587 587, unLabel = Var (Labeled {label = TokSpan 587 587, unLabel = Ident {unIdent = "ControllerGoingUp"}})})})}) (Labeled {label = TokSpan 589 600, unLabel = PrefixExp (Labeled {label = TokSpan 589 589, unLabel = Var (Labeled {label = TokSpan 589 589, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 590 591, unLabel = OutComm (Labeled {label = TokSpan 591 591, unLabel = Var (Labeled {label = TokSpan 591 591, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 593 600, unLabel = PrefixExp (Labeled {label = TokSpan 593 593, unLabel = Var (Labeled {label = TokSpan 593 593, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 594 595, unLabel = OutComm (Labeled {label = TokSpan 595 595, unLabel = Var (Labeled {label = TokSpan 595 595, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 597 600, unLabel = CallFunction (Labeled {label = TokSpan 597 597, unLabel = Var (Labeled {label = TokSpan 597 597, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 599 599, unLabel = IntExp 1}]]})})})}) (Labeled {label = TokSpan 602 606, unLabel = PrefixExp (Labeled {label = TokSpan 602 602, unLabel = Var (Labeled {label = TokSpan 602 602, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 603 604, unLabel = OutComm (Labeled {label = TokSpan 604 604, unLabel = Var (Labeled {label = TokSpan 604 604, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 606 606, unLabel = Var (Labeled {label = TokSpan 606 606, unLabel = Ident {unIdent = "ERROR"}})})})})}] (Labeled {label = TokSpan 608 608, unLabel = Var (Labeled {label = TokSpan 608 608, unLabel = Ident {unIdent = "ControllerUp"}})})})},Labeled {label = TokSpan 612 616, unLabel = PatBind (Labeled {label = TokSpan 612 612, unLabel = VarPat (Labeled {label = TokSpan 612 612, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 614 616, unLabel = PrefixExp (Labeled {label = TokSpan 614 614, unLabel = Var (Labeled {label = TokSpan 614 614, unLabel = Ident {unIdent = "error"}})}) [] (Labeled {label = TokSpan 616 616, unLabel = Stop})})},Labeled {label = TokSpan 620 622, unLabel = PatBind (Labeled {label = TokSpan 620 620, unLabel = VarPat (Labeled {label = TokSpan 620 620, unLabel = Ident {unIdent = "VeryFastGate"}})}) (Labeled {label = TokSpan 622 622, unLabel = IntExp 3})},Labeled {label = TokSpan 623 625, unLabel = PatBind (Labeled {label = TokSpan 623 623, unLabel = VarPat (Labeled {label = TokSpan 623 623, unLabel = Ident {unIdent = "FastGate"}})}) (Labeled {label = TokSpan 625 625, unLabel = IntExp 4})},Labeled {label = TokSpan 626 628, unLabel = PatBind (Labeled {label = TokSpan 626 626, unLabel = VarPat (Labeled {label = TokSpan 626 626, unLabel = Ident {unIdent = "NormalGate"}})}) (Labeled {label = TokSpan 628 628, unLabel = IntExp 5})},Labeled {label = TokSpan 629 631, unLabel = PatBind (Labeled {label = TokSpan 629 629, unLabel = VarPat (Labeled {label = TokSpan 629 629, unLabel = Ident {unIdent = "SlowGate"}})}) (Labeled {label = TokSpan 631 631, unLabel = IntExp 6})},Labeled {label = TokSpan 632 634, unLabel = PatBind (Labeled {label = TokSpan 632 632, unLabel = VarPat (Labeled {label = TokSpan 632 632, unLabel = Ident {unIdent = "UpTime"}})}) (Labeled {label = TokSpan 634 634, unLabel = IntExp 2})},Labeled {label = TokSpan 635 635, unLabel = FunBind (Labeled {label = TokSpan 635 635, unLabel = Ident {unIdent = "Gate"}}) [FunCase [[Labeled {label = TokSpan 637 637, unLabel = VarPat (Labeled {label = TokSpan 637 637, unLabel = Ident {unIdent = "DownTime"}})}]] (Labeled {label = TokSpan 640 769, unLabel = Let [Labeled {label = TokSpan 641 660, unLabel = PatBind (Labeled {label = TokSpan 641 641, unLabel = VarPat (Labeled {label = TokSpan 641 641, unLabel = Ident {unIdent = "GateUp"}})}) (Labeled {label = TokPos 657, unLabel = Fun2 "[]" (Labeled {label = TokPos 648, unLabel = Fun2 "[]" (Labeled {label = TokSpan 643 647, unLabel = PrefixExp (Labeled {label = TokSpan 643 643, unLabel = Var (Labeled {label = TokSpan 643 643, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 644 645, unLabel = OutComm (Labeled {label = TokSpan 645 645, unLabel = Var (Labeled {label = TokSpan 645 645, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 647 647, unLabel = Var (Labeled {label = TokSpan 647 647, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokSpan 649 656, unLabel = PrefixExp (Labeled {label = TokSpan 649 649, unLabel = Var (Labeled {label = TokSpan 649 649, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 650 651, unLabel = OutComm (Labeled {label = TokSpan 651 651, unLabel = Var (Labeled {label = TokSpan 651 651, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 653 656, unLabel = CallFunction (Labeled {label = TokSpan 653 653, unLabel = Var (Labeled {label = TokSpan 653 653, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 655 655, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 658 660, unLabel = PrefixExp (Labeled {label = TokSpan 658 658, unLabel = Var (Labeled {label = TokSpan 658 658, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 660 660, unLabel = Var (Labeled {label = TokSpan 660 660, unLabel = Ident {unIdent = "GateUp"}})})})})},Labeled {label = TokSpan 661 661, unLabel = FunBind (Labeled {label = TokSpan 661 661, unLabel = Ident {unIdent = "GateGoingDown"}}) [FunCase [[Labeled {label = TokSpan 663 663, unLabel = VarPat (Labeled {label = TokSpan 663 663, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 674, unLabel = Fun2 "[]" (Labeled {label = TokSpan 666 673, unLabel = PrefixExp (Labeled {label = TokSpan 666 666, unLabel = Var (Labeled {label = TokSpan 666 666, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 667 668, unLabel = OutComm (Labeled {label = TokSpan 668 668, unLabel = Var (Labeled {label = TokSpan 668 668, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 670 673, unLabel = CallFunction (Labeled {label = TokSpan 670 670, unLabel = Var (Labeled {label = TokSpan 670 670, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 672 672, unLabel = Var (Labeled {label = TokSpan 672 672, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 675 699, unLabel = Ifte (Labeled {label = TokPos 677, unLabel = Fun2 "==" (Labeled {label = TokSpan 676 676, unLabel = Var (Labeled {label = TokSpan 676 676, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 678 678, unLabel = Var (Labeled {label = TokSpan 678 678, unLabel = Ident {unIdent = "DownTime"}})})}) (Labeled {label = TokSpan 680 684, unLabel = PrefixExp (Labeled {label = TokSpan 680 680, unLabel = Var (Labeled {label = TokSpan 680 680, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 681 682, unLabel = OutComm (Labeled {label = TokSpan 682 682, unLabel = Var (Labeled {label = TokSpan 682 682, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 684 684, unLabel = Var (Labeled {label = TokSpan 684 684, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokPos 691, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 686 690, unLabel = PrefixExp (Labeled {label = TokSpan 686 686, unLabel = Var (Labeled {label = TokSpan 686 686, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 687 688, unLabel = OutComm (Labeled {label = TokSpan 688 688, unLabel = Var (Labeled {label = TokSpan 688 688, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 690 690, unLabel = Var (Labeled {label = TokSpan 690 690, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokSpan 692 699, unLabel = PrefixExp (Labeled {label = TokSpan 692 692, unLabel = Var (Labeled {label = TokSpan 692 692, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 694 699, unLabel = CallFunction (Labeled {label = TokSpan 694 694, unLabel = Var (Labeled {label = TokSpan 694 694, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokPos 697, unLabel = Fun2 "+" (Labeled {label = TokSpan 696 696, unLabel = Var (Labeled {label = TokSpan 696 696, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 698 698, unLabel = IntExp 1})}]]})})})})})]},Labeled {label = TokSpan 700 719, unLabel = PatBind (Labeled {label = TokSpan 700 700, unLabel = VarPat (Labeled {label = TokSpan 700 700, unLabel = Ident {unIdent = "GateDown"}})}) (Labeled {label = TokPos 716, unLabel = Fun2 "[]" (Labeled {label = TokPos 707, unLabel = Fun2 "[]" (Labeled {label = TokSpan 702 706, unLabel = PrefixExp (Labeled {label = TokSpan 702 702, unLabel = Var (Labeled {label = TokSpan 702 702, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 703 704, unLabel = OutComm (Labeled {label = TokSpan 704 704, unLabel = Var (Labeled {label = TokSpan 704 704, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 706 706, unLabel = Var (Labeled {label = TokSpan 706 706, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokSpan 708 715, unLabel = PrefixExp (Labeled {label = TokSpan 708 708, unLabel = Var (Labeled {label = TokSpan 708 708, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 709 710, unLabel = OutComm (Labeled {label = TokSpan 710 710, unLabel = Var (Labeled {label = TokSpan 710 710, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 712 715, unLabel = CallFunction (Labeled {label = TokSpan 712 712, unLabel = Var (Labeled {label = TokSpan 712 712, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokSpan 714 714, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 717 719, unLabel = PrefixExp (Labeled {label = TokSpan 717 717, unLabel = Var (Labeled {label = TokSpan 717 717, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 719 719, unLabel = Var (Labeled {label = TokSpan 719 719, unLabel = Ident {unIdent = "GateDown"}})})})})},Labeled {label = TokSpan 720 720, unLabel = FunBind (Labeled {label = TokSpan 720 720, unLabel = Ident {unIdent = "GateGoingUp"}}) [FunCase [[Labeled {label = TokSpan 722 722, unLabel = VarPat (Labeled {label = TokSpan 722 722, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 742, unLabel = Fun2 "[]" (Labeled {label = TokPos 733, unLabel = Fun2 "[]" (Labeled {label = TokSpan 725 732, unLabel = PrefixExp (Labeled {label = TokSpan 725 725, unLabel = Var (Labeled {label = TokSpan 725 725, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 726 727, unLabel = OutComm (Labeled {label = TokSpan 727 727, unLabel = Var (Labeled {label = TokSpan 727 727, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 729 732, unLabel = CallFunction (Labeled {label = TokSpan 729 729, unLabel = Var (Labeled {label = TokSpan 729 729, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokSpan 731 731, unLabel = Var (Labeled {label = TokSpan 731 731, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 734 741, unLabel = PrefixExp (Labeled {label = TokSpan 734 734, unLabel = Var (Labeled {label = TokSpan 734 734, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 735 736, unLabel = OutComm (Labeled {label = TokSpan 736 736, unLabel = Var (Labeled {label = TokSpan 736 736, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 738 741, unLabel = CallFunction (Labeled {label = TokSpan 738 738, unLabel = Var (Labeled {label = TokSpan 738 738, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 740 740, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 743 767, unLabel = Ifte (Labeled {label = TokPos 745, unLabel = Fun2 "==" (Labeled {label = TokSpan 744 744, unLabel = Var (Labeled {label = TokSpan 744 744, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 746 746, unLabel = Var (Labeled {label = TokSpan 746 746, unLabel = Ident {unIdent = "UpTime"}})})}) (Labeled {label = TokSpan 748 752, unLabel = PrefixExp (Labeled {label = TokSpan 748 748, unLabel = Var (Labeled {label = TokSpan 748 748, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 749 750, unLabel = OutComm (Labeled {label = TokSpan 750 750, unLabel = Var (Labeled {label = TokSpan 750 750, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 752 752, unLabel = Var (Labeled {label = TokSpan 752 752, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokPos 759, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 754 758, unLabel = PrefixExp (Labeled {label = TokSpan 754 754, unLabel = Var (Labeled {label = TokSpan 754 754, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 755 756, unLabel = OutComm (Labeled {label = TokSpan 756 756, unLabel = Var (Labeled {label = TokSpan 756 756, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 758 758, unLabel = Var (Labeled {label = TokSpan 758 758, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokSpan 760 767, unLabel = PrefixExp (Labeled {label = TokSpan 760 760, unLabel = Var (Labeled {label = TokSpan 760 760, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 762 767, unLabel = CallFunction (Labeled {label = TokSpan 762 762, unLabel = Var (Labeled {label = TokSpan 762 762, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokPos 765, unLabel = Fun2 "+" (Labeled {label = TokSpan 764 764, unLabel = Var (Labeled {label = TokSpan 764 764, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 766 766, unLabel = IntExp 1})}]]})})})})})]}] (Labeled {label = TokSpan 769 769, unLabel = Var (Labeled {label = TokSpan 769 769, unLabel = Ident {unIdent = "GateUp"}})})})]},Labeled {label = TokSpan 773 774, unLabel = Transparent [Labeled {label = TokSpan 774 774, unLabel = Ident {unIdent = "sbisim"}}]},Labeled {label = TokSpan 775 776, unLabel = Transparent [Labeled {label = TokSpan 776 776, unLabel = Ident {unIdent = "normalise"}}]},Labeled {label = TokSpan 777 778, unLabel = Transparent [Labeled {label = TokSpan 778 778, unLabel = Ident {unIdent = "explicate"}}]},Labeled {label = TokSpan 779 780, unLabel = Transparent [Labeled {label = TokSpan 780 780, unLabel = Ident {unIdent = "diamond"}}]},Labeled {label = TokSpan 781 781, unLabel = FunBind (Labeled {label = TokSpan 781 781, unLabel = Ident {unIdent = "GateAndController"}}) [FunCase [[Labeled {label = TokSpan 783 783, unLabel = VarPat (Labeled {label = TokSpan 783 783, unLabel = Ident {unIdent = "dt"}})}]] (Labeled {label = TokSpan 787 793, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 788 792, unLabel = Closure [Labeled {label = TokSpan 789 789, unLabel = Var (Labeled {label = TokSpan 789 789, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 791 791, unLabel = Var (Labeled {label = TokSpan 791 791, unLabel = Ident {unIdent = "gate"}})}]}) (Labeled {label = TokSpan 786 786, unLabel = Var (Labeled {label = TokSpan 786 786, unLabel = Ident {unIdent = "Controller"}})}) (Labeled {label = TokSpan 794 800, unLabel = CallFunction (Labeled {label = TokSpan 794 794, unLabel = Var (Labeled {label = TokSpan 794 794, unLabel = Ident {unIdent = "diamond"}})}) [[Labeled {label = TokSpan 796 799, unLabel = CallFunction (Labeled {label = TokSpan 796 796, unLabel = Var (Labeled {label = TokSpan 796 796, unLabel = Ident {unIdent = "Gate"}})}) [[Labeled {label = TokSpan 798 798, unLabel = Var (Labeled {label = TokSpan 798 798, unLabel = Ident {unIdent = "dt"}})}]]}]]})})]},Labeled {label = TokSpan 803 803, unLabel = FunBind (Labeled {label = TokSpan 803 803, unLabel = Ident {unIdent = "System"}}) [FunCase [[Labeled {label = TokSpan 805 805, unLabel = VarPat (Labeled {label = TokSpan 805 805, unLabel = Ident {unIdent = "invmaxspeed"}})},Labeled {label = TokSpan 807 807, unLabel = VarPat (Labeled {label = TokSpan 807 807, unLabel = Ident {unIdent = "gatedowntime"}})}]] (Labeled {label = TokSpan 814 820, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 815 819, unLabel = Closure [Labeled {label = TokSpan 816 816, unLabel = Var (Labeled {label = TokSpan 816 816, unLabel = Ident {unIdent = "sensor"}})},Labeled {label = TokSpan 818 818, unLabel = Var (Labeled {label = TokSpan 818 818, unLabel = Ident {unIdent = "tock"}})}]}) (Labeled {label = TokSpan 810 813, unLabel = CallFunction (Labeled {label = TokSpan 810 810, unLabel = Var (Labeled {label = TokSpan 810 810, unLabel = Ident {unIdent = "TimedNetwork"}})}) [[Labeled {label = TokSpan 812 812, unLabel = Var (Labeled {label = TokSpan 812 812, unLabel = Ident {unIdent = "invmaxspeed"}})}]]}) (Labeled {label = TokSpan 821 824, unLabel = CallFunction (Labeled {label = TokSpan 821 821, unLabel = Var (Labeled {label = TokSpan 821 821, unLabel = Ident {unIdent = "GateAndController"}})}) [[Labeled {label = TokSpan 823 823, unLabel = Var (Labeled {label = TokSpan 823 823, unLabel = Ident {unIdent = "gatedowntime"}})}]]})})]},Labeled {label = TokSpan 828 840, unLabel = PatBind (Labeled {label = TokSpan 828 828, unLabel = VarPat (Labeled {label = TokSpan 828 828, unLabel = Ident {unIdent = "NoError"}})}) (Labeled {label = TokSpan 830 840, unLabel = CallBuiltIn (Labeled {label = TokSpan 830 830, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 832 839, unLabel = CallBuiltIn (Labeled {label = TokSpan 832 832, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 834 834, unLabel = Events},Labeled {label = TokSpan 836 838, unLabel = Closure [Labeled {label = TokSpan 837 837, unLabel = Var (Labeled {label = TokSpan 837 837, unLabel = Ident {unIdent = "error"}})}]}]]}]]})},Labeled {label = TokSpan 841 849, unLabel = AssertRef (Labeled {label = TokSpan 842 842, unLabel = Var (Labeled {label = TokSpan 842 842, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 844 849, unLabel = CallFunction (Labeled {label = TokSpan 844 844, unLabel = Var (Labeled {label = TokSpan 844 844, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 846 846, unLabel = Var (Labeled {label = TokSpan 846 846, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 848 848, unLabel = Var (Labeled {label = TokSpan 848 848, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 856 856, unLabel = FunBind (Labeled {label = TokSpan 856 856, unLabel = Ident {unIdent = "SETBETWEENx"}}) [FunCase [[Labeled {label = TokSpan 858 858, unLabel = VarPat (Labeled {label = TokSpan 858 858, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 860 860, unLabel = VarPat (Labeled {label = TokSpan 860 860, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 862 862, unLabel = VarPat (Labeled {label = TokSpan 862 862, unLabel = Ident {unIdent = "C"}})}]] (Labeled {label = TokPos 882, unLabel = Fun2 "[]" (Labeled {label = TokSpan 865 881, unLabel = Parens (Labeled {label = TokSpan 866 880, unLabel = ProcRepChoice [Labeled {label = TokSpan 867 869, unLabel = Generator (Labeled {label = TokSpan 867 867, unLabel = VarPat (Labeled {label = TokSpan 867 867, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 869 869, unLabel = Var (Labeled {label = TokSpan 869 869, unLabel = Ident {unIdent = "EN"}})})}] (Labeled {label = TokSpan 871 880, unLabel = PrefixExp (Labeled {label = TokSpan 871 871, unLabel = Var (Labeled {label = TokSpan 871 871, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 873 880, unLabel = CallFunction (Labeled {label = TokSpan 873 873, unLabel = Var (Labeled {label = TokSpan 873 873, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 875 875, unLabel = Var (Labeled {label = TokSpan 875 875, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 877 877, unLabel = Var (Labeled {label = TokSpan 877 877, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 879 879, unLabel = Var (Labeled {label = TokSpan 879 879, unLabel = Ident {unIdent = "C"}})}]]})})})}) (Labeled {label = TokSpan 883 899, unLabel = Parens (Labeled {label = TokSpan 884 898, unLabel = ProcRepChoice [Labeled {label = TokSpan 885 887, unLabel = Generator (Labeled {label = TokSpan 885 885, unLabel = VarPat (Labeled {label = TokSpan 885 885, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 887 887, unLabel = Var (Labeled {label = TokSpan 887 887, unLabel = Ident {unIdent = "DIS"}})})}] (Labeled {label = TokSpan 889 898, unLabel = PrefixExp (Labeled {label = TokSpan 889 889, unLabel = Var (Labeled {label = TokSpan 889 889, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 891 898, unLabel = CallFunction (Labeled {label = TokSpan 891 891, unLabel = Var (Labeled {label = TokSpan 891 891, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 893 893, unLabel = Var (Labeled {label = TokSpan 893 893, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 895 895, unLabel = Var (Labeled {label = TokSpan 895 895, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 897 897, unLabel = Var (Labeled {label = TokSpan 897 897, unLabel = Ident {unIdent = "C"}})}]]})})})})})]},Labeled {label = TokSpan 900 900, unLabel = FunBind (Labeled {label = TokSpan 900 900, unLabel = Ident {unIdent = "SETOUTSIDEx"}}) [FunCase [[Labeled {label = TokSpan 902 902, unLabel = VarPat (Labeled {label = TokSpan 902 902, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 904 904, unLabel = VarPat (Labeled {label = TokSpan 904 904, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 906 906, unLabel = VarPat (Labeled {label = TokSpan 906 906, unLabel = Ident {unIdent = "C"}})}]] (Labeled {label = TokPos 944, unLabel = Fun2 "[]" (Labeled {label = TokPos 926, unLabel = Fun2 "[]" (Labeled {label = TokSpan 909 925, unLabel = Parens (Labeled {label = TokSpan 910 924, unLabel = ProcRepChoice [Labeled {label = TokSpan 911 913, unLabel = Generator (Labeled {label = TokSpan 911 911, unLabel = VarPat (Labeled {label = TokSpan 911 911, unLabel = Ident {unIdent = "c"}})}) (Labeled {label = TokSpan 913 913, unLabel = Var (Labeled {label = TokSpan 913 913, unLabel = Ident {unIdent = "C"}})})}] (Labeled {label = TokSpan 915 924, unLabel = PrefixExp (Labeled {label = TokSpan 915 915, unLabel = Var (Labeled {label = TokSpan 915 915, unLabel = Ident {unIdent = "c"}})}) [] (Labeled {label = TokSpan 917 924, unLabel = CallFunction (Labeled {label = TokSpan 917 917, unLabel = Var (Labeled {label = TokSpan 917 917, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 919 919, unLabel = Var (Labeled {label = TokSpan 919 919, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 921 921, unLabel = Var (Labeled {label = TokSpan 921 921, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 923 923, unLabel = Var (Labeled {label = TokSpan 923 923, unLabel = Ident {unIdent = "C"}})}]]})})})}) (Labeled {label = TokSpan 927 943, unLabel = Parens (Labeled {label = TokSpan 928 942, unLabel = ProcRepChoice [Labeled {label = TokSpan 929 931, unLabel = Generator (Labeled {label = TokSpan 929 929, unLabel = VarPat (Labeled {label = TokSpan 929 929, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 931 931, unLabel = Var (Labeled {label = TokSpan 931 931, unLabel = Ident {unIdent = "EN"}})})}] (Labeled {label = TokSpan 933 942, unLabel = PrefixExp (Labeled {label = TokSpan 933 933, unLabel = Var (Labeled {label = TokSpan 933 933, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 935 942, unLabel = CallFunction (Labeled {label = TokSpan 935 935, unLabel = Var (Labeled {label = TokSpan 935 935, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 937 937, unLabel = Var (Labeled {label = TokSpan 937 937, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 939 939, unLabel = Var (Labeled {label = TokSpan 939 939, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 941 941, unLabel = Var (Labeled {label = TokSpan 941 941, unLabel = Ident {unIdent = "C"}})}]]})})})})}) (Labeled {label = TokSpan 945 961, unLabel = Parens (Labeled {label = TokSpan 946 960, unLabel = ProcRepChoice [Labeled {label = TokSpan 947 949, unLabel = Generator (Labeled {label = TokSpan 947 947, unLabel = VarPat (Labeled {label = TokSpan 947 947, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 949 949, unLabel = Var (Labeled {label = TokSpan 949 949, unLabel = Ident {unIdent = "DIS"}})})}] (Labeled {label = TokSpan 951 960, unLabel = PrefixExp (Labeled {label = TokSpan 951 951, unLabel = Var (Labeled {label = TokSpan 951 951, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 953 960, unLabel = CallFunction (Labeled {label = TokSpan 953 953, unLabel = Var (Labeled {label = TokSpan 953 953, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 955 955, unLabel = Var (Labeled {label = TokSpan 955 955, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 957 957, unLabel = Var (Labeled {label = TokSpan 957 957, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 959 959, unLabel = Var (Labeled {label = TokSpan 959 959, unLabel = Ident {unIdent = "C"}})}]]})})})})})]},Labeled {label = TokSpan 966 1010, unLabel = PatBind (Labeled {label = TokSpan 966 966, unLabel = VarPat (Labeled {label = TokSpan 966 966, unLabel = Ident {unIdent = "EnterWhenDown"}})}) (Labeled {label = TokSpan 998 1006, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 999 1005, unLabel = Closure [Labeled {label = TokSpan 1000 1000, unLabel = Var (Labeled {label = TokSpan 1000 1000, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 1002 1004, unLabel = DotTuple [Labeled {label = TokSpan 1002 1002, unLabel = Var (Labeled {label = TokSpan 1002 1002, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1004 1004, unLabel = Var (Labeled {label = TokSpan 1004 1004, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 970 997, unLabel = CallFunction (Labeled {label = TokSpan 970 970, unLabel = Var (Labeled {label = TokSpan 970 970, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 972 976, unLabel = SetEnum [Labeled {label = TokSpan 973 975, unLabel = DotTuple [Labeled {label = TokSpan 973 973, unLabel = Var (Labeled {label = TokSpan 973 973, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 975 975, unLabel = Var (Labeled {label = TokSpan 975 975, unLabel = Ident {unIdent = "down"}})}]}]},Labeled {label = TokSpan 978 990, unLabel = SetEnum [Labeled {label = TokSpan 979 981, unLabel = DotTuple [Labeled {label = TokSpan 979 979, unLabel = Var (Labeled {label = TokSpan 979 979, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 981 981, unLabel = Var (Labeled {label = TokSpan 981 981, unLabel = Ident {unIdent = "up"}})}]},Labeled {label = TokSpan 983 985, unLabel = DotTuple [Labeled {label = TokSpan 983 983, unLabel = Var (Labeled {label = TokSpan 983 983, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 985 985, unLabel = Var (Labeled {label = TokSpan 985 985, unLabel = Ident {unIdent = "go_up"}})}]},Labeled {label = TokSpan 987 989, unLabel = DotTuple [Labeled {label = TokSpan 987 987, unLabel = Var (Labeled {label = TokSpan 987 987, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 989 989, unLabel = Var (Labeled {label = TokSpan 989 989, unLabel = Ident {unIdent = "go_down"}})}]}]},Labeled {label = TokSpan 992 996, unLabel = SetEnum [Labeled {label = TokSpan 993 995, unLabel = DotTuple [Labeled {label = TokSpan 993 993, unLabel = Var (Labeled {label = TokSpan 993 993, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 995 995, unLabel = Var (Labeled {label = TokSpan 995 995, unLabel = Ident {unIdent = "GateSeg"}})}]}]}]]}) (Labeled {label = TokSpan 1007 1010, unLabel = CallBuiltIn (Labeled {label = TokSpan 1007 1007, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1009 1009, unLabel = Events}]]})})},Labeled {label = TokSpan 1011 1047, unLabel = PatBind (Labeled {label = TokSpan 1011 1011, unLabel = VarPat (Labeled {label = TokSpan 1011 1011, unLabel = Ident {unIdent = "GateStillWhenTrain"}})}) (Labeled {label = TokSpan 1031 1043, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1032 1042, unLabel = Closure [Labeled {label = TokSpan 1033 1033, unLabel = Var (Labeled {label = TokSpan 1033 1033, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 1035 1037, unLabel = DotTuple [Labeled {label = TokSpan 1035 1035, unLabel = Var (Labeled {label = TokSpan 1035 1035, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1037 1037, unLabel = Var (Labeled {label = TokSpan 1037 1037, unLabel = Ident {unIdent = "GateSeg"}})}]},Labeled {label = TokSpan 1039 1041, unLabel = DotTuple [Labeled {label = TokSpan 1039 1039, unLabel = Var (Labeled {label = TokSpan 1039 1039, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1041 1041, unLabel = Var (Labeled {label = TokSpan 1041 1041, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 1013 1030, unLabel = CallFunction (Labeled {label = TokSpan 1013 1013, unLabel = Var (Labeled {label = TokSpan 1013 1013, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 1015 1019, unLabel = Closure [Labeled {label = TokSpan 1016 1018, unLabel = DotTuple [Labeled {label = TokSpan 1016 1016, unLabel = Var (Labeled {label = TokSpan 1016 1016, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1018 1018, unLabel = Var (Labeled {label = TokSpan 1018 1018, unLabel = Ident {unIdent = "GateSeg"}})}]}]},Labeled {label = TokSpan 1021 1025, unLabel = Closure [Labeled {label = TokSpan 1022 1024, unLabel = DotTuple [Labeled {label = TokSpan 1022 1022, unLabel = Var (Labeled {label = TokSpan 1022 1022, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1024 1024, unLabel = Var (Labeled {label = TokSpan 1024 1024, unLabel = Ident {unIdent = "GateSeg"}})}]}]},Labeled {label = TokSpan 1027 1029, unLabel = Closure [Labeled {label = TokSpan 1028 1028, unLabel = Var (Labeled {label = TokSpan 1028 1028, unLabel = Ident {unIdent = "gate"}})}]}]]}) (Labeled {label = TokSpan 1044 1047, unLabel = CallBuiltIn (Labeled {label = TokSpan 1044 1044, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1046 1046, unLabel = Events}]]})})},Labeled {label = TokSpan 1049 1055, unLabel = PatBind (Labeled {label = TokSpan 1049 1049, unLabel = VarPat (Labeled {label = TokSpan 1049 1049, unLabel = Ident {unIdent = "Safety"}})}) (Labeled {label = TokSpan 1052 1054, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1053 1053, unLabel = Events}) (Labeled {label = TokSpan 1051 1051, unLabel = Var (Labeled {label = TokSpan 1051 1051, unLabel = Ident {unIdent = "EnterWhenDown"}})}) (Labeled {label = TokSpan 1055 1055, unLabel = Var (Labeled {label = TokSpan 1055 1055, unLabel = Ident {unIdent = "GateStillWhenTrain"}})})})},Labeled {label = TokSpan 1057 1065, unLabel = AssertRef (Labeled {label = TokSpan 1058 1058, unLabel = Var (Labeled {label = TokSpan 1058 1058, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1060 1065, unLabel = CallFunction (Labeled {label = TokSpan 1060 1060, unLabel = Var (Labeled {label = TokSpan 1060 1060, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1062 1062, unLabel = Var (Labeled {label = TokSpan 1062 1062, unLabel = Ident {unIdent = "SlowTrain"}})},Labeled {label = TokSpan 1064 1064, unLabel = Var (Labeled {label = TokSpan 1064 1064, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1066 1074, unLabel = AssertRef (Labeled {label = TokSpan 1067 1067, unLabel = Var (Labeled {label = TokSpan 1067 1067, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1069 1074, unLabel = CallFunction (Labeled {label = TokSpan 1069 1069, unLabel = Var (Labeled {label = TokSpan 1069 1069, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1071 1071, unLabel = Var (Labeled {label = TokSpan 1071 1071, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1073 1073, unLabel = Var (Labeled {label = TokSpan 1073 1073, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1075 1083, unLabel = AssertRef (Labeled {label = TokSpan 1076 1076, unLabel = Var (Labeled {label = TokSpan 1076 1076, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 1078 1083, unLabel = CallFunction (Labeled {label = TokSpan 1078 1078, unLabel = Var (Labeled {label = TokSpan 1078 1078, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1080 1080, unLabel = Var (Labeled {label = TokSpan 1080 1080, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1082 1082, unLabel = Var (Labeled {label = TokSpan 1082 1082, unLabel = Ident {unIdent = "SlowGate"}})}]]})},Labeled {label = TokSpan 1084 1092, unLabel = AssertRef (Labeled {label = TokSpan 1085 1085, unLabel = Var (Labeled {label = TokSpan 1085 1085, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1087 1092, unLabel = CallFunction (Labeled {label = TokSpan 1087 1087, unLabel = Var (Labeled {label = TokSpan 1087 1087, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1089 1089, unLabel = Var (Labeled {label = TokSpan 1089 1089, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1091 1091, unLabel = Var (Labeled {label = TokSpan 1091 1091, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1093 1101, unLabel = AssertRef (Labeled {label = TokSpan 1094 1094, unLabel = Var (Labeled {label = TokSpan 1094 1094, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 1096 1101, unLabel = CallFunction (Labeled {label = TokSpan 1096 1096, unLabel = Var (Labeled {label = TokSpan 1096 1096, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1098 1098, unLabel = Var (Labeled {label = TokSpan 1098 1098, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1100 1100, unLabel = Var (Labeled {label = TokSpan 1100 1100, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1102 1110, unLabel = AssertRef (Labeled {label = TokSpan 1103 1103, unLabel = Var (Labeled {label = TokSpan 1103 1103, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1105 1110, unLabel = CallFunction (Labeled {label = TokSpan 1105 1105, unLabel = Var (Labeled {label = TokSpan 1105 1105, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1107 1107, unLabel = Var (Labeled {label = TokSpan 1107 1107, unLabel = Ident {unIdent = "SlowTrain"}})},Labeled {label = TokSpan 1109 1109, unLabel = Var (Labeled {label = TokSpan 1109 1109, unLabel = Ident {unIdent = "SlowGate"}})}]]})},Labeled {label = TokSpan 1111 1119, unLabel = AssertRef (Labeled {label = TokSpan 1112 1112, unLabel = Var (Labeled {label = TokSpan 1112 1112, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1114 1119, unLabel = CallFunction (Labeled {label = TokSpan 1114 1114, unLabel = Var (Labeled {label = TokSpan 1114 1114, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1116 1116, unLabel = Var (Labeled {label = TokSpan 1116 1116, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1118 1118, unLabel = Var (Labeled {label = TokSpan 1118 1118, unLabel = Ident {unIdent = "FastGate"}})}]]})},Labeled {label = TokSpan 1120 1128, unLabel = AssertRef (Labeled {label = TokSpan 1121 1121, unLabel = Var (Labeled {label = TokSpan 1121 1121, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1123 1128, unLabel = CallFunction (Labeled {label = TokSpan 1123 1123, unLabel = Var (Labeled {label = TokSpan 1123 1123, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1125 1125, unLabel = Var (Labeled {label = TokSpan 1125 1125, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1127 1127, unLabel = Var (Labeled {label = TokSpan 1127 1127, unLabel = Ident {unIdent = "VeryFastGate"}})}]]})},Labeled {label = TokSpan 1132 1136, unLabel = PatBind (Labeled {label = TokSpan 1132 1132, unLabel = VarPat (Labeled {label = TokSpan 1132 1132, unLabel = Ident {unIdent = "TOCKS"}})}) (Labeled {label = TokSpan 1134 1136, unLabel = PrefixExp (Labeled {label = TokSpan 1134 1134, unLabel = Var (Labeled {label = TokSpan 1134 1134, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1136 1136, unLabel = Var (Labeled {label = TokSpan 1136 1136, unLabel = Ident {unIdent = "TOCKS"}})})})},Labeled {label = TokSpan 1139 1145, unLabel = PatBind (Labeled {label = TokSpan 1139 1139, unLabel = VarPat (Labeled {label = TokSpan 1139 1139, unLabel = Ident {unIdent = "Delayable"}})}) (Labeled {label = TokSpan 1141 1145, unLabel = Closure [Labeled {label = TokSpan 1142 1144, unLabel = DotTuple [Labeled {label = TokSpan 1142 1142, unLabel = Var (Labeled {label = TokSpan 1142 1142, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1144 1144, unLabel = IntExp 1}]}]})},Labeled {label = TokSpan 1146 1155, unLabel = PatBind (Labeled {label = TokSpan 1146 1146, unLabel = VarPat (Labeled {label = TokSpan 1146 1146, unLabel = Ident {unIdent = "NonTock"}})}) (Labeled {label = TokSpan 1148 1155, unLabel = CallBuiltIn (Labeled {label = TokSpan 1148 1148, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 1150 1150, unLabel = Events},Labeled {label = TokSpan 1152 1154, unLabel = SetEnum [Labeled {label = TokSpan 1153 1153, unLabel = Var (Labeled {label = TokSpan 1153 1153, unLabel = Ident {unIdent = "tock"}})}]}]]})},Labeled {label = TokSpan 1156 1156, unLabel = FunBind (Labeled {label = TokSpan 1156 1156, unLabel = Ident {unIdent = "TimingConsistency"}}) [FunCase [[Labeled {label = TokSpan 1158 1158, unLabel = VarPat (Labeled {label = TokSpan 1158 1158, unLabel = Ident {unIdent = "ts"}})},Labeled {label = TokSpan 1160 1160, unLabel = VarPat (Labeled {label = TokSpan 1160 1160, unLabel = Ident {unIdent = "gs"}})}]] (Labeled {label = TokSpan 1163 1183, unLabel = CallFunction (Labeled {label = TokSpan 1163 1163, unLabel = Var (Labeled {label = TokSpan 1163 1163, unLabel = Ident {unIdent = "explicate"}})}) [[Labeled {label = TokPos 1181, unLabel = Fun2 "\\" (Labeled {label = TokSpan 1171 1173, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1172 1172, unLabel = Var (Labeled {label = TokSpan 1172 1172, unLabel = Ident {unIdent = "Delayable"}})}) (Labeled {label = TokSpan 1165 1170, unLabel = CallFunction (Labeled {label = TokSpan 1165 1165, unLabel = Var (Labeled {label = TokSpan 1165 1165, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1167 1167, unLabel = Var (Labeled {label = TokSpan 1167 1167, unLabel = Ident {unIdent = "ts"}})},Labeled {label = TokSpan 1169 1169, unLabel = Var (Labeled {label = TokSpan 1169 1169, unLabel = Ident {unIdent = "gs"}})}]]}) (Labeled {label = TokSpan 1174 1180, unLabel = CallFunction (Labeled {label = TokSpan 1174 1174, unLabel = Var (Labeled {label = TokSpan 1174 1174, unLabel = Ident {unIdent = "normalise"}})}) [[Labeled {label = TokSpan 1176 1179, unLabel = CallBuiltIn (Labeled {label = TokSpan 1176 1176, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1178 1178, unLabel = Var (Labeled {label = TokSpan 1178 1178, unLabel = Ident {unIdent = "Delayable"}})}]]}]]})}) (Labeled {label = TokSpan 1182 1182, unLabel = Var (Labeled {label = TokSpan 1182 1182, unLabel = Ident {unIdent = "NonTock"}})})}]]})]},Labeled {label = TokSpan 1184 1192, unLabel = AssertRef (Labeled {label = TokSpan 1185 1185, unLabel = Var (Labeled {label = TokSpan 1185 1185, unLabel = Ident {unIdent = "TOCKS"}})}) "[FD=" (Labeled {label = TokSpan 1187 1192, unLabel = CallFunction (Labeled {label = TokSpan 1187 1187, unLabel = Var (Labeled {label = TokSpan 1187 1187, unLabel = Ident {unIdent = "TimingConsistency"}})}) [[Labeled {label = TokSpan 1189 1189, unLabel = Var (Labeled {label = TokSpan 1189 1189, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1191 1191, unLabel = Var (Labeled {label = TokSpan 1191 1191, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1206 1206, unLabel = FunBind (Labeled {label = TokSpan 1206 1206, unLabel = Ident {unIdent = "Liveness"}}) [FunCase [[Labeled {label = TokSpan 1208 1208, unLabel = VarPat (Labeled {label = TokSpan 1208 1208, unLabel = Ident {unIdent = "X"}})}]] (Labeled {label = TokSpan 1211 1344, unLabel = Let [Labeled {label = TokSpan 1212 1227, unLabel = PatBind (Labeled {label = TokSpan 1212 1212, unLabel = VarPat (Labeled {label = TokSpan 1212 1212, unLabel = Ident {unIdent = "Idle"}})}) (Labeled {label = TokPos 1217, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1214 1216, unLabel = PrefixExp (Labeled {label = TokSpan 1214 1214, unLabel = Var (Labeled {label = TokSpan 1214 1214, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1216 1216, unLabel = Var (Labeled {label = TokSpan 1216 1216, unLabel = Ident {unIdent = "Idle"}})})}) (Labeled {label = TokSpan 1218 1227, unLabel = PrefixExp (Labeled {label = TokSpan 1218 1218, unLabel = Var (Labeled {label = TokSpan 1218 1218, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1219 1220, unLabel = OutComm (Labeled {label = TokSpan 1220 1220, unLabel = IntExp 1})},Labeled {label = TokSpan 1221 1222, unLabel = InComm (Labeled {label = TokSpan 1222 1222, unLabel = WildCard})}] (Labeled {label = TokSpan 1224 1227, unLabel = CallFunction (Labeled {label = TokSpan 1224 1224, unLabel = Var (Labeled {label = TokSpan 1224 1224, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1226 1226, unLabel = IntExp 1}]]})})})},Labeled {label = TokSpan 1228 1228, unLabel = FunBind (Labeled {label = TokSpan 1228 1228, unLabel = Ident {unIdent = "Busy"}}) [FunCase [[Labeled {label = TokSpan 1230 1230, unLabel = VarPat (Labeled {label = TokSpan 1230 1230, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 1286, unLabel = Fun2 "[]" (Labeled {label = TokPos 1261, unLabel = Fun2 "[]" (Labeled {label = TokPos 1239, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1233 1238, unLabel = PrefixExp (Labeled {label = TokSpan 1233 1233, unLabel = Var (Labeled {label = TokSpan 1233 1233, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1235 1238, unLabel = CallFunction (Labeled {label = TokSpan 1235 1235, unLabel = Var (Labeled {label = TokSpan 1235 1235, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1237 1237, unLabel = Var (Labeled {label = TokSpan 1237 1237, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 1240 1260, unLabel = PrefixExp (Labeled {label = TokSpan 1240 1240, unLabel = Var (Labeled {label = TokSpan 1240 1240, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1241 1242, unLabel = OutComm (Labeled {label = TokSpan 1242 1242, unLabel = IntExp 1})},Labeled {label = TokSpan 1243 1244, unLabel = InComm (Labeled {label = TokSpan 1244 1244, unLabel = WildCard})}] (Labeled {label = TokSpan 1246 1260, unLabel = CallFunction (Labeled {label = TokSpan 1246 1246, unLabel = Var (Labeled {label = TokSpan 1246 1246, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1248 1259, unLabel = Ifte (Labeled {label = TokPos 1250, unLabel = Fun2 "<" (Labeled {label = TokSpan 1249 1249, unLabel = Var (Labeled {label = TokSpan 1249 1249, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1251 1251, unLabel = Var (Labeled {label = TokSpan 1251 1251, unLabel = Ident {unIdent = "GateSeg"}})})}) (Labeled {label = TokSpan 1253 1257, unLabel = Parens (Labeled {label = TokPos 1255, unLabel = Fun2 "+" (Labeled {label = TokSpan 1254 1254, unLabel = Var (Labeled {label = TokSpan 1254 1254, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1256 1256, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 1259 1259, unLabel = Var (Labeled {label = TokSpan 1259 1259, unLabel = Ident {unIdent = "n"}})})}]]})})}) (Labeled {label = TokSpan 1262 1285, unLabel = PrefixExp (Labeled {label = TokSpan 1262 1262, unLabel = Var (Labeled {label = TokSpan 1262 1262, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 1263 1264, unLabel = OutComm (Labeled {label = TokSpan 1264 1264, unLabel = Var (Labeled {label = TokSpan 1264 1264, unLabel = Ident {unIdent = "GateSeg"}})})},Labeled {label = TokSpan 1265 1266, unLabel = InComm (Labeled {label = TokSpan 1266 1266, unLabel = WildCard})}] (Labeled {label = TokSpan 1268 1285, unLabel = Parens (Labeled {label = TokSpan 1269 1284, unLabel = Ifte (Labeled {label = TokPos 1271, unLabel = Fun2 "==" (Labeled {label = TokSpan 1270 1270, unLabel = Var (Labeled {label = TokSpan 1270 1270, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1272 1272, unLabel = IntExp 1})}) (Labeled {label = TokSpan 1274 1277, unLabel = CallFunction (Labeled {label = TokSpan 1274 1274, unLabel = Var (Labeled {label = TokSpan 1274 1274, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokSpan 1276 1276, unLabel = Var (Labeled {label = TokSpan 1276 1276, unLabel = Ident {unIdent = "X"}})}]]}) (Labeled {label = TokSpan 1279 1284, unLabel = CallFunction (Labeled {label = TokSpan 1279 1279, unLabel = Var (Labeled {label = TokSpan 1279 1279, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokPos 1282, unLabel = Fun2 "-" (Labeled {label = TokSpan 1281 1281, unLabel = Var (Labeled {label = TokSpan 1281 1281, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1283 1283, unLabel = IntExp 1})}]]})})})})}) (Labeled {label = TokSpan 1287 1294, unLabel = PrefixExp (Labeled {label = TokSpan 1287 1287, unLabel = Var (Labeled {label = TokSpan 1287 1287, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 1288 1289, unLabel = InComm (Labeled {label = TokSpan 1289 1289, unLabel = WildCard})}] (Labeled {label = TokSpan 1291 1294, unLabel = CallFunction (Labeled {label = TokSpan 1291 1291, unLabel = Var (Labeled {label = TokSpan 1291 1291, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1293 1293, unLabel = Var (Labeled {label = TokSpan 1293 1293, unLabel = Ident {unIdent = "n"}})}]]})})})]},Labeled {label = TokSpan 1295 1295, unLabel = FunBind (Labeled {label = TokSpan 1295 1295, unLabel = Ident {unIdent = "UpBefore"}}) [FunCase [[Labeled {label = TokSpan 1297 1297, unLabel = VarPat (Labeled {label = TokSpan 1297 1297, unLabel = Ident {unIdent = "m"}})}]] (Labeled {label = TokPos 1330, unLabel = Fun2 "[]" (Labeled {label = TokPos 1312, unLabel = Fun2 "[]" (Labeled {label = TokPos 1303, unLabel = Fun2 "&" (Labeled {label = TokPos 1301, unLabel = Fun2 "!=" (Labeled {label = TokSpan 1300 1300, unLabel = Var (Labeled {label = TokSpan 1300 1300, unLabel = Ident {unIdent = "m"}})}) (Labeled {label = TokSpan 1302 1302, unLabel = IntExp 0})}) (Labeled {label = TokSpan 1304 1311, unLabel = PrefixExp (Labeled {label = TokSpan 1304 1304, unLabel = Var (Labeled {label = TokSpan 1304 1304, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1306 1311, unLabel = CallFunction (Labeled {label = TokSpan 1306 1306, unLabel = Var (Labeled {label = TokSpan 1306 1306, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokPos 1309, unLabel = Fun2 "-" (Labeled {label = TokSpan 1308 1308, unLabel = Var (Labeled {label = TokSpan 1308 1308, unLabel = Ident {unIdent = "m"}})}) (Labeled {label = TokSpan 1310 1310, unLabel = IntExp 1})}]]})})}) (Labeled {label = TokSpan 1313 1329, unLabel = PrefixExp (Labeled {label = TokSpan 1313 1313, unLabel = Var (Labeled {label = TokSpan 1313 1313, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 1314 1315, unLabel = InComm (Labeled {label = TokSpan 1315 1315, unLabel = VarPat (Labeled {label = TokSpan 1315 1315, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 1317 1329, unLabel = Parens (Labeled {label = TokSpan 1318 1328, unLabel = Ifte (Labeled {label = TokPos 1320, unLabel = Fun2 "==" (Labeled {label = TokSpan 1319 1319, unLabel = Var (Labeled {label = TokSpan 1319 1319, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 1321 1321, unLabel = Var (Labeled {label = TokSpan 1321 1321, unLabel = Ident {unIdent = "up"}})})}) (Labeled {label = TokSpan 1323 1323, unLabel = Var (Labeled {label = TokSpan 1323 1323, unLabel = Ident {unIdent = "Idle"}})}) (Labeled {label = TokSpan 1325 1328, unLabel = CallFunction (Labeled {label = TokSpan 1325 1325, unLabel = Var (Labeled {label = TokSpan 1325 1325, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokSpan 1327 1327, unLabel = Var (Labeled {label = TokSpan 1327 1327, unLabel = Ident {unIdent = "m"}})}]]})})})})}) (Labeled {label = TokSpan 1331 1340, unLabel = PrefixExp (Labeled {label = TokSpan 1331 1331, unLabel = Var (Labeled {label = TokSpan 1331 1331, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1332 1333, unLabel = OutComm (Labeled {label = TokSpan 1333 1333, unLabel = IntExp 1})},Labeled {label = TokSpan 1334 1335, unLabel = InComm (Labeled {label = TokSpan 1335 1335, unLabel = WildCard})}] (Labeled {label = TokSpan 1337 1340, unLabel = CallFunction (Labeled {label = TokSpan 1337 1337, unLabel = Var (Labeled {label = TokSpan 1337 1337, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1339 1339, unLabel = IntExp 1}]]})})})]}] (Labeled {label = TokSpan 1344 1344, unLabel = Var (Labeled {label = TokSpan 1344 1344, unLabel = Ident {unIdent = "Idle"}})})})]},Labeled {label = TokSpan 1345 1345, unLabel = FunBind (Labeled {label = TokSpan 1345 1345, unLabel = Ident {unIdent = "GateLive"}}) [FunCase [[Labeled {label = TokSpan 1347 1347, unLabel = VarPat (Labeled {label = TokSpan 1347 1347, unLabel = Ident {unIdent = "X"}})}]] (Labeled {label = TokSpan 1354 1368, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1355 1367, unLabel = Closure [Labeled {label = TokSpan 1356 1356, unLabel = Var (Labeled {label = TokSpan 1356 1356, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 1358 1358, unLabel = Var (Labeled {label = TokSpan 1358 1358, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 1360 1362, unLabel = DotTuple [Labeled {label = TokSpan 1360 1360, unLabel = Var (Labeled {label = TokSpan 1360 1360, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1362 1362, unLabel = IntExp 1}]},Labeled {label = TokSpan 1364 1366, unLabel = DotTuple [Labeled {label = TokSpan 1364 1364, unLabel = Var (Labeled {label = TokSpan 1364 1364, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1366 1366, unLabel = Var (Labeled {label = TokSpan 1366 1366, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 1350 1353, unLabel = CallFunction (Labeled {label = TokSpan 1350 1350, unLabel = Var (Labeled {label = TokSpan 1350 1350, unLabel = Ident {unIdent = "Liveness"}})}) [[Labeled {label = TokSpan 1352 1352, unLabel = Var (Labeled {label = TokSpan 1352 1352, unLabel = Ident {unIdent = "X"}})}]]}) (Labeled {label = TokSpan 1369 1372, unLabel = CallBuiltIn (Labeled {label = TokSpan 1369 1369, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1371 1371, unLabel = Events}]]})})]},Labeled {label = TokSpan 1373 1384, unLabel = AssertRef (Labeled {label = TokSpan 1374 1377, unLabel = CallFunction (Labeled {label = TokSpan 1374 1374, unLabel = Var (Labeled {label = TokSpan 1374 1374, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1376 1376, unLabel = IntExp 3}]]}) "[T=" (Labeled {label = TokSpan 1379 1384, unLabel = CallFunction (Labeled {label = TokSpan 1379 1379, unLabel = Var (Labeled {label = TokSpan 1379 1379, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1381 1381, unLabel = Var (Labeled {label = TokSpan 1381 1381, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1383 1383, unLabel = Var (Labeled {label = TokSpan 1383 1383, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1385 1396, unLabel = AssertRef (Labeled {label = TokSpan 1386 1389, unLabel = CallFunction (Labeled {label = TokSpan 1386 1386, unLabel = Var (Labeled {label = TokSpan 1386 1386, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1388 1388, unLabel = IntExp 2}]]}) "[T=" (Labeled {label = TokSpan 1391 1396, unLabel = CallFunction (Labeled {label = TokSpan 1391 1391, unLabel = Var (Labeled {label = TokSpan 1391 1391, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1393 1393, unLabel = Var (Labeled {label = TokSpan 1393 1393, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1395 1395, unLabel = Var (Labeled {label = TokSpan 1395 1395, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1397 1408, unLabel = AssertRef (Labeled {label = TokSpan 1398 1401, unLabel = CallFunction (Labeled {label = TokSpan 1398 1398, unLabel = Var (Labeled {label = TokSpan 1398 1398, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1400 1400, unLabel = IntExp 1}]]}) "[T=" (Labeled {label = TokSpan 1403 1408, unLabel = CallFunction (Labeled {label = TokSpan 1403 1403, unLabel = Var (Labeled {label = TokSpan 1403 1403, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1405 1405, unLabel = Var (Labeled {label = TokSpan 1405 1405, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1407 1407, unLabel = Var (Labeled {label = TokSpan 1407 1407, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1410 1419, unLabel = AssertRef (Labeled {label = TokSpan 1411 1414, unLabel = CallFunction (Labeled {label = TokSpan 1411 1411, unLabel = Var (Labeled {label = TokSpan 1411 1411, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1413 1413, unLabel = IntExp 3}]]}) "[T=" (Labeled {label = TokSpan 1416 1419, unLabel = CallFunction (Labeled {label = TokSpan 1416 1416, unLabel = Var (Labeled {label = TokSpan 1416 1416, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1418 1418, unLabel = IntExp 2}]]})}]}
