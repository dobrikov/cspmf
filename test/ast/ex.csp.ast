Labeled {label = TokSpan 0 223, unLabel = Module [Labeled {label = TokSpan 0 7, unLabel = NameType (Labeled {label = TokSpan 1 1, unLabel = Ident {unIdent = "Val"}}) (Labeled {label = TokSpan 3 7, unLabel = TypeDot [Labeled {label = TokSpan 3 7, unLabel = SetClose (Labeled {label = TokSpan 4 4, unLabel = IntExp 0},Labeled {label = TokSpan 6 6, unLabel = IntExp 6})}]})},Labeled {label = TokSpan 8 17, unLabel = DataType (Labeled {label = TokSpan 9 9, unLabel = Ident {unIdent = "Slot"}}) [Labeled {label = TokSpan 11 11, unLabel = Constructor (Labeled {label = TokSpan 11 11, unLabel = Ident {unIdent = "sl1"}}) Nothing},Labeled {label = TokSpan 13 13, unLabel = Constructor (Labeled {label = TokSpan 13 13, unLabel = Ident {unIdent = "sl2"}}) Nothing},Labeled {label = TokSpan 15 15, unLabel = Constructor (Labeled {label = TokSpan 15 15, unLabel = Ident {unIdent = "sl3"}}) Nothing},Labeled {label = TokSpan 17 17, unLabel = Constructor (Labeled {label = TokSpan 17 17, unLabel = Ident {unIdent = "sl4"}}) Nothing}]},Labeled {label = TokSpan 18 35, unLabel = DataType (Labeled {label = TokSpan 19 19, unLabel = Ident {unIdent = "Signal"}}) [Labeled {label = TokSpan 21 21, unLabel = Constructor (Labeled {label = TokSpan 21 21, unLabel = Ident {unIdent = "noarg"}}) Nothing},Labeled {label = TokSpan 23 25, unLabel = Constructor (Labeled {label = TokSpan 23 23, unLabel = Ident {unIdent = "valarg"}}) (Just (Labeled {label = TokSpan 25 25, unLabel = TypeDot [Labeled {label = TokSpan 25 25, unLabel = Var (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "Val"}})}]}))},Labeled {label = TokSpan 27 29, unLabel = Constructor (Labeled {label = TokSpan 27 27, unLabel = Ident {unIdent = "slotarg"}}) (Just (Labeled {label = TokSpan 29 29, unLabel = TypeDot [Labeled {label = TokSpan 29 29, unLabel = Var (Labeled {label = TokSpan 29 29, unLabel = Ident {unIdent = "Slot"}})}]}))},Labeled {label = TokSpan 31 35, unLabel = Constructor (Labeled {label = TokSpan 31 31, unLabel = Ident {unIdent = "botharg"}}) (Just (Labeled {label = TokSpan 33 35, unLabel = TypeDot [Labeled {label = TokSpan 33 33, unLabel = Var (Labeled {label = TokSpan 33 33, unLabel = Ident {unIdent = "Val"}})},Labeled {label = TokSpan 35 35, unLabel = Var (Labeled {label = TokSpan 35 35, unLabel = Ident {unIdent = "Slot"}})}]}))}]},Labeled {label = TokSpan 36 43, unLabel = SubType (Labeled {label = TokSpan 37 37, unLabel = Ident {unIdent = "LPSignal"}}) [Labeled {label = TokSpan 39 39, unLabel = Constructor (Labeled {label = TokSpan 39 39, unLabel = Ident {unIdent = "noarg"}}) Nothing},Labeled {label = TokSpan 41 43, unLabel = Constructor (Labeled {label = TokSpan 41 41, unLabel = Ident {unIdent = "slotarg"}}) (Just (Labeled {label = TokSpan 43 43, unLabel = TypeDot [Labeled {label = TokSpan 43 43, unLabel = Var (Labeled {label = TokSpan 43 43, unLabel = Ident {unIdent = "Slot"}})}]}))}]},Labeled {label = TokSpan 44 55, unLabel = SubType (Labeled {label = TokSpan 45 45, unLabel = Ident {unIdent = "HPSignal"}}) [Labeled {label = TokSpan 47 49, unLabel = Constructor (Labeled {label = TokSpan 47 47, unLabel = Ident {unIdent = "valarg"}}) (Just (Labeled {label = TokSpan 49 49, unLabel = TypeDot [Labeled {label = TokSpan 49 49, unLabel = Var (Labeled {label = TokSpan 49 49, unLabel = Ident {unIdent = "Val"}})}]}))},Labeled {label = TokSpan 51 55, unLabel = Constructor (Labeled {label = TokSpan 51 51, unLabel = Ident {unIdent = "botharg"}}) (Just (Labeled {label = TokSpan 53 55, unLabel = TypeDot [Labeled {label = TokSpan 53 53, unLabel = Var (Labeled {label = TokSpan 53 53, unLabel = Ident {unIdent = "Val"}})},Labeled {label = TokSpan 55 55, unLabel = Var (Labeled {label = TokSpan 55 55, unLabel = Ident {unIdent = "Slot"}})}]}))}]},Labeled {label = TokSpan 56 59, unLabel = Channel [Labeled {label = TokSpan 57 57, unLabel = Ident {unIdent = "gen_high_pri"}}] (Just (Labeled {label = TokSpan 59 59, unLabel = TypeDot [Labeled {label = TokSpan 59 59, unLabel = Var (Labeled {label = TokSpan 59 59, unLabel = Ident {unIdent = "HPSignal"}})}]}))},Labeled {label = TokSpan 60 63, unLabel = Channel [Labeled {label = TokSpan 61 61, unLabel = Ident {unIdent = "gen_low_pri"}}] (Just (Labeled {label = TokSpan 63 63, unLabel = TypeDot [Labeled {label = TokSpan 63 63, unLabel = Var (Labeled {label = TokSpan 63 63, unLabel = Ident {unIdent = "LPSignal"}})}]}))},Labeled {label = TokSpan 64 67, unLabel = Channel [Labeled {label = TokSpan 65 65, unLabel = Ident {unIdent = "remove"}}] (Just (Labeled {label = TokSpan 67 67, unLabel = TypeDot [Labeled {label = TokSpan 67 67, unLabel = Var (Labeled {label = TokSpan 67 67, unLabel = Ident {unIdent = "Signal"}})}]}))},Labeled {label = TokSpan 68 70, unLabel = PatBind (Labeled {label = TokSpan 68 68, unLabel = VarPat (Labeled {label = TokSpan 68 68, unLabel = Ident {unIdent = "CAPACITY"}})}) (Labeled {label = TokSpan 70 70, unLabel = IntExp 3})},Labeled {label = TokSpan 71 71, unLabel = FunBind (Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "Q"}}) [FunCase [[Labeled {label = TokSpan 73 73, unLabel = VarPat (Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "s1"}})},Labeled {label = TokSpan 75 75, unLabel = VarPat (Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "s2"}})}]] (Labeled {label = TokPos 139, unLabel = Fun2 "[]" (Labeled {label = TokPos 117, unLabel = Fun2 "[]" (Labeled {label = TokPos 97, unLabel = Fun2 "[]" (Labeled {label = TokPos 82, unLabel = Fun2 "&" (Labeled {label = TokPos 80, unLabel = Fun2 "<" (Labeled {label = TokPos 78, unLabel = Fun1 "#" (Labeled {label = TokSpan 79 79, unLabel = Var (Labeled {label = TokSpan 79 79, unLabel = Ident {unIdent = "s1"}})})}) (Labeled {label = TokSpan 81 81, unLabel = Var (Labeled {label = TokSpan 81 81, unLabel = Ident {unIdent = "CAPACITY"}})})}) (Labeled {label = TokSpan 83 96, unLabel = PrefixExp (Labeled {label = TokSpan 83 83, unLabel = Var (Labeled {label = TokSpan 83 83, unLabel = Ident {unIdent = "gen_high_pri"}})}) [Labeled {label = TokSpan 84 85, unLabel = InComm (Labeled {label = TokSpan 85 85, unLabel = VarPat (Labeled {label = TokSpan 85 85, unLabel = Ident {unIdent = "sig"}})})}] (Labeled {label = TokSpan 87 96, unLabel = CallFunction (Labeled {label = TokSpan 87 87, unLabel = Var (Labeled {label = TokSpan 87 87, unLabel = Ident {unIdent = "Q"}})}) [[Labeled {label = TokPos 90, unLabel = Fun2 "^" (Labeled {label = TokSpan 89 89, unLabel = Var (Labeled {label = TokSpan 89 89, unLabel = Ident {unIdent = "s1"}})}) (Labeled {label = TokSpan 91 93, unLabel = ListEnum [Labeled {label = TokSpan 92 92, unLabel = Var (Labeled {label = TokSpan 92 92, unLabel = Ident {unIdent = "sig"}})}]})},Labeled {label = TokSpan 95 95, unLabel = Var (Labeled {label = TokSpan 95 95, unLabel = Ident {unIdent = "s2"}})}]]})})}) (Labeled {label = TokPos 102, unLabel = Fun2 "&" (Labeled {label = TokPos 100, unLabel = Fun2 "<" (Labeled {label = TokPos 98, unLabel = Fun1 "#" (Labeled {label = TokSpan 99 99, unLabel = Var (Labeled {label = TokSpan 99 99, unLabel = Ident {unIdent = "s2"}})})}) (Labeled {label = TokSpan 101 101, unLabel = Var (Labeled {label = TokSpan 101 101, unLabel = Ident {unIdent = "CAPACITY"}})})}) (Labeled {label = TokSpan 103 116, unLabel = PrefixExp (Labeled {label = TokSpan 103 103, unLabel = Var (Labeled {label = TokSpan 103 103, unLabel = Ident {unIdent = "gen_low_pri"}})}) [Labeled {label = TokSpan 104 105, unLabel = InComm (Labeled {label = TokSpan 105 105, unLabel = VarPat (Labeled {label = TokSpan 105 105, unLabel = Ident {unIdent = "sig"}})})}] (Labeled {label = TokSpan 107 116, unLabel = CallFunction (Labeled {label = TokSpan 107 107, unLabel = Var (Labeled {label = TokSpan 107 107, unLabel = Ident {unIdent = "Q"}})}) [[Labeled {label = TokSpan 109 109, unLabel = Var (Labeled {label = TokSpan 109 109, unLabel = Ident {unIdent = "s1"}})},Labeled {label = TokPos 112, unLabel = Fun2 "^" (Labeled {label = TokSpan 111 111, unLabel = Var (Labeled {label = TokSpan 111 111, unLabel = Ident {unIdent = "s2"}})}) (Labeled {label = TokSpan 113 115, unLabel = ListEnum [Labeled {label = TokSpan 114 114, unLabel = Var (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "sig"}})}]})}]]})})})}) (Labeled {label = TokPos 122, unLabel = Fun2 "&" (Labeled {label = TokPos 121, unLabel = Fun2 ">" (Labeled {label = TokPos 118, unLabel = Fun1 "#" (Labeled {label = TokSpan 119 119, unLabel = Var (Labeled {label = TokSpan 119 119, unLabel = Ident {unIdent = "s1"}})})}) (Labeled {label = TokSpan 121 121, unLabel = IntExp 0})}) (Labeled {label = TokSpan 123 138, unLabel = PrefixExp (Labeled {label = TokSpan 123 123, unLabel = Var (Labeled {label = TokSpan 123 123, unLabel = Ident {unIdent = "remove"}})}) [Labeled {label = TokSpan 124 128, unLabel = OutComm (Labeled {label = TokSpan 125 128, unLabel = CallBuiltIn (Labeled {label = TokSpan 125 125, unLabel = BuiltIn "head"}) [[Labeled {label = TokSpan 127 127, unLabel = Var (Labeled {label = TokSpan 127 127, unLabel = Ident {unIdent = "s1"}})}]]})}] (Labeled {label = TokSpan 130 138, unLabel = CallFunction (Labeled {label = TokSpan 130 130, unLabel = Var (Labeled {label = TokSpan 130 130, unLabel = Ident {unIdent = "Q"}})}) [[Labeled {label = TokSpan 132 135, unLabel = CallBuiltIn (Labeled {label = TokSpan 132 132, unLabel = BuiltIn "tail"}) [[Labeled {label = TokSpan 134 134, unLabel = Var (Labeled {label = TokSpan 134 134, unLabel = Ident {unIdent = "s1"}})}]]},Labeled {label = TokSpan 137 137, unLabel = Var (Labeled {label = TokSpan 137 137, unLabel = Ident {unIdent = "s2"}})}]]})})})}) (Labeled {label = TokPos 149, unLabel = Fun2 "&" (Labeled {label = TokPos 144, unLabel = AndExp (Labeled {label = TokPos 142, unLabel = Fun2 "==" (Labeled {label = TokPos 140, unLabel = Fun1 "#" (Labeled {label = TokSpan 141 141, unLabel = Var (Labeled {label = TokSpan 141 141, unLabel = Ident {unIdent = "s1"}})})}) (Labeled {label = TokSpan 143 143, unLabel = IntExp 0})}) (Labeled {label = TokPos 148, unLabel = Fun2 ">" (Labeled {label = TokPos 145, unLabel = Fun1 "#" (Labeled {label = TokSpan 146 146, unLabel = Var (Labeled {label = TokSpan 146 146, unLabel = Ident {unIdent = "s2"}})})}) (Labeled {label = TokSpan 148 148, unLabel = IntExp 0})})}) (Labeled {label = TokSpan 150 165, unLabel = PrefixExp (Labeled {label = TokSpan 150 150, unLabel = Var (Labeled {label = TokSpan 150 150, unLabel = Ident {unIdent = "remove"}})}) [Labeled {label = TokSpan 151 155, unLabel = OutComm (Labeled {label = TokSpan 152 155, unLabel = CallBuiltIn (Labeled {label = TokSpan 152 152, unLabel = BuiltIn "head"}) [[Labeled {label = TokSpan 154 154, unLabel = Var (Labeled {label = TokSpan 154 154, unLabel = Ident {unIdent = "s2"}})}]]})}] (Labeled {label = TokSpan 157 165, unLabel = CallFunction (Labeled {label = TokSpan 157 157, unLabel = Var (Labeled {label = TokSpan 157 157, unLabel = Ident {unIdent = "Q"}})}) [[Labeled {label = TokSpan 159 159, unLabel = Var (Labeled {label = TokSpan 159 159, unLabel = Ident {unIdent = "s1"}})},Labeled {label = TokSpan 161 164, unLabel = CallBuiltIn (Labeled {label = TokSpan 161 161, unLabel = BuiltIn "tail"}) [[Labeled {label = TokSpan 163 163, unLabel = Var (Labeled {label = TokSpan 163 163, unLabel = Ident {unIdent = "s2"}})}]]}]]})})})})]},Labeled {label = TokSpan 166 192, unLabel = PatBind (Labeled {label = TokSpan 166 166, unLabel = VarPat (Labeled {label = TokSpan 166 166, unLabel = Ident {unIdent = "IN"}})}) (Labeled {label = TokSpan 168 192, unLabel = PrefixExp (Labeled {label = TokSpan 168 168, unLabel = Var (Labeled {label = TokSpan 168 168, unLabel = Ident {unIdent = "gen_low_pri"}})}) [Labeled {label = TokSpan 169 170, unLabel = OutComm (Labeled {label = TokSpan 170 170, unLabel = Var (Labeled {label = TokSpan 170 170, unLabel = Ident {unIdent = "noarg"}})})}] (Labeled {label = TokSpan 172 192, unLabel = PrefixExp (Labeled {label = TokSpan 172 172, unLabel = Var (Labeled {label = TokSpan 172 172, unLabel = Ident {unIdent = "gen_high_pri"}})}) [Labeled {label = TokSpan 173 174, unLabel = OutComm (Labeled {label = TokSpan 174 174, unLabel = Var (Labeled {label = TokSpan 174 174, unLabel = Ident {unIdent = "valarg"}})})},Labeled {label = TokSpan 175 176, unLabel = InComm (Labeled {label = TokSpan 176 176, unLabel = VarPat (Labeled {label = TokSpan 176 176, unLabel = Ident {unIdent = "v1"}})})}] (Labeled {label = TokSpan 178 192, unLabel = PrefixExp (Labeled {label = TokSpan 178 178, unLabel = Var (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "gen_low_pri"}})}) [Labeled {label = TokSpan 179 180, unLabel = OutComm (Labeled {label = TokSpan 180 180, unLabel = Var (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "slotarg"}})})},Labeled {label = TokSpan 181 182, unLabel = InComm (Labeled {label = TokSpan 182 182, unLabel = VarPat (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "s1"}})})}] (Labeled {label = TokSpan 184 192, unLabel = PrefixExp (Labeled {label = TokSpan 184 184, unLabel = Var (Labeled {label = TokSpan 184 184, unLabel = Ident {unIdent = "gen_high_pri"}})}) [Labeled {label = TokSpan 185 186, unLabel = OutComm (Labeled {label = TokSpan 186 186, unLabel = Var (Labeled {label = TokSpan 186 186, unLabel = Ident {unIdent = "botharg"}})})},Labeled {label = TokSpan 187 188, unLabel = InComm (Labeled {label = TokSpan 188 188, unLabel = VarPat (Labeled {label = TokSpan 188 188, unLabel = Ident {unIdent = "v2"}})})},Labeled {label = TokSpan 189 190, unLabel = InComm (Labeled {label = TokSpan 190 190, unLabel = VarPat (Labeled {label = TokSpan 190 190, unLabel = Ident {unIdent = "s2"}})})}] (Labeled {label = TokSpan 192 192, unLabel = Stop})})})})})},Labeled {label = TokSpan 193 199, unLabel = PatBind (Labeled {label = TokSpan 193 193, unLabel = VarPat (Labeled {label = TokSpan 193 193, unLabel = Ident {unIdent = "OUT"}})}) (Labeled {label = TokSpan 195 199, unLabel = PrefixExp (Labeled {label = TokSpan 195 195, unLabel = Var (Labeled {label = TokSpan 195 195, unLabel = Ident {unIdent = "remove"}})}) [Labeled {label = TokSpan 196 197, unLabel = InComm (Labeled {label = TokSpan 197 197, unLabel = VarPat (Labeled {label = TokSpan 197 197, unLabel = Ident {unIdent = "s"}})})}] (Labeled {label = TokSpan 199 199, unLabel = Var (Labeled {label = TokSpan 199 199, unLabel = Ident {unIdent = "OUT"}})})})},Labeled {label = TokSpan 200 223, unLabel = PatBind (Labeled {label = TokSpan 200 200, unLabel = VarPat (Labeled {label = TokSpan 200 200, unLabel = Ident {unIdent = "NET"}})}) (Labeled {label = TokSpan 207 215, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 208 214, unLabel = Closure [Labeled {label = TokSpan 209 209, unLabel = Var (Labeled {label = TokSpan 209 209, unLabel = Ident {unIdent = "gen_high_pri"}})},Labeled {label = TokSpan 211 211, unLabel = Var (Labeled {label = TokSpan 211 211, unLabel = Ident {unIdent = "gen_low_pri"}})},Labeled {label = TokSpan 213 213, unLabel = Var (Labeled {label = TokSpan 213 213, unLabel = Ident {unIdent = "remove"}})}]}) (Labeled {label = TokSpan 202 206, unLabel = Parens (Labeled {label = TokPos 204, unLabel = Fun2 "|||" (Labeled {label = TokSpan 203 203, unLabel = Var (Labeled {label = TokSpan 203 203, unLabel = Ident {unIdent = "IN"}})}) (Labeled {label = TokSpan 205 205, unLabel = Var (Labeled {label = TokSpan 205 205, unLabel = Ident {unIdent = "OUT"}})})})}) (Labeled {label = TokSpan 216 223, unLabel = CallFunction (Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "Q"}})}) [[Labeled {label = TokSpan 218 219, unLabel = ListEnum []},Labeled {label = TokSpan 221 222, unLabel = ListEnum []}]]})})}]}
