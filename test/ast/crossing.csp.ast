Labeled {label = TokSpan 6 1415, unLabel = Module [Labeled {label = TokSpan 6 7, unLabel = Channel [Labeled {label = TokSpan 7 7, unLabel = Ident {unIdent = "tock"}}] Nothing},Labeled {label = TokSpan 10 19, unLabel = DataType (Labeled {label = TokSpan 11 11, unLabel = Ident {unIdent = "GateControl"}}) [Labeled {label = TokSpan 13 13, unLabel = Constructor (Labeled {label = TokSpan 13 13, unLabel = Ident {unIdent = "go_down"}}) Nothing},Labeled {label = TokSpan 15 15, unLabel = Constructor (Labeled {label = TokSpan 15 15, unLabel = Ident {unIdent = "go_up"}}) Nothing},Labeled {label = TokSpan 17 17, unLabel = Constructor (Labeled {label = TokSpan 17 17, unLabel = Ident {unIdent = "up"}}) Nothing},Labeled {label = TokSpan 19 19, unLabel = Constructor (Labeled {label = TokSpan 19 19, unLabel = Ident {unIdent = "down"}}) Nothing}]},Labeled {label = TokSpan 22 25, unLabel = Channel [Labeled {label = TokSpan 23 23, unLabel = Ident {unIdent = "gate"}}] (Just (Labeled {label = TokSpan 25 25, unLabel = TypeDot [Labeled {label = TokSpan 25 25, unLabel = Var (Labeled {label = TokSpan 25 25, unLabel = Ident {unIdent = "GateControl"}})}]}))},Labeled {label = TokSpan 27 28, unLabel = Channel [Labeled {label = TokSpan 28 28, unLabel = Ident {unIdent = "error"}}] Nothing},Labeled {label = TokSpan 32 34, unLabel = PatBind (Labeled {label = TokSpan 32 32, unLabel = VarPat (Labeled {label = TokSpan 32 32, unLabel = Ident {unIdent = "Segments"}})}) (Labeled {label = TokSpan 34 34, unLabel = IntExp 5})},Labeled {label = TokSpan 36 40, unLabel = PatBind (Labeled {label = TokSpan 36 36, unLabel = VarPat (Labeled {label = TokSpan 36 36, unLabel = Ident {unIdent = "LastSeg"}})}) (Labeled {label = TokPos 39, unLabel = Fun2 "-" (Labeled {label = TokSpan 38 38, unLabel = Var (Labeled {label = TokSpan 38 38, unLabel = Ident {unIdent = "Segments"}})}) (Labeled {label = TokSpan 40 40, unLabel = IntExp 1})})},Labeled {label = TokSpan 41 47, unLabel = PatBind (Labeled {label = TokSpan 41 41, unLabel = VarPat (Labeled {label = TokSpan 41 41, unLabel = Ident {unIdent = "TRACKS"}})}) (Labeled {label = TokSpan 43 47, unLabel = SetClose (Labeled {label = TokSpan 44 44, unLabel = IntExp 0},Labeled {label = TokSpan 46 46, unLabel = Var (Labeled {label = TokSpan 46 46, unLabel = Ident {unIdent = "LastSeg"}})})})},Labeled {label = TokSpan 48 54, unLabel = PatBind (Labeled {label = TokSpan 48 48, unLabel = VarPat (Labeled {label = TokSpan 48 48, unLabel = Ident {unIdent = "REALTRACKS"}})}) (Labeled {label = TokSpan 50 54, unLabel = SetClose (Labeled {label = TokSpan 51 51, unLabel = IntExp 1},Labeled {label = TokSpan 53 53, unLabel = Var (Labeled {label = TokSpan 53 53, unLabel = Ident {unIdent = "LastSeg"}})})})},Labeled {label = TokSpan 57 59, unLabel = PatBind (Labeled {label = TokSpan 57 57, unLabel = VarPat (Labeled {label = TokSpan 57 57, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 59 59, unLabel = IntExp 3})},Labeled {label = TokSpan 61 66, unLabel = DataType (Labeled {label = TokSpan 62 62, unLabel = Ident {unIdent = "TRAINS"}}) [Labeled {label = TokSpan 64 64, unLabel = Constructor (Labeled {label = TokSpan 64 64, unLabel = Ident {unIdent = "Thomas"}}) Nothing},Labeled {label = TokSpan 66 66, unLabel = Constructor (Labeled {label = TokSpan 66 66, unLabel = Ident {unIdent = "Gordon"}}) Nothing}]},Labeled {label = TokSpan 68 75, unLabel = Channel [Labeled {label = TokSpan 69 69, unLabel = Ident {unIdent = "enter"}},Labeled {label = TokSpan 71 71, unLabel = Ident {unIdent = "leave"}}] (Just (Labeled {label = TokSpan 73 75, unLabel = TypeDot [Labeled {label = TokSpan 73 73, unLabel = Var (Labeled {label = TokSpan 73 73, unLabel = Ident {unIdent = "TRACKS"}})},Labeled {label = TokSpan 75 75, unLabel = Var (Labeled {label = TokSpan 75 75, unLabel = Ident {unIdent = "TRAINS"}})}]}))},Labeled {label = TokSpan 79 84, unLabel = DataType (Labeled {label = TokSpan 80 80, unLabel = Ident {unIdent = "sensed"}}) [Labeled {label = TokSpan 82 82, unLabel = Constructor (Labeled {label = TokSpan 82 82, unLabel = Ident {unIdent = "in"}}) Nothing},Labeled {label = TokSpan 84 84, unLabel = Constructor (Labeled {label = TokSpan 84 84, unLabel = Ident {unIdent = "out"}}) Nothing}]},Labeled {label = TokSpan 85 88, unLabel = Channel [Labeled {label = TokSpan 86 86, unLabel = Ident {unIdent = "sensor"}}] (Just (Labeled {label = TokSpan 88 88, unLabel = TypeDot [Labeled {label = TokSpan 88 88, unLabel = Var (Labeled {label = TokSpan 88 88, unLabel = Ident {unIdent = "sensed"}})}]}))},Labeled {label = TokSpan 91 91, unLabel = FunBind (Labeled {label = TokSpan 91 91, unLabel = Ident {unIdent = "Train"}}) [FunCase [[Labeled {label = TokSpan 93 93, unLabel = VarPat (Labeled {label = TokSpan 93 93, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokSpan 95 95, unLabel = VarPat (Labeled {label = TokSpan 95 95, unLabel = Ident {unIdent = "j"}})}]] (Labeled {label = TokSpan 98 129, unLabel = PrefixExp (Labeled {label = TokSpan 98 98, unLabel = Var (Labeled {label = TokSpan 98 98, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 99 108, unLabel = OutComm (Labeled {label = TokSpan 100 108, unLabel = Parens (Labeled {label = TokPos 106, unLabel = Fun2 "%" (Labeled {label = TokSpan 101 105, unLabel = Parens (Labeled {label = TokPos 103, unLabel = Fun2 "+" (Labeled {label = TokSpan 102 102, unLabel = Var (Labeled {label = TokSpan 102 102, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 104 104, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 107 107, unLabel = Var (Labeled {label = TokSpan 107 107, unLabel = Ident {unIdent = "Segments"}})})})})},Labeled {label = TokSpan 109 110, unLabel = OutComm (Labeled {label = TokSpan 110 110, unLabel = Var (Labeled {label = TokSpan 110 110, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 112 129, unLabel = PrefixExp (Labeled {label = TokSpan 112 112, unLabel = Var (Labeled {label = TokSpan 112 112, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 113 114, unLabel = OutComm (Labeled {label = TokSpan 114 114, unLabel = Var (Labeled {label = TokSpan 114 114, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 115 116, unLabel = OutComm (Labeled {label = TokSpan 116 116, unLabel = Var (Labeled {label = TokSpan 116 116, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 118 129, unLabel = CallFunction (Labeled {label = TokSpan 118 118, unLabel = Var (Labeled {label = TokSpan 118 118, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 120 120, unLabel = Var (Labeled {label = TokSpan 120 120, unLabel = Ident {unIdent = "A"}})},Labeled {label = TokPos 127, unLabel = Fun2 "%" (Labeled {label = TokSpan 122 126, unLabel = Parens (Labeled {label = TokPos 124, unLabel = Fun2 "+" (Labeled {label = TokSpan 123 123, unLabel = Var (Labeled {label = TokSpan 123 123, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 125 125, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 128 128, unLabel = Var (Labeled {label = TokSpan 128 128, unLabel = Ident {unIdent = "Segments"}})})}]]})})})]},Labeled {label = TokSpan 131 145, unLabel = PatBind (Labeled {label = TokSpan 131 131, unLabel = VarPat (Labeled {label = TokSpan 131 131, unLabel = Ident {unIdent = "Trains"}})}) (Labeled {label = TokPos 139, unLabel = Fun2 "|||" (Labeled {label = TokSpan 133 138, unLabel = CallFunction (Labeled {label = TokSpan 133 133, unLabel = Var (Labeled {label = TokSpan 133 133, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 135 135, unLabel = Var (Labeled {label = TokSpan 135 135, unLabel = Ident {unIdent = "Thomas"}})},Labeled {label = TokSpan 137 137, unLabel = IntExp 0}]]}) (Labeled {label = TokSpan 140 145, unLabel = CallFunction (Labeled {label = TokSpan 140 140, unLabel = Var (Labeled {label = TokSpan 140 140, unLabel = Ident {unIdent = "Train"}})}) [[Labeled {label = TokSpan 142 142, unLabel = Var (Labeled {label = TokSpan 142 142, unLabel = Ident {unIdent = "Gordon"}})},Labeled {label = TokSpan 144 144, unLabel = IntExp 0}]]})})},Labeled {label = TokSpan 148 148, unLabel = FunBind (Labeled {label = TokSpan 148 148, unLabel = Ident {unIdent = "Track"}}) [FunCase [[Labeled {label = TokSpan 150 150, unLabel = VarPat (Labeled {label = TokSpan 150 150, unLabel = Ident {unIdent = "j"}})}]] (Labeled {label = TokSpan 153 204, unLabel = Let [Labeled {label = TokSpan 154 179, unLabel = PatBind (Labeled {label = TokSpan 154 154, unLabel = VarPat (Labeled {label = TokSpan 154 154, unLabel = Ident {unIdent = "Empty"}})}) (Labeled {label = TokSpan 156 179, unLabel = PrefixExp (Labeled {label = TokSpan 156 156, unLabel = Var (Labeled {label = TokSpan 156 156, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 157 158, unLabel = OutComm (Labeled {label = TokSpan 158 158, unLabel = Var (Labeled {label = TokSpan 158 158, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 159 160, unLabel = InComm (Labeled {label = TokSpan 160 160, unLabel = VarPat (Labeled {label = TokSpan 160 160, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 162 179, unLabel = Ifte (Labeled {label = TokPos 164, unLabel = Fun2 "==" (Labeled {label = TokSpan 163 163, unLabel = Var (Labeled {label = TokSpan 163 163, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 165 165, unLabel = IntExp 1})}) (Labeled {label = TokSpan 167 174, unLabel = PrefixExp (Labeled {label = TokSpan 167 167, unLabel = Var (Labeled {label = TokSpan 167 167, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 168 169, unLabel = OutComm (Labeled {label = TokSpan 169 169, unLabel = Var (Labeled {label = TokSpan 169 169, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 171 174, unLabel = CallFunction (Labeled {label = TokSpan 171 171, unLabel = Var (Labeled {label = TokSpan 171 171, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 173 173, unLabel = Var (Labeled {label = TokSpan 173 173, unLabel = Ident {unIdent = "A"}})}]]})}) (Labeled {label = TokSpan 176 179, unLabel = CallFunction (Labeled {label = TokSpan 176 176, unLabel = Var (Labeled {label = TokSpan 176 176, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 178 178, unLabel = Var (Labeled {label = TokSpan 178 178, unLabel = Ident {unIdent = "A"}})}]]})})})},Labeled {label = TokSpan 180 180, unLabel = FunBind (Labeled {label = TokSpan 180 180, unLabel = Ident {unIdent = "Full"}}) [FunCase [[Labeled {label = TokSpan 182 182, unLabel = VarPat (Labeled {label = TokSpan 182 182, unLabel = Ident {unIdent = "A"}})}]] (Labeled {label = TokSpan 185 202, unLabel = PrefixExp (Labeled {label = TokSpan 185 185, unLabel = Var (Labeled {label = TokSpan 185 185, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 186 187, unLabel = OutComm (Labeled {label = TokSpan 187 187, unLabel = Var (Labeled {label = TokSpan 187 187, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 188 189, unLabel = OutComm (Labeled {label = TokSpan 189 189, unLabel = Var (Labeled {label = TokSpan 189 189, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 191 202, unLabel = Ifte (Labeled {label = TokPos 193, unLabel = Fun2 "==" (Labeled {label = TokSpan 192 192, unLabel = Var (Labeled {label = TokSpan 192 192, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 194 194, unLabel = Var (Labeled {label = TokSpan 194 194, unLabel = Ident {unIdent = "GateSeg"}})})}) (Labeled {label = TokSpan 196 200, unLabel = PrefixExp (Labeled {label = TokSpan 196 196, unLabel = Var (Labeled {label = TokSpan 196 196, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 197 198, unLabel = OutComm (Labeled {label = TokSpan 198 198, unLabel = Var (Labeled {label = TokSpan 198 198, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 200 200, unLabel = Var (Labeled {label = TokSpan 200 200, unLabel = Ident {unIdent = "Empty"}})})}) (Labeled {label = TokSpan 202 202, unLabel = Var (Labeled {label = TokSpan 202 202, unLabel = Ident {unIdent = "Empty"}})})})})]}] (Labeled {label = TokSpan 204 204, unLabel = Var (Labeled {label = TokSpan 204 204, unLabel = Ident {unIdent = "Empty"}})})})]},Labeled {label = TokSpan 207 217, unLabel = PatBind (Labeled {label = TokSpan 207 207, unLabel = VarPat (Labeled {label = TokSpan 207 207, unLabel = Ident {unIdent = "Tracks"}})}) (Labeled {label = TokSpan 209 217, unLabel = ProcRepInterleave [Labeled {label = TokSpan 210 212, unLabel = Generator (Labeled {label = TokSpan 210 210, unLabel = VarPat (Labeled {label = TokSpan 210 210, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 212 212, unLabel = Var (Labeled {label = TokSpan 212 212, unLabel = Ident {unIdent = "REALTRACKS"}})})}] (Labeled {label = TokSpan 214 217, unLabel = CallFunction (Labeled {label = TokSpan 214 214, unLabel = Var (Labeled {label = TokSpan 214 214, unLabel = Ident {unIdent = "Track"}})}) [[Labeled {label = TokSpan 216 216, unLabel = Var (Labeled {label = TokSpan 216 216, unLabel = Ident {unIdent = "j"}})}]]})})},Labeled {label = TokSpan 221 239, unLabel = PatBind (Labeled {label = TokSpan 221 221, unLabel = VarPat (Labeled {label = TokSpan 221 221, unLabel = Ident {unIdent = "Network"}})}) (Labeled {label = TokSpan 224 238, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 225 237, unLabel = ClosureComprehension ([Labeled {label = TokSpan 226 228, unLabel = DotTuple [Labeled {label = TokSpan 226 226, unLabel = Var (Labeled {label = TokSpan 226 226, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 228 228, unLabel = Var (Labeled {label = TokSpan 228 228, unLabel = Ident {unIdent = "j"}})}]},Labeled {label = TokSpan 230 232, unLabel = DotTuple [Labeled {label = TokSpan 230 230, unLabel = Var (Labeled {label = TokSpan 230 230, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 232 232, unLabel = Var (Labeled {label = TokSpan 232 232, unLabel = Ident {unIdent = "j"}})}]}],[Labeled {label = TokSpan 234 236, unLabel = Generator (Labeled {label = TokSpan 234 234, unLabel = VarPat (Labeled {label = TokSpan 234 234, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 236 236, unLabel = Var (Labeled {label = TokSpan 236 236, unLabel = Ident {unIdent = "REALTRACKS"}})})}])}) (Labeled {label = TokSpan 223 223, unLabel = Var (Labeled {label = TokSpan 223 223, unLabel = Ident {unIdent = "Trains"}})}) (Labeled {label = TokSpan 239 239, unLabel = Var (Labeled {label = TokSpan 239 239, unLabel = Ident {unIdent = "Tracks"}})})})},Labeled {label = TokSpan 243 245, unLabel = PatBind (Labeled {label = TokSpan 243 243, unLabel = VarPat (Labeled {label = TokSpan 243 243, unLabel = Ident {unIdent = "SlowTrain"}})}) (Labeled {label = TokSpan 245 245, unLabel = IntExp 4})},Labeled {label = TokSpan 247 249, unLabel = PatBind (Labeled {label = TokSpan 247 247, unLabel = VarPat (Labeled {label = TokSpan 247 247, unLabel = Ident {unIdent = "NormalTrain"}})}) (Labeled {label = TokSpan 249 249, unLabel = IntExp 3})},Labeled {label = TokSpan 250 252, unLabel = PatBind (Labeled {label = TokSpan 250 250, unLabel = VarPat (Labeled {label = TokSpan 250 250, unLabel = Ident {unIdent = "FastTrain"}})}) (Labeled {label = TokSpan 252 252, unLabel = IntExp 2})},Labeled {label = TokSpan 253 255, unLabel = PatBind (Labeled {label = TokSpan 253 253, unLabel = VarPat (Labeled {label = TokSpan 253 253, unLabel = Ident {unIdent = "MaxTocksPerSeg"}})}) (Labeled {label = TokSpan 255 255, unLabel = IntExp 6})},Labeled {label = TokSpan 258 258, unLabel = FunBind (Labeled {label = TokSpan 258 258, unLabel = Ident {unIdent = "SpeedReg"}}) [FunCase [[Labeled {label = TokSpan 260 260, unLabel = VarPat (Labeled {label = TokSpan 260 260, unLabel = Ident {unIdent = "j"}})},Labeled {label = TokSpan 262 262, unLabel = VarPat (Labeled {label = TokSpan 262 262, unLabel = Ident {unIdent = "MinTocksPerSeg"}})}]] (Labeled {label = TokSpan 265 318, unLabel = Let [Labeled {label = TokSpan 266 281, unLabel = PatBind (Labeled {label = TokSpan 266 266, unLabel = VarPat (Labeled {label = TokSpan 266 266, unLabel = Ident {unIdent = "Empty"}})}) (Labeled {label = TokPos 278, unLabel = Fun2 "[]" (Labeled {label = TokSpan 268 277, unLabel = PrefixExp (Labeled {label = TokSpan 268 268, unLabel = Var (Labeled {label = TokSpan 268 268, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 269 270, unLabel = OutComm (Labeled {label = TokSpan 270 270, unLabel = Var (Labeled {label = TokSpan 270 270, unLabel = Ident {unIdent = "j"}})})},Labeled {label = TokSpan 271 272, unLabel = InComm (Labeled {label = TokSpan 272 272, unLabel = VarPat (Labeled {label = TokSpan 272 272, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 274 277, unLabel = CallFunction (Labeled {label = TokSpan 274 274, unLabel = Var (Labeled {label = TokSpan 274 274, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokSpan 276 276, unLabel = IntExp 0}]]})}) (Labeled {label = TokSpan 279 281, unLabel = PrefixExp (Labeled {label = TokSpan 279 279, unLabel = Var (Labeled {label = TokSpan 279 279, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 281 281, unLabel = Var (Labeled {label = TokSpan 281 281, unLabel = Ident {unIdent = "Empty"}})})})})},Labeled {label = TokSpan 282 282, unLabel = FunBind (Labeled {label = TokSpan 282 282, unLabel = Ident {unIdent = "Full"}}) [FunCase [[Labeled {label = TokSpan 284 284, unLabel = VarPat (Labeled {label = TokSpan 284 284, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 299, unLabel = Fun2 "[]" (Labeled {label = TokPos 290, unLabel = Fun2 "&" (Labeled {label = TokPos 288, unLabel = Fun2 "<" (Labeled {label = TokSpan 287 287, unLabel = Var (Labeled {label = TokSpan 287 287, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 289 289, unLabel = Var (Labeled {label = TokSpan 289 289, unLabel = Ident {unIdent = "MaxTocksPerSeg"}})})}) (Labeled {label = TokSpan 291 298, unLabel = PrefixExp (Labeled {label = TokSpan 291 291, unLabel = Var (Labeled {label = TokSpan 291 291, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 293 298, unLabel = CallFunction (Labeled {label = TokSpan 293 293, unLabel = Var (Labeled {label = TokSpan 293 293, unLabel = Ident {unIdent = "Full"}})}) [[Labeled {label = TokPos 296, unLabel = Fun2 "+" (Labeled {label = TokSpan 295 295, unLabel = Var (Labeled {label = TokSpan 295 295, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 297 297, unLabel = IntExp 1})}]]})})}) (Labeled {label = TokPos 303, unLabel = Fun2 "&" (Labeled {label = TokPos 301, unLabel = Fun2 "<=" (Labeled {label = TokSpan 300 300, unLabel = Var (Labeled {label = TokSpan 300 300, unLabel = Ident {unIdent = "MinTocksPerSeg"}})}) (Labeled {label = TokSpan 302 302, unLabel = Var (Labeled {label = TokSpan 302 302, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 304 316, unLabel = PrefixExp (Labeled {label = TokSpan 304 304, unLabel = Var (Labeled {label = TokSpan 304 304, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 305 312, unLabel = OutComm (Labeled {label = TokPos 311, unLabel = Fun2 "%" (Labeled {label = TokSpan 306 310, unLabel = Parens (Labeled {label = TokPos 308, unLabel = Fun2 "+" (Labeled {label = TokSpan 307 307, unLabel = Var (Labeled {label = TokSpan 307 307, unLabel = Ident {unIdent = "j"}})}) (Labeled {label = TokSpan 309 309, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 312 312, unLabel = Var (Labeled {label = TokSpan 312 312, unLabel = Ident {unIdent = "Segments"}})})})},Labeled {label = TokSpan 313 314, unLabel = InComm (Labeled {label = TokSpan 314 314, unLabel = VarPat (Labeled {label = TokSpan 314 314, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 316 316, unLabel = Var (Labeled {label = TokSpan 316 316, unLabel = Ident {unIdent = "Empty"}})})})})})]}] (Labeled {label = TokSpan 318 318, unLabel = Var (Labeled {label = TokSpan 318 318, unLabel = Ident {unIdent = "Empty"}})})})]},Labeled {label = TokSpan 322 338, unLabel = PatBind (Labeled {label = TokSpan 322 322, unLabel = VarPat (Labeled {label = TokSpan 322 322, unLabel = Ident {unIdent = "InSensorTiming"}})}) (Labeled {label = TokPos 327, unLabel = Fun2 "[]" (Labeled {label = TokSpan 324 326, unLabel = PrefixExp (Labeled {label = TokSpan 324 324, unLabel = Var (Labeled {label = TokSpan 324 324, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 326 326, unLabel = Var (Labeled {label = TokSpan 326 326, unLabel = Ident {unIdent = "InSensorTiming"}})})}) (Labeled {label = TokSpan 328 338, unLabel = PrefixExp (Labeled {label = TokSpan 328 328, unLabel = Var (Labeled {label = TokSpan 328 328, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 329 330, unLabel = OutComm (Labeled {label = TokSpan 330 330, unLabel = IntExp 1})},Labeled {label = TokSpan 331 332, unLabel = InComm (Labeled {label = TokSpan 332 332, unLabel = VarPat (Labeled {label = TokSpan 332 332, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 334 338, unLabel = PrefixExp (Labeled {label = TokSpan 334 334, unLabel = Var (Labeled {label = TokSpan 334 334, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 335 336, unLabel = OutComm (Labeled {label = TokSpan 336 336, unLabel = Var (Labeled {label = TokSpan 336 336, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 338 338, unLabel = Var (Labeled {label = TokSpan 338 338, unLabel = Ident {unIdent = "InSensorTiming"}})})})})})},Labeled {label = TokSpan 339 355, unLabel = PatBind (Labeled {label = TokSpan 339 339, unLabel = VarPat (Labeled {label = TokSpan 339 339, unLabel = Ident {unIdent = "OutSensorTiming"}})}) (Labeled {label = TokPos 344, unLabel = Fun2 "[]" (Labeled {label = TokSpan 341 343, unLabel = PrefixExp (Labeled {label = TokSpan 341 341, unLabel = Var (Labeled {label = TokSpan 341 341, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 343 343, unLabel = Var (Labeled {label = TokSpan 343 343, unLabel = Ident {unIdent = "OutSensorTiming"}})})}) (Labeled {label = TokSpan 345 355, unLabel = PrefixExp (Labeled {label = TokSpan 345 345, unLabel = Var (Labeled {label = TokSpan 345 345, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 346 347, unLabel = OutComm (Labeled {label = TokSpan 347 347, unLabel = Var (Labeled {label = TokSpan 347 347, unLabel = Ident {unIdent = "GateSeg"}})})},Labeled {label = TokSpan 348 349, unLabel = InComm (Labeled {label = TokSpan 349 349, unLabel = VarPat (Labeled {label = TokSpan 349 349, unLabel = Ident {unIdent = "A"}})})}] (Labeled {label = TokSpan 351 355, unLabel = PrefixExp (Labeled {label = TokSpan 351 351, unLabel = Var (Labeled {label = TokSpan 351 351, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 352 353, unLabel = OutComm (Labeled {label = TokSpan 353 353, unLabel = Var (Labeled {label = TokSpan 353 353, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 355 355, unLabel = Var (Labeled {label = TokSpan 355 355, unLabel = Ident {unIdent = "OutSensorTiming"}})})})})})},Labeled {label = TokSpan 361 361, unLabel = FunBind (Labeled {label = TokSpan 361 361, unLabel = Ident {unIdent = "SpeedRegs"}}) [FunCase [[Labeled {label = TokSpan 363 363, unLabel = VarPat (Labeled {label = TokSpan 363 363, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 366 366, unLabel = Stop})]},Labeled {label = TokSpan 367 375, unLabel = PatBind (Labeled {label = TokSpan 367 367, unLabel = VarPat (Labeled {label = TokSpan 367 367, unLabel = Ident {unIdent = "SensorTiming"}})}) (Labeled {label = TokSpan 370 374, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 371 373, unLabel = SetEnum [Labeled {label = TokSpan 372 372, unLabel = Var (Labeled {label = TokSpan 372 372, unLabel = Ident {unIdent = "tock"}})}]}) (Labeled {label = TokSpan 369 369, unLabel = Var (Labeled {label = TokSpan 369 369, unLabel = Ident {unIdent = "InSensorTiming"}})}) (Labeled {label = TokSpan 375 375, unLabel = Var (Labeled {label = TokSpan 375 375, unLabel = Ident {unIdent = "OutSensorTiming"}})})})},Labeled {label = TokSpan 376 376, unLabel = FunBind (Labeled {label = TokSpan 376 376, unLabel = Ident {unIdent = "NetworkTiming"}}) [FunCase [[Labeled {label = TokSpan 378 378, unLabel = VarPat (Labeled {label = TokSpan 378 378, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 385 393, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 386 392, unLabel = Closure [Labeled {label = TokSpan 387 387, unLabel = Var (Labeled {label = TokSpan 387 387, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 389 391, unLabel = DotTuple [Labeled {label = TokSpan 389 389, unLabel = Var (Labeled {label = TokSpan 389 389, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 391 391, unLabel = IntExp 1}]}]}) (Labeled {label = TokSpan 381 384, unLabel = CallFunction (Labeled {label = TokSpan 381 381, unLabel = Var (Labeled {label = TokSpan 381 381, unLabel = Ident {unIdent = "SpeedRegs"}})}) [[Labeled {label = TokSpan 383 383, unLabel = Var (Labeled {label = TokSpan 383 383, unLabel = Ident {unIdent = "min"}})}]]}) (Labeled {label = TokSpan 394 394, unLabel = Var (Labeled {label = TokSpan 394 394, unLabel = Ident {unIdent = "SensorTiming"}})})})]},Labeled {label = TokSpan 395 395, unLabel = FunBind (Labeled {label = TokSpan 395 395, unLabel = Ident {unIdent = "TimedNetwork"}}) [FunCase [[Labeled {label = TokSpan 397 397, unLabel = VarPat (Labeled {label = TokSpan 397 397, unLabel = Ident {unIdent = "min"}})}]] (Labeled {label = TokSpan 401 411, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 402 410, unLabel = Closure [Labeled {label = TokSpan 403 403, unLabel = Var (Labeled {label = TokSpan 403 403, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 405 405, unLabel = Var (Labeled {label = TokSpan 405 405, unLabel = Ident {unIdent = "sensor"}})},Labeled {label = TokSpan 407 409, unLabel = DotTuple [Labeled {label = TokSpan 407 407, unLabel = Var (Labeled {label = TokSpan 407 407, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 409 409, unLabel = Var (Labeled {label = TokSpan 409 409, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 400 400, unLabel = Var (Labeled {label = TokSpan 400 400, unLabel = Ident {unIdent = "Network"}})}) (Labeled {label = TokSpan 412 415, unLabel = CallFunction (Labeled {label = TokSpan 412 412, unLabel = Var (Labeled {label = TokSpan 412 412, unLabel = Ident {unIdent = "NetworkTiming"}})}) [[Labeled {label = TokSpan 414 414, unLabel = Var (Labeled {label = TokSpan 414 414, unLabel = Ident {unIdent = "min"}})}]]})})]},Labeled {label = TokSpan 424 606, unLabel = PatBind (Labeled {label = TokSpan 424 424, unLabel = VarPat (Labeled {label = TokSpan 424 424, unLabel = Ident {unIdent = "Controller"}})}) (Labeled {label = TokSpan 426 606, unLabel = Let [Labeled {label = TokSpan 432 455, unLabel = PatBind (Labeled {label = TokSpan 432 432, unLabel = VarPat (Labeled {label = TokSpan 432 432, unLabel = Ident {unIdent = "ControllerUp"}})}) (Labeled {label = TokPos 452, unLabel = Fun2 "[]" (Labeled {label = TokPos 446, unLabel = Fun2 "[]" (Labeled {label = TokSpan 434 445, unLabel = PrefixExp (Labeled {label = TokSpan 434 434, unLabel = Var (Labeled {label = TokSpan 434 434, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 435 436, unLabel = OutComm (Labeled {label = TokSpan 436 436, unLabel = Var (Labeled {label = TokSpan 436 436, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 438 445, unLabel = PrefixExp (Labeled {label = TokSpan 438 438, unLabel = Var (Labeled {label = TokSpan 438 438, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 439 440, unLabel = OutComm (Labeled {label = TokSpan 440 440, unLabel = Var (Labeled {label = TokSpan 440 440, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 442 445, unLabel = CallFunction (Labeled {label = TokSpan 442 442, unLabel = Var (Labeled {label = TokSpan 442 442, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 444 444, unLabel = IntExp 1}]]})})}) (Labeled {label = TokSpan 447 451, unLabel = PrefixExp (Labeled {label = TokSpan 447 447, unLabel = Var (Labeled {label = TokSpan 447 447, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 448 449, unLabel = OutComm (Labeled {label = TokSpan 449 449, unLabel = Var (Labeled {label = TokSpan 449 449, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 451 451, unLabel = Var (Labeled {label = TokSpan 451 451, unLabel = Ident {unIdent = "ERROR"}})})})}) (Labeled {label = TokSpan 453 455, unLabel = PrefixExp (Labeled {label = TokSpan 453 453, unLabel = Var (Labeled {label = TokSpan 453 453, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 455 455, unLabel = Var (Labeled {label = TokSpan 455 455, unLabel = Ident {unIdent = "ControllerUp"}})})})})},Labeled {label = TokSpan 465 465, unLabel = FunBind (Labeled {label = TokSpan 465 465, unLabel = Ident {unIdent = "ControllerGoingDown"}}) [FunCase [[Labeled {label = TokSpan 467 467, unLabel = VarPat (Labeled {label = TokSpan 467 467, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 505, unLabel = Fun2 "[]" (Labeled {label = TokPos 498, unLabel = Fun2 "[]" (Labeled {label = TokPos 489, unLabel = Fun2 "[]" (Labeled {label = TokSpan 470 488, unLabel = Parens (Labeled {label = TokSpan 471 487, unLabel = Ifte (Labeled {label = TokPos 473, unLabel = Fun2 "<" (Labeled {label = TokSpan 472 472, unLabel = Var (Labeled {label = TokSpan 472 472, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 474 474, unLabel = Var (Labeled {label = TokSpan 474 474, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 476 476, unLabel = Var (Labeled {label = TokSpan 476 476, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 478 487, unLabel = PrefixExp (Labeled {label = TokSpan 478 478, unLabel = Var (Labeled {label = TokSpan 478 478, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 479 480, unLabel = OutComm (Labeled {label = TokSpan 480 480, unLabel = Var (Labeled {label = TokSpan 480 480, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 482 487, unLabel = CallFunction (Labeled {label = TokSpan 482 482, unLabel = Var (Labeled {label = TokSpan 482 482, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokPos 485, unLabel = Fun2 "+" (Labeled {label = TokSpan 484 484, unLabel = Var (Labeled {label = TokSpan 484 484, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 486 486, unLabel = IntExp 1})}]]})})})}) (Labeled {label = TokSpan 490 497, unLabel = PrefixExp (Labeled {label = TokSpan 490 490, unLabel = Var (Labeled {label = TokSpan 490 490, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 491 492, unLabel = OutComm (Labeled {label = TokSpan 492 492, unLabel = Var (Labeled {label = TokSpan 492 492, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 494 497, unLabel = CallFunction (Labeled {label = TokSpan 494 494, unLabel = Var (Labeled {label = TokSpan 494 494, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokSpan 496 496, unLabel = Var (Labeled {label = TokSpan 496 496, unLabel = Ident {unIdent = "n"}})}]]})})}) (Labeled {label = TokSpan 499 504, unLabel = PrefixExp (Labeled {label = TokSpan 499 499, unLabel = Var (Labeled {label = TokSpan 499 499, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 501 504, unLabel = CallFunction (Labeled {label = TokSpan 501 501, unLabel = Var (Labeled {label = TokSpan 501 501, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 503 503, unLabel = Var (Labeled {label = TokSpan 503 503, unLabel = Ident {unIdent = "n"}})}]]})})}) (Labeled {label = TokSpan 506 510, unLabel = PrefixExp (Labeled {label = TokSpan 506 506, unLabel = Var (Labeled {label = TokSpan 506 506, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 507 508, unLabel = OutComm (Labeled {label = TokSpan 508 508, unLabel = Var (Labeled {label = TokSpan 508 508, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 510 510, unLabel = Var (Labeled {label = TokSpan 510 510, unLabel = Ident {unIdent = "ERROR"}})})})})]},Labeled {label = TokSpan 517 517, unLabel = FunBind (Labeled {label = TokSpan 517 517, unLabel = Ident {unIdent = "ControllerDown"}}) [FunCase [[Labeled {label = TokSpan 519 519, unLabel = VarPat (Labeled {label = TokSpan 519 519, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 565, unLabel = Fun2 "[]" (Labeled {label = TokPos 541, unLabel = Fun2 "[]" (Labeled {label = TokSpan 522 540, unLabel = Parens (Labeled {label = TokSpan 523 539, unLabel = Ifte (Labeled {label = TokPos 525, unLabel = Fun2 "<" (Labeled {label = TokSpan 524 524, unLabel = Var (Labeled {label = TokSpan 524 524, unLabel = Ident {unIdent = "GateSeg"}})}) (Labeled {label = TokSpan 526 526, unLabel = Var (Labeled {label = TokSpan 526 526, unLabel = Ident {unIdent = "n"}})})}) (Labeled {label = TokSpan 528 528, unLabel = Var (Labeled {label = TokSpan 528 528, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 530 539, unLabel = PrefixExp (Labeled {label = TokSpan 530 530, unLabel = Var (Labeled {label = TokSpan 530 530, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 531 532, unLabel = OutComm (Labeled {label = TokSpan 532 532, unLabel = Var (Labeled {label = TokSpan 532 532, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 534 539, unLabel = CallFunction (Labeled {label = TokSpan 534 534, unLabel = Var (Labeled {label = TokSpan 534 534, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokPos 537, unLabel = Fun2 "+" (Labeled {label = TokSpan 536 536, unLabel = Var (Labeled {label = TokSpan 536 536, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 538 538, unLabel = IntExp 1})}]]})})})}) (Labeled {label = TokSpan 542 564, unLabel = PrefixExp (Labeled {label = TokSpan 542 542, unLabel = Var (Labeled {label = TokSpan 542 542, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 543 544, unLabel = OutComm (Labeled {label = TokSpan 544 544, unLabel = Var (Labeled {label = TokSpan 544 544, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 546 564, unLabel = Parens (Labeled {label = TokSpan 547 563, unLabel = Ifte (Labeled {label = TokPos 549, unLabel = Fun2 "==" (Labeled {label = TokSpan 548 548, unLabel = Var (Labeled {label = TokSpan 548 548, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 550 550, unLabel = IntExp 1})}) (Labeled {label = TokSpan 552 556, unLabel = PrefixExp (Labeled {label = TokSpan 552 552, unLabel = Var (Labeled {label = TokSpan 552 552, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 553 554, unLabel = OutComm (Labeled {label = TokSpan 554 554, unLabel = Var (Labeled {label = TokSpan 554 554, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 556 556, unLabel = Var (Labeled {label = TokSpan 556 556, unLabel = Ident {unIdent = "ControllerGoingUp"}})})}) (Labeled {label = TokSpan 558 563, unLabel = CallFunction (Labeled {label = TokSpan 558 558, unLabel = Var (Labeled {label = TokSpan 558 558, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokPos 561, unLabel = Fun2 "-" (Labeled {label = TokSpan 560 560, unLabel = Var (Labeled {label = TokSpan 560 560, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 562 562, unLabel = IntExp 1})}]]})})})})}) (Labeled {label = TokSpan 566 571, unLabel = PrefixExp (Labeled {label = TokSpan 566 566, unLabel = Var (Labeled {label = TokSpan 566 566, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 568 571, unLabel = CallFunction (Labeled {label = TokSpan 568 568, unLabel = Var (Labeled {label = TokSpan 568 568, unLabel = Ident {unIdent = "ControllerDown"}})}) [[Labeled {label = TokSpan 570 570, unLabel = Var (Labeled {label = TokSpan 570 570, unLabel = Ident {unIdent = "n"}})}]]})})})]},Labeled {label = TokSpan 575 604, unLabel = PatBind (Labeled {label = TokSpan 575 575, unLabel = VarPat (Labeled {label = TokSpan 575 575, unLabel = Ident {unIdent = "ControllerGoingUp"}})}) (Labeled {label = TokPos 599, unLabel = Fun2 "[]" (Labeled {label = TokPos 586, unLabel = Fun2 "[]" (Labeled {label = TokPos 582, unLabel = Fun2 "[]" (Labeled {label = TokSpan 577 581, unLabel = PrefixExp (Labeled {label = TokSpan 577 577, unLabel = Var (Labeled {label = TokSpan 577 577, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 578 579, unLabel = OutComm (Labeled {label = TokSpan 579 579, unLabel = Var (Labeled {label = TokSpan 579 579, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 581 581, unLabel = Var (Labeled {label = TokSpan 581 581, unLabel = Ident {unIdent = "ControllerUp"}})})}) (Labeled {label = TokSpan 583 585, unLabel = PrefixExp (Labeled {label = TokSpan 583 583, unLabel = Var (Labeled {label = TokSpan 583 583, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 585 585, unLabel = Var (Labeled {label = TokSpan 585 585, unLabel = Ident {unIdent = "ControllerGoingUp"}})})})}) (Labeled {label = TokSpan 587 598, unLabel = PrefixExp (Labeled {label = TokSpan 587 587, unLabel = Var (Labeled {label = TokSpan 587 587, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 588 589, unLabel = OutComm (Labeled {label = TokSpan 589 589, unLabel = Var (Labeled {label = TokSpan 589 589, unLabel = Ident {unIdent = "in"}})})}] (Labeled {label = TokSpan 591 598, unLabel = PrefixExp (Labeled {label = TokSpan 591 591, unLabel = Var (Labeled {label = TokSpan 591 591, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 592 593, unLabel = OutComm (Labeled {label = TokSpan 593 593, unLabel = Var (Labeled {label = TokSpan 593 593, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 595 598, unLabel = CallFunction (Labeled {label = TokSpan 595 595, unLabel = Var (Labeled {label = TokSpan 595 595, unLabel = Ident {unIdent = "ControllerGoingDown"}})}) [[Labeled {label = TokSpan 597 597, unLabel = IntExp 1}]]})})})}) (Labeled {label = TokSpan 600 604, unLabel = PrefixExp (Labeled {label = TokSpan 600 600, unLabel = Var (Labeled {label = TokSpan 600 600, unLabel = Ident {unIdent = "sensor"}})}) [Labeled {label = TokSpan 601 602, unLabel = OutComm (Labeled {label = TokSpan 602 602, unLabel = Var (Labeled {label = TokSpan 602 602, unLabel = Ident {unIdent = "out"}})})}] (Labeled {label = TokSpan 604 604, unLabel = Var (Labeled {label = TokSpan 604 604, unLabel = Ident {unIdent = "ERROR"}})})})})}] (Labeled {label = TokSpan 606 606, unLabel = Var (Labeled {label = TokSpan 606 606, unLabel = Ident {unIdent = "ControllerUp"}})})})},Labeled {label = TokSpan 610 614, unLabel = PatBind (Labeled {label = TokSpan 610 610, unLabel = VarPat (Labeled {label = TokSpan 610 610, unLabel = Ident {unIdent = "ERROR"}})}) (Labeled {label = TokSpan 612 614, unLabel = PrefixExp (Labeled {label = TokSpan 612 612, unLabel = Var (Labeled {label = TokSpan 612 612, unLabel = Ident {unIdent = "error"}})}) [] (Labeled {label = TokSpan 614 614, unLabel = Stop})})},Labeled {label = TokSpan 618 620, unLabel = PatBind (Labeled {label = TokSpan 618 618, unLabel = VarPat (Labeled {label = TokSpan 618 618, unLabel = Ident {unIdent = "VeryFastGate"}})}) (Labeled {label = TokSpan 620 620, unLabel = IntExp 3})},Labeled {label = TokSpan 621 623, unLabel = PatBind (Labeled {label = TokSpan 621 621, unLabel = VarPat (Labeled {label = TokSpan 621 621, unLabel = Ident {unIdent = "FastGate"}})}) (Labeled {label = TokSpan 623 623, unLabel = IntExp 4})},Labeled {label = TokSpan 624 626, unLabel = PatBind (Labeled {label = TokSpan 624 624, unLabel = VarPat (Labeled {label = TokSpan 624 624, unLabel = Ident {unIdent = "NormalGate"}})}) (Labeled {label = TokSpan 626 626, unLabel = IntExp 5})},Labeled {label = TokSpan 627 629, unLabel = PatBind (Labeled {label = TokSpan 627 627, unLabel = VarPat (Labeled {label = TokSpan 627 627, unLabel = Ident {unIdent = "SlowGate"}})}) (Labeled {label = TokSpan 629 629, unLabel = IntExp 6})},Labeled {label = TokSpan 630 632, unLabel = PatBind (Labeled {label = TokSpan 630 630, unLabel = VarPat (Labeled {label = TokSpan 630 630, unLabel = Ident {unIdent = "UpTime"}})}) (Labeled {label = TokSpan 632 632, unLabel = IntExp 2})},Labeled {label = TokSpan 633 633, unLabel = FunBind (Labeled {label = TokSpan 633 633, unLabel = Ident {unIdent = "Gate"}}) [FunCase [[Labeled {label = TokSpan 635 635, unLabel = VarPat (Labeled {label = TokSpan 635 635, unLabel = Ident {unIdent = "DownTime"}})}]] (Labeled {label = TokSpan 638 767, unLabel = Let [Labeled {label = TokSpan 639 658, unLabel = PatBind (Labeled {label = TokSpan 639 639, unLabel = VarPat (Labeled {label = TokSpan 639 639, unLabel = Ident {unIdent = "GateUp"}})}) (Labeled {label = TokPos 655, unLabel = Fun2 "[]" (Labeled {label = TokPos 646, unLabel = Fun2 "[]" (Labeled {label = TokSpan 641 645, unLabel = PrefixExp (Labeled {label = TokSpan 641 641, unLabel = Var (Labeled {label = TokSpan 641 641, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 642 643, unLabel = OutComm (Labeled {label = TokSpan 643 643, unLabel = Var (Labeled {label = TokSpan 643 643, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 645 645, unLabel = Var (Labeled {label = TokSpan 645 645, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokSpan 647 654, unLabel = PrefixExp (Labeled {label = TokSpan 647 647, unLabel = Var (Labeled {label = TokSpan 647 647, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 648 649, unLabel = OutComm (Labeled {label = TokSpan 649 649, unLabel = Var (Labeled {label = TokSpan 649 649, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 651 654, unLabel = CallFunction (Labeled {label = TokSpan 651 651, unLabel = Var (Labeled {label = TokSpan 651 651, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 653 653, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 656 658, unLabel = PrefixExp (Labeled {label = TokSpan 656 656, unLabel = Var (Labeled {label = TokSpan 656 656, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 658 658, unLabel = Var (Labeled {label = TokSpan 658 658, unLabel = Ident {unIdent = "GateUp"}})})})})},Labeled {label = TokSpan 659 659, unLabel = FunBind (Labeled {label = TokSpan 659 659, unLabel = Ident {unIdent = "GateGoingDown"}}) [FunCase [[Labeled {label = TokSpan 661 661, unLabel = VarPat (Labeled {label = TokSpan 661 661, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 672, unLabel = Fun2 "[]" (Labeled {label = TokSpan 664 671, unLabel = PrefixExp (Labeled {label = TokSpan 664 664, unLabel = Var (Labeled {label = TokSpan 664 664, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 665 666, unLabel = OutComm (Labeled {label = TokSpan 666 666, unLabel = Var (Labeled {label = TokSpan 666 666, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 668 671, unLabel = CallFunction (Labeled {label = TokSpan 668 668, unLabel = Var (Labeled {label = TokSpan 668 668, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 670 670, unLabel = Var (Labeled {label = TokSpan 670 670, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 673 697, unLabel = Ifte (Labeled {label = TokPos 675, unLabel = Fun2 "==" (Labeled {label = TokSpan 674 674, unLabel = Var (Labeled {label = TokSpan 674 674, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 676 676, unLabel = Var (Labeled {label = TokSpan 676 676, unLabel = Ident {unIdent = "DownTime"}})})}) (Labeled {label = TokSpan 678 682, unLabel = PrefixExp (Labeled {label = TokSpan 678 678, unLabel = Var (Labeled {label = TokSpan 678 678, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 679 680, unLabel = OutComm (Labeled {label = TokSpan 680 680, unLabel = Var (Labeled {label = TokSpan 680 680, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 682 682, unLabel = Var (Labeled {label = TokSpan 682 682, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokPos 689, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 684 688, unLabel = PrefixExp (Labeled {label = TokSpan 684 684, unLabel = Var (Labeled {label = TokSpan 684 684, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 685 686, unLabel = OutComm (Labeled {label = TokSpan 686 686, unLabel = Var (Labeled {label = TokSpan 686 686, unLabel = Ident {unIdent = "down"}})})}] (Labeled {label = TokSpan 688 688, unLabel = Var (Labeled {label = TokSpan 688 688, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokSpan 690 697, unLabel = PrefixExp (Labeled {label = TokSpan 690 690, unLabel = Var (Labeled {label = TokSpan 690 690, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 692 697, unLabel = CallFunction (Labeled {label = TokSpan 692 692, unLabel = Var (Labeled {label = TokSpan 692 692, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokPos 695, unLabel = Fun2 "+" (Labeled {label = TokSpan 694 694, unLabel = Var (Labeled {label = TokSpan 694 694, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 696 696, unLabel = IntExp 1})}]]})})})})})]},Labeled {label = TokSpan 698 717, unLabel = PatBind (Labeled {label = TokSpan 698 698, unLabel = VarPat (Labeled {label = TokSpan 698 698, unLabel = Ident {unIdent = "GateDown"}})}) (Labeled {label = TokPos 714, unLabel = Fun2 "[]" (Labeled {label = TokPos 705, unLabel = Fun2 "[]" (Labeled {label = TokSpan 700 704, unLabel = PrefixExp (Labeled {label = TokSpan 700 700, unLabel = Var (Labeled {label = TokSpan 700 700, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 701 702, unLabel = OutComm (Labeled {label = TokSpan 702 702, unLabel = Var (Labeled {label = TokSpan 702 702, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 704 704, unLabel = Var (Labeled {label = TokSpan 704 704, unLabel = Ident {unIdent = "GateDown"}})})}) (Labeled {label = TokSpan 706 713, unLabel = PrefixExp (Labeled {label = TokSpan 706 706, unLabel = Var (Labeled {label = TokSpan 706 706, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 707 708, unLabel = OutComm (Labeled {label = TokSpan 708 708, unLabel = Var (Labeled {label = TokSpan 708 708, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 710 713, unLabel = CallFunction (Labeled {label = TokSpan 710 710, unLabel = Var (Labeled {label = TokSpan 710 710, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokSpan 712 712, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 715 717, unLabel = PrefixExp (Labeled {label = TokSpan 715 715, unLabel = Var (Labeled {label = TokSpan 715 715, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 717 717, unLabel = Var (Labeled {label = TokSpan 717 717, unLabel = Ident {unIdent = "GateDown"}})})})})},Labeled {label = TokSpan 718 718, unLabel = FunBind (Labeled {label = TokSpan 718 718, unLabel = Ident {unIdent = "GateGoingUp"}}) [FunCase [[Labeled {label = TokSpan 720 720, unLabel = VarPat (Labeled {label = TokSpan 720 720, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 740, unLabel = Fun2 "[]" (Labeled {label = TokPos 731, unLabel = Fun2 "[]" (Labeled {label = TokSpan 723 730, unLabel = PrefixExp (Labeled {label = TokSpan 723 723, unLabel = Var (Labeled {label = TokSpan 723 723, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 724 725, unLabel = OutComm (Labeled {label = TokSpan 725 725, unLabel = Var (Labeled {label = TokSpan 725 725, unLabel = Ident {unIdent = "go_up"}})})}] (Labeled {label = TokSpan 727 730, unLabel = CallFunction (Labeled {label = TokSpan 727 727, unLabel = Var (Labeled {label = TokSpan 727 727, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokSpan 729 729, unLabel = Var (Labeled {label = TokSpan 729 729, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 732 739, unLabel = PrefixExp (Labeled {label = TokSpan 732 732, unLabel = Var (Labeled {label = TokSpan 732 732, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 733 734, unLabel = OutComm (Labeled {label = TokSpan 734 734, unLabel = Var (Labeled {label = TokSpan 734 734, unLabel = Ident {unIdent = "go_down"}})})}] (Labeled {label = TokSpan 736 739, unLabel = CallFunction (Labeled {label = TokSpan 736 736, unLabel = Var (Labeled {label = TokSpan 736 736, unLabel = Ident {unIdent = "GateGoingDown"}})}) [[Labeled {label = TokSpan 738 738, unLabel = IntExp 0}]]})})}) (Labeled {label = TokSpan 741 765, unLabel = Ifte (Labeled {label = TokPos 743, unLabel = Fun2 "==" (Labeled {label = TokSpan 742 742, unLabel = Var (Labeled {label = TokSpan 742 742, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 744 744, unLabel = Var (Labeled {label = TokSpan 744 744, unLabel = Ident {unIdent = "UpTime"}})})}) (Labeled {label = TokSpan 746 750, unLabel = PrefixExp (Labeled {label = TokSpan 746 746, unLabel = Var (Labeled {label = TokSpan 746 746, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 747 748, unLabel = OutComm (Labeled {label = TokSpan 748 748, unLabel = Var (Labeled {label = TokSpan 748 748, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 750 750, unLabel = Var (Labeled {label = TokSpan 750 750, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokPos 757, unLabel = Fun2 "|~|" (Labeled {label = TokSpan 752 756, unLabel = PrefixExp (Labeled {label = TokSpan 752 752, unLabel = Var (Labeled {label = TokSpan 752 752, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 753 754, unLabel = OutComm (Labeled {label = TokSpan 754 754, unLabel = Var (Labeled {label = TokSpan 754 754, unLabel = Ident {unIdent = "up"}})})}] (Labeled {label = TokSpan 756 756, unLabel = Var (Labeled {label = TokSpan 756 756, unLabel = Ident {unIdent = "GateUp"}})})}) (Labeled {label = TokSpan 758 765, unLabel = PrefixExp (Labeled {label = TokSpan 758 758, unLabel = Var (Labeled {label = TokSpan 758 758, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 760 765, unLabel = CallFunction (Labeled {label = TokSpan 760 760, unLabel = Var (Labeled {label = TokSpan 760 760, unLabel = Ident {unIdent = "GateGoingUp"}})}) [[Labeled {label = TokPos 763, unLabel = Fun2 "+" (Labeled {label = TokSpan 762 762, unLabel = Var (Labeled {label = TokSpan 762 762, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 764 764, unLabel = IntExp 1})}]]})})})})})]}] (Labeled {label = TokSpan 767 767, unLabel = Var (Labeled {label = TokSpan 767 767, unLabel = Ident {unIdent = "GateUp"}})})})]},Labeled {label = TokSpan 771 772, unLabel = Transparent [Labeled {label = TokSpan 772 772, unLabel = Ident {unIdent = "sbisim"}}]},Labeled {label = TokSpan 773 774, unLabel = Transparent [Labeled {label = TokSpan 774 774, unLabel = Ident {unIdent = "normalise"}}]},Labeled {label = TokSpan 775 776, unLabel = Transparent [Labeled {label = TokSpan 776 776, unLabel = Ident {unIdent = "explicate"}}]},Labeled {label = TokSpan 777 778, unLabel = Transparent [Labeled {label = TokSpan 778 778, unLabel = Ident {unIdent = "diamond"}}]},Labeled {label = TokSpan 779 779, unLabel = FunBind (Labeled {label = TokSpan 779 779, unLabel = Ident {unIdent = "GateAndController"}}) [FunCase [[Labeled {label = TokSpan 781 781, unLabel = VarPat (Labeled {label = TokSpan 781 781, unLabel = Ident {unIdent = "dt"}})}]] (Labeled {label = TokSpan 785 791, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 786 790, unLabel = Closure [Labeled {label = TokSpan 787 787, unLabel = Var (Labeled {label = TokSpan 787 787, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 789 789, unLabel = Var (Labeled {label = TokSpan 789 789, unLabel = Ident {unIdent = "gate"}})}]}) (Labeled {label = TokSpan 784 784, unLabel = Var (Labeled {label = TokSpan 784 784, unLabel = Ident {unIdent = "Controller"}})}) (Labeled {label = TokSpan 792 798, unLabel = CallFunction (Labeled {label = TokSpan 792 792, unLabel = Var (Labeled {label = TokSpan 792 792, unLabel = Ident {unIdent = "diamond"}})}) [[Labeled {label = TokSpan 794 797, unLabel = CallFunction (Labeled {label = TokSpan 794 794, unLabel = Var (Labeled {label = TokSpan 794 794, unLabel = Ident {unIdent = "Gate"}})}) [[Labeled {label = TokSpan 796 796, unLabel = Var (Labeled {label = TokSpan 796 796, unLabel = Ident {unIdent = "dt"}})}]]}]]})})]},Labeled {label = TokSpan 801 801, unLabel = FunBind (Labeled {label = TokSpan 801 801, unLabel = Ident {unIdent = "System"}}) [FunCase [[Labeled {label = TokSpan 803 803, unLabel = VarPat (Labeled {label = TokSpan 803 803, unLabel = Ident {unIdent = "invmaxspeed"}})},Labeled {label = TokSpan 805 805, unLabel = VarPat (Labeled {label = TokSpan 805 805, unLabel = Ident {unIdent = "gatedowntime"}})}]] (Labeled {label = TokSpan 812 818, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 813 817, unLabel = Closure [Labeled {label = TokSpan 814 814, unLabel = Var (Labeled {label = TokSpan 814 814, unLabel = Ident {unIdent = "sensor"}})},Labeled {label = TokSpan 816 816, unLabel = Var (Labeled {label = TokSpan 816 816, unLabel = Ident {unIdent = "tock"}})}]}) (Labeled {label = TokSpan 808 811, unLabel = CallFunction (Labeled {label = TokSpan 808 808, unLabel = Var (Labeled {label = TokSpan 808 808, unLabel = Ident {unIdent = "TimedNetwork"}})}) [[Labeled {label = TokSpan 810 810, unLabel = Var (Labeled {label = TokSpan 810 810, unLabel = Ident {unIdent = "invmaxspeed"}})}]]}) (Labeled {label = TokSpan 819 822, unLabel = CallFunction (Labeled {label = TokSpan 819 819, unLabel = Var (Labeled {label = TokSpan 819 819, unLabel = Ident {unIdent = "GateAndController"}})}) [[Labeled {label = TokSpan 821 821, unLabel = Var (Labeled {label = TokSpan 821 821, unLabel = Ident {unIdent = "gatedowntime"}})}]]})})]},Labeled {label = TokSpan 826 838, unLabel = PatBind (Labeled {label = TokSpan 826 826, unLabel = VarPat (Labeled {label = TokSpan 826 826, unLabel = Ident {unIdent = "NoError"}})}) (Labeled {label = TokSpan 828 838, unLabel = CallBuiltIn (Labeled {label = TokSpan 828 828, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 830 837, unLabel = CallBuiltIn (Labeled {label = TokSpan 830 830, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 832 832, unLabel = Events},Labeled {label = TokSpan 834 836, unLabel = SetEnum [Labeled {label = TokSpan 835 835, unLabel = Var (Labeled {label = TokSpan 835 835, unLabel = Ident {unIdent = "error"}})}]}]]}]]})},Labeled {label = TokSpan 839 847, unLabel = AssertRef (Labeled {label = TokSpan 840 840, unLabel = Var (Labeled {label = TokSpan 840 840, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 842 847, unLabel = CallFunction (Labeled {label = TokSpan 842 842, unLabel = Var (Labeled {label = TokSpan 842 842, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 844 844, unLabel = Var (Labeled {label = TokSpan 844 844, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 846 846, unLabel = Var (Labeled {label = TokSpan 846 846, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 854 854, unLabel = FunBind (Labeled {label = TokSpan 854 854, unLabel = Ident {unIdent = "SETBETWEENx"}}) [FunCase [[Labeled {label = TokSpan 856 856, unLabel = VarPat (Labeled {label = TokSpan 856 856, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 858 858, unLabel = VarPat (Labeled {label = TokSpan 858 858, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 860 860, unLabel = VarPat (Labeled {label = TokSpan 860 860, unLabel = Ident {unIdent = "C"}})}]] (Labeled {label = TokPos 880, unLabel = Fun2 "[]" (Labeled {label = TokSpan 863 879, unLabel = Parens (Labeled {label = TokSpan 864 878, unLabel = ProcRepChoice [Labeled {label = TokSpan 865 867, unLabel = Generator (Labeled {label = TokSpan 865 865, unLabel = VarPat (Labeled {label = TokSpan 865 865, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 867 867, unLabel = Var (Labeled {label = TokSpan 867 867, unLabel = Ident {unIdent = "EN"}})})}] (Labeled {label = TokSpan 869 878, unLabel = PrefixExp (Labeled {label = TokSpan 869 869, unLabel = Var (Labeled {label = TokSpan 869 869, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 871 878, unLabel = CallFunction (Labeled {label = TokSpan 871 871, unLabel = Var (Labeled {label = TokSpan 871 871, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 873 873, unLabel = Var (Labeled {label = TokSpan 873 873, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 875 875, unLabel = Var (Labeled {label = TokSpan 875 875, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 877 877, unLabel = Var (Labeled {label = TokSpan 877 877, unLabel = Ident {unIdent = "C"}})}]]})})})}) (Labeled {label = TokSpan 881 897, unLabel = Parens (Labeled {label = TokSpan 882 896, unLabel = ProcRepChoice [Labeled {label = TokSpan 883 885, unLabel = Generator (Labeled {label = TokSpan 883 883, unLabel = VarPat (Labeled {label = TokSpan 883 883, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 885 885, unLabel = Var (Labeled {label = TokSpan 885 885, unLabel = Ident {unIdent = "DIS"}})})}] (Labeled {label = TokSpan 887 896, unLabel = PrefixExp (Labeled {label = TokSpan 887 887, unLabel = Var (Labeled {label = TokSpan 887 887, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 889 896, unLabel = CallFunction (Labeled {label = TokSpan 889 889, unLabel = Var (Labeled {label = TokSpan 889 889, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 891 891, unLabel = Var (Labeled {label = TokSpan 891 891, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 893 893, unLabel = Var (Labeled {label = TokSpan 893 893, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 895 895, unLabel = Var (Labeled {label = TokSpan 895 895, unLabel = Ident {unIdent = "C"}})}]]})})})})})]},Labeled {label = TokSpan 898 898, unLabel = FunBind (Labeled {label = TokSpan 898 898, unLabel = Ident {unIdent = "SETOUTSIDEx"}}) [FunCase [[Labeled {label = TokSpan 900 900, unLabel = VarPat (Labeled {label = TokSpan 900 900, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 902 902, unLabel = VarPat (Labeled {label = TokSpan 902 902, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 904 904, unLabel = VarPat (Labeled {label = TokSpan 904 904, unLabel = Ident {unIdent = "C"}})}]] (Labeled {label = TokPos 942, unLabel = Fun2 "[]" (Labeled {label = TokPos 924, unLabel = Fun2 "[]" (Labeled {label = TokSpan 907 923, unLabel = Parens (Labeled {label = TokSpan 908 922, unLabel = ProcRepChoice [Labeled {label = TokSpan 909 911, unLabel = Generator (Labeled {label = TokSpan 909 909, unLabel = VarPat (Labeled {label = TokSpan 909 909, unLabel = Ident {unIdent = "c"}})}) (Labeled {label = TokSpan 911 911, unLabel = Var (Labeled {label = TokSpan 911 911, unLabel = Ident {unIdent = "C"}})})}] (Labeled {label = TokSpan 913 922, unLabel = PrefixExp (Labeled {label = TokSpan 913 913, unLabel = Var (Labeled {label = TokSpan 913 913, unLabel = Ident {unIdent = "c"}})}) [] (Labeled {label = TokSpan 915 922, unLabel = CallFunction (Labeled {label = TokSpan 915 915, unLabel = Var (Labeled {label = TokSpan 915 915, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 917 917, unLabel = Var (Labeled {label = TokSpan 917 917, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 919 919, unLabel = Var (Labeled {label = TokSpan 919 919, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 921 921, unLabel = Var (Labeled {label = TokSpan 921 921, unLabel = Ident {unIdent = "C"}})}]]})})})}) (Labeled {label = TokSpan 925 941, unLabel = Parens (Labeled {label = TokSpan 926 940, unLabel = ProcRepChoice [Labeled {label = TokSpan 927 929, unLabel = Generator (Labeled {label = TokSpan 927 927, unLabel = VarPat (Labeled {label = TokSpan 927 927, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 929 929, unLabel = Var (Labeled {label = TokSpan 929 929, unLabel = Ident {unIdent = "EN"}})})}] (Labeled {label = TokSpan 931 940, unLabel = PrefixExp (Labeled {label = TokSpan 931 931, unLabel = Var (Labeled {label = TokSpan 931 931, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 933 940, unLabel = CallFunction (Labeled {label = TokSpan 933 933, unLabel = Var (Labeled {label = TokSpan 933 933, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 935 935, unLabel = Var (Labeled {label = TokSpan 935 935, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 937 937, unLabel = Var (Labeled {label = TokSpan 937 937, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 939 939, unLabel = Var (Labeled {label = TokSpan 939 939, unLabel = Ident {unIdent = "C"}})}]]})})})})}) (Labeled {label = TokSpan 943 959, unLabel = Parens (Labeled {label = TokSpan 944 958, unLabel = ProcRepChoice [Labeled {label = TokSpan 945 947, unLabel = Generator (Labeled {label = TokSpan 945 945, unLabel = VarPat (Labeled {label = TokSpan 945 945, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 947 947, unLabel = Var (Labeled {label = TokSpan 947 947, unLabel = Ident {unIdent = "DIS"}})})}] (Labeled {label = TokSpan 949 958, unLabel = PrefixExp (Labeled {label = TokSpan 949 949, unLabel = Var (Labeled {label = TokSpan 949 949, unLabel = Ident {unIdent = "x"}})}) [] (Labeled {label = TokSpan 951 958, unLabel = CallFunction (Labeled {label = TokSpan 951 951, unLabel = Var (Labeled {label = TokSpan 951 951, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 953 953, unLabel = Var (Labeled {label = TokSpan 953 953, unLabel = Ident {unIdent = "EN"}})},Labeled {label = TokSpan 955 955, unLabel = Var (Labeled {label = TokSpan 955 955, unLabel = Ident {unIdent = "DIS"}})},Labeled {label = TokSpan 957 957, unLabel = Var (Labeled {label = TokSpan 957 957, unLabel = Ident {unIdent = "C"}})}]]})})})})})]},Labeled {label = TokSpan 964 1006, unLabel = PatBind (Labeled {label = TokSpan 964 964, unLabel = VarPat (Labeled {label = TokSpan 964 964, unLabel = Ident {unIdent = "EnterWhenDown"}})}) (Labeled {label = TokSpan 994 1002, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 995 1001, unLabel = Closure [Labeled {label = TokSpan 996 996, unLabel = Var (Labeled {label = TokSpan 996 996, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 998 1000, unLabel = DotTuple [Labeled {label = TokSpan 998 998, unLabel = Var (Labeled {label = TokSpan 998 998, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1000 1000, unLabel = Var (Labeled {label = TokSpan 1000 1000, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 966 993, unLabel = CallFunction (Labeled {label = TokSpan 966 966, unLabel = Var (Labeled {label = TokSpan 966 966, unLabel = Ident {unIdent = "SETBETWEENx"}})}) [[Labeled {label = TokSpan 968 972, unLabel = SetEnum [Labeled {label = TokSpan 969 971, unLabel = DotTuple [Labeled {label = TokSpan 969 969, unLabel = Var (Labeled {label = TokSpan 969 969, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 971 971, unLabel = Var (Labeled {label = TokSpan 971 971, unLabel = Ident {unIdent = "down"}})}]}]},Labeled {label = TokSpan 974 986, unLabel = SetEnum [Labeled {label = TokSpan 975 977, unLabel = DotTuple [Labeled {label = TokSpan 975 975, unLabel = Var (Labeled {label = TokSpan 975 975, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 977 977, unLabel = Var (Labeled {label = TokSpan 977 977, unLabel = Ident {unIdent = "up"}})}]},Labeled {label = TokSpan 979 981, unLabel = DotTuple [Labeled {label = TokSpan 979 979, unLabel = Var (Labeled {label = TokSpan 979 979, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 981 981, unLabel = Var (Labeled {label = TokSpan 981 981, unLabel = Ident {unIdent = "go_up"}})}]},Labeled {label = TokSpan 983 985, unLabel = DotTuple [Labeled {label = TokSpan 983 983, unLabel = Var (Labeled {label = TokSpan 983 983, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 985 985, unLabel = Var (Labeled {label = TokSpan 985 985, unLabel = Ident {unIdent = "go_down"}})}]}]},Labeled {label = TokSpan 988 992, unLabel = Closure [Labeled {label = TokSpan 989 991, unLabel = DotTuple [Labeled {label = TokSpan 989 989, unLabel = Var (Labeled {label = TokSpan 989 989, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 991 991, unLabel = Var (Labeled {label = TokSpan 991 991, unLabel = Ident {unIdent = "GateSeg"}})}]}]}]]}) (Labeled {label = TokSpan 1003 1006, unLabel = CallBuiltIn (Labeled {label = TokSpan 1003 1003, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1005 1005, unLabel = Events}]]})})},Labeled {label = TokSpan 1007 1043, unLabel = PatBind (Labeled {label = TokSpan 1007 1007, unLabel = VarPat (Labeled {label = TokSpan 1007 1007, unLabel = Ident {unIdent = "GateStillWhenTrain"}})}) (Labeled {label = TokSpan 1027 1039, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1028 1038, unLabel = Closure [Labeled {label = TokSpan 1029 1029, unLabel = Var (Labeled {label = TokSpan 1029 1029, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 1031 1033, unLabel = DotTuple [Labeled {label = TokSpan 1031 1031, unLabel = Var (Labeled {label = TokSpan 1031 1031, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1033 1033, unLabel = Var (Labeled {label = TokSpan 1033 1033, unLabel = Ident {unIdent = "GateSeg"}})}]},Labeled {label = TokSpan 1035 1037, unLabel = DotTuple [Labeled {label = TokSpan 1035 1035, unLabel = Var (Labeled {label = TokSpan 1035 1035, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1037 1037, unLabel = Var (Labeled {label = TokSpan 1037 1037, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 1009 1026, unLabel = CallFunction (Labeled {label = TokSpan 1009 1009, unLabel = Var (Labeled {label = TokSpan 1009 1009, unLabel = Ident {unIdent = "SETOUTSIDEx"}})}) [[Labeled {label = TokSpan 1011 1015, unLabel = Closure [Labeled {label = TokSpan 1012 1014, unLabel = DotTuple [Labeled {label = TokSpan 1012 1012, unLabel = Var (Labeled {label = TokSpan 1012 1012, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1014 1014, unLabel = Var (Labeled {label = TokSpan 1014 1014, unLabel = Ident {unIdent = "GateSeg"}})}]}]},Labeled {label = TokSpan 1017 1021, unLabel = Closure [Labeled {label = TokSpan 1018 1020, unLabel = DotTuple [Labeled {label = TokSpan 1018 1018, unLabel = Var (Labeled {label = TokSpan 1018 1018, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1020 1020, unLabel = Var (Labeled {label = TokSpan 1020 1020, unLabel = Ident {unIdent = "GateSeg"}})}]}]},Labeled {label = TokSpan 1023 1025, unLabel = Closure [Labeled {label = TokSpan 1024 1024, unLabel = Var (Labeled {label = TokSpan 1024 1024, unLabel = Ident {unIdent = "gate"}})}]}]]}) (Labeled {label = TokSpan 1040 1043, unLabel = CallBuiltIn (Labeled {label = TokSpan 1040 1040, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1042 1042, unLabel = Events}]]})})},Labeled {label = TokSpan 1045 1051, unLabel = PatBind (Labeled {label = TokSpan 1045 1045, unLabel = VarPat (Labeled {label = TokSpan 1045 1045, unLabel = Ident {unIdent = "Safety"}})}) (Labeled {label = TokSpan 1048 1050, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1049 1049, unLabel = Events}) (Labeled {label = TokSpan 1047 1047, unLabel = Var (Labeled {label = TokSpan 1047 1047, unLabel = Ident {unIdent = "EnterWhenDown"}})}) (Labeled {label = TokSpan 1051 1051, unLabel = Var (Labeled {label = TokSpan 1051 1051, unLabel = Ident {unIdent = "GateStillWhenTrain"}})})})},Labeled {label = TokSpan 1053 1061, unLabel = AssertRef (Labeled {label = TokSpan 1054 1054, unLabel = Var (Labeled {label = TokSpan 1054 1054, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1056 1061, unLabel = CallFunction (Labeled {label = TokSpan 1056 1056, unLabel = Var (Labeled {label = TokSpan 1056 1056, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1058 1058, unLabel = Var (Labeled {label = TokSpan 1058 1058, unLabel = Ident {unIdent = "SlowTrain"}})},Labeled {label = TokSpan 1060 1060, unLabel = Var (Labeled {label = TokSpan 1060 1060, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1062 1070, unLabel = AssertRef (Labeled {label = TokSpan 1063 1063, unLabel = Var (Labeled {label = TokSpan 1063 1063, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1065 1070, unLabel = CallFunction (Labeled {label = TokSpan 1065 1065, unLabel = Var (Labeled {label = TokSpan 1065 1065, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1067 1067, unLabel = Var (Labeled {label = TokSpan 1067 1067, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1069 1069, unLabel = Var (Labeled {label = TokSpan 1069 1069, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1071 1079, unLabel = AssertRef (Labeled {label = TokSpan 1072 1072, unLabel = Var (Labeled {label = TokSpan 1072 1072, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 1074 1079, unLabel = CallFunction (Labeled {label = TokSpan 1074 1074, unLabel = Var (Labeled {label = TokSpan 1074 1074, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1076 1076, unLabel = Var (Labeled {label = TokSpan 1076 1076, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1078 1078, unLabel = Var (Labeled {label = TokSpan 1078 1078, unLabel = Ident {unIdent = "SlowGate"}})}]]})},Labeled {label = TokSpan 1080 1088, unLabel = AssertRef (Labeled {label = TokSpan 1081 1081, unLabel = Var (Labeled {label = TokSpan 1081 1081, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1083 1088, unLabel = CallFunction (Labeled {label = TokSpan 1083 1083, unLabel = Var (Labeled {label = TokSpan 1083 1083, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1085 1085, unLabel = Var (Labeled {label = TokSpan 1085 1085, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1087 1087, unLabel = Var (Labeled {label = TokSpan 1087 1087, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1089 1097, unLabel = AssertRef (Labeled {label = TokSpan 1090 1090, unLabel = Var (Labeled {label = TokSpan 1090 1090, unLabel = Ident {unIdent = "NoError"}})}) "[T=" (Labeled {label = TokSpan 1092 1097, unLabel = CallFunction (Labeled {label = TokSpan 1092 1092, unLabel = Var (Labeled {label = TokSpan 1092 1092, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1094 1094, unLabel = Var (Labeled {label = TokSpan 1094 1094, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1096 1096, unLabel = Var (Labeled {label = TokSpan 1096 1096, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1098 1106, unLabel = AssertRef (Labeled {label = TokSpan 1099 1099, unLabel = Var (Labeled {label = TokSpan 1099 1099, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1101 1106, unLabel = CallFunction (Labeled {label = TokSpan 1101 1101, unLabel = Var (Labeled {label = TokSpan 1101 1101, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1103 1103, unLabel = Var (Labeled {label = TokSpan 1103 1103, unLabel = Ident {unIdent = "SlowTrain"}})},Labeled {label = TokSpan 1105 1105, unLabel = Var (Labeled {label = TokSpan 1105 1105, unLabel = Ident {unIdent = "SlowGate"}})}]]})},Labeled {label = TokSpan 1107 1115, unLabel = AssertRef (Labeled {label = TokSpan 1108 1108, unLabel = Var (Labeled {label = TokSpan 1108 1108, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1110 1115, unLabel = CallFunction (Labeled {label = TokSpan 1110 1110, unLabel = Var (Labeled {label = TokSpan 1110 1110, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1112 1112, unLabel = Var (Labeled {label = TokSpan 1112 1112, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1114 1114, unLabel = Var (Labeled {label = TokSpan 1114 1114, unLabel = Ident {unIdent = "FastGate"}})}]]})},Labeled {label = TokSpan 1116 1124, unLabel = AssertRef (Labeled {label = TokSpan 1117 1117, unLabel = Var (Labeled {label = TokSpan 1117 1117, unLabel = Ident {unIdent = "Safety"}})}) "[T=" (Labeled {label = TokSpan 1119 1124, unLabel = CallFunction (Labeled {label = TokSpan 1119 1119, unLabel = Var (Labeled {label = TokSpan 1119 1119, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1121 1121, unLabel = Var (Labeled {label = TokSpan 1121 1121, unLabel = Ident {unIdent = "FastTrain"}})},Labeled {label = TokSpan 1123 1123, unLabel = Var (Labeled {label = TokSpan 1123 1123, unLabel = Ident {unIdent = "VeryFastGate"}})}]]})},Labeled {label = TokSpan 1128 1132, unLabel = PatBind (Labeled {label = TokSpan 1128 1128, unLabel = VarPat (Labeled {label = TokSpan 1128 1128, unLabel = Ident {unIdent = "TOCKS"}})}) (Labeled {label = TokSpan 1130 1132, unLabel = PrefixExp (Labeled {label = TokSpan 1130 1130, unLabel = Var (Labeled {label = TokSpan 1130 1130, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1132 1132, unLabel = Var (Labeled {label = TokSpan 1132 1132, unLabel = Ident {unIdent = "TOCKS"}})})})},Labeled {label = TokSpan 1135 1141, unLabel = PatBind (Labeled {label = TokSpan 1135 1135, unLabel = VarPat (Labeled {label = TokSpan 1135 1135, unLabel = Ident {unIdent = "Delayable"}})}) (Labeled {label = TokSpan 1137 1141, unLabel = Closure [Labeled {label = TokSpan 1138 1140, unLabel = DotTuple [Labeled {label = TokSpan 1138 1138, unLabel = Var (Labeled {label = TokSpan 1138 1138, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1140 1140, unLabel = IntExp 1}]}]})},Labeled {label = TokSpan 1142 1151, unLabel = PatBind (Labeled {label = TokSpan 1142 1142, unLabel = VarPat (Labeled {label = TokSpan 1142 1142, unLabel = Ident {unIdent = "NonTock"}})}) (Labeled {label = TokSpan 1144 1151, unLabel = CallBuiltIn (Labeled {label = TokSpan 1144 1144, unLabel = BuiltIn "diff"}) [[Labeled {label = TokSpan 1146 1146, unLabel = Events},Labeled {label = TokSpan 1148 1150, unLabel = SetEnum [Labeled {label = TokSpan 1149 1149, unLabel = Var (Labeled {label = TokSpan 1149 1149, unLabel = Ident {unIdent = "tock"}})}]}]]})},Labeled {label = TokSpan 1152 1152, unLabel = FunBind (Labeled {label = TokSpan 1152 1152, unLabel = Ident {unIdent = "TimingConsistency"}}) [FunCase [[Labeled {label = TokSpan 1154 1154, unLabel = VarPat (Labeled {label = TokSpan 1154 1154, unLabel = Ident {unIdent = "ts"}})},Labeled {label = TokSpan 1156 1156, unLabel = VarPat (Labeled {label = TokSpan 1156 1156, unLabel = Ident {unIdent = "gs"}})}]] (Labeled {label = TokSpan 1159 1179, unLabel = CallFunction (Labeled {label = TokSpan 1159 1159, unLabel = Var (Labeled {label = TokSpan 1159 1159, unLabel = Ident {unIdent = "explicate"}})}) [[Labeled {label = TokPos 1177, unLabel = Fun2 "\\" (Labeled {label = TokSpan 1167 1169, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1168 1168, unLabel = Var (Labeled {label = TokSpan 1168 1168, unLabel = Ident {unIdent = "Delayable"}})}) (Labeled {label = TokSpan 1161 1166, unLabel = CallFunction (Labeled {label = TokSpan 1161 1161, unLabel = Var (Labeled {label = TokSpan 1161 1161, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1163 1163, unLabel = Var (Labeled {label = TokSpan 1163 1163, unLabel = Ident {unIdent = "ts"}})},Labeled {label = TokSpan 1165 1165, unLabel = Var (Labeled {label = TokSpan 1165 1165, unLabel = Ident {unIdent = "gs"}})}]]}) (Labeled {label = TokSpan 1170 1176, unLabel = CallFunction (Labeled {label = TokSpan 1170 1170, unLabel = Var (Labeled {label = TokSpan 1170 1170, unLabel = Ident {unIdent = "normalise"}})}) [[Labeled {label = TokSpan 1172 1175, unLabel = CallBuiltIn (Labeled {label = TokSpan 1172 1172, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1174 1174, unLabel = Var (Labeled {label = TokSpan 1174 1174, unLabel = Ident {unIdent = "Delayable"}})}]]}]]})}) (Labeled {label = TokSpan 1178 1178, unLabel = Var (Labeled {label = TokSpan 1178 1178, unLabel = Ident {unIdent = "NonTock"}})})}]]})]},Labeled {label = TokSpan 1180 1188, unLabel = AssertRef (Labeled {label = TokSpan 1181 1181, unLabel = Var (Labeled {label = TokSpan 1181 1181, unLabel = Ident {unIdent = "TOCKS"}})}) "[FD=" (Labeled {label = TokSpan 1183 1188, unLabel = CallFunction (Labeled {label = TokSpan 1183 1183, unLabel = Var (Labeled {label = TokSpan 1183 1183, unLabel = Ident {unIdent = "TimingConsistency"}})}) [[Labeled {label = TokSpan 1185 1185, unLabel = Var (Labeled {label = TokSpan 1185 1185, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1187 1187, unLabel = Var (Labeled {label = TokSpan 1187 1187, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1202 1202, unLabel = FunBind (Labeled {label = TokSpan 1202 1202, unLabel = Ident {unIdent = "Liveness"}}) [FunCase [[Labeled {label = TokSpan 1204 1204, unLabel = VarPat (Labeled {label = TokSpan 1204 1204, unLabel = Ident {unIdent = "X"}})}]] (Labeled {label = TokSpan 1207 1340, unLabel = Let [Labeled {label = TokSpan 1208 1223, unLabel = PatBind (Labeled {label = TokSpan 1208 1208, unLabel = VarPat (Labeled {label = TokSpan 1208 1208, unLabel = Ident {unIdent = "Idle"}})}) (Labeled {label = TokPos 1213, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1210 1212, unLabel = PrefixExp (Labeled {label = TokSpan 1210 1210, unLabel = Var (Labeled {label = TokSpan 1210 1210, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1212 1212, unLabel = Var (Labeled {label = TokSpan 1212 1212, unLabel = Ident {unIdent = "Idle"}})})}) (Labeled {label = TokSpan 1214 1223, unLabel = PrefixExp (Labeled {label = TokSpan 1214 1214, unLabel = Var (Labeled {label = TokSpan 1214 1214, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1215 1216, unLabel = OutComm (Labeled {label = TokSpan 1216 1216, unLabel = IntExp 1})},Labeled {label = TokSpan 1217 1218, unLabel = InComm (Labeled {label = TokSpan 1218 1218, unLabel = WildCard})}] (Labeled {label = TokSpan 1220 1223, unLabel = CallFunction (Labeled {label = TokSpan 1220 1220, unLabel = Var (Labeled {label = TokSpan 1220 1220, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1222 1222, unLabel = IntExp 1}]]})})})},Labeled {label = TokSpan 1224 1224, unLabel = FunBind (Labeled {label = TokSpan 1224 1224, unLabel = Ident {unIdent = "Busy"}}) [FunCase [[Labeled {label = TokSpan 1226 1226, unLabel = VarPat (Labeled {label = TokSpan 1226 1226, unLabel = Ident {unIdent = "n"}})}]] (Labeled {label = TokPos 1282, unLabel = Fun2 "[]" (Labeled {label = TokPos 1257, unLabel = Fun2 "[]" (Labeled {label = TokPos 1235, unLabel = Fun2 "[]" (Labeled {label = TokSpan 1229 1234, unLabel = PrefixExp (Labeled {label = TokSpan 1229 1229, unLabel = Var (Labeled {label = TokSpan 1229 1229, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1231 1234, unLabel = CallFunction (Labeled {label = TokSpan 1231 1231, unLabel = Var (Labeled {label = TokSpan 1231 1231, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1233 1233, unLabel = Var (Labeled {label = TokSpan 1233 1233, unLabel = Ident {unIdent = "n"}})}]]})}) (Labeled {label = TokSpan 1236 1256, unLabel = PrefixExp (Labeled {label = TokSpan 1236 1236, unLabel = Var (Labeled {label = TokSpan 1236 1236, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1237 1238, unLabel = OutComm (Labeled {label = TokSpan 1238 1238, unLabel = IntExp 1})},Labeled {label = TokSpan 1239 1240, unLabel = InComm (Labeled {label = TokSpan 1240 1240, unLabel = WildCard})}] (Labeled {label = TokSpan 1242 1256, unLabel = CallFunction (Labeled {label = TokSpan 1242 1242, unLabel = Var (Labeled {label = TokSpan 1242 1242, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1244 1255, unLabel = Ifte (Labeled {label = TokPos 1246, unLabel = Fun2 "<" (Labeled {label = TokSpan 1245 1245, unLabel = Var (Labeled {label = TokSpan 1245 1245, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1247 1247, unLabel = Var (Labeled {label = TokSpan 1247 1247, unLabel = Ident {unIdent = "GateSeg"}})})}) (Labeled {label = TokSpan 1249 1253, unLabel = Parens (Labeled {label = TokPos 1251, unLabel = Fun2 "+" (Labeled {label = TokSpan 1250 1250, unLabel = Var (Labeled {label = TokSpan 1250 1250, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1252 1252, unLabel = IntExp 1})})}) (Labeled {label = TokSpan 1255 1255, unLabel = Var (Labeled {label = TokSpan 1255 1255, unLabel = Ident {unIdent = "n"}})})}]]})})}) (Labeled {label = TokSpan 1258 1281, unLabel = PrefixExp (Labeled {label = TokSpan 1258 1258, unLabel = Var (Labeled {label = TokSpan 1258 1258, unLabel = Ident {unIdent = "leave"}})}) [Labeled {label = TokSpan 1259 1260, unLabel = OutComm (Labeled {label = TokSpan 1260 1260, unLabel = Var (Labeled {label = TokSpan 1260 1260, unLabel = Ident {unIdent = "GateSeg"}})})},Labeled {label = TokSpan 1261 1262, unLabel = InComm (Labeled {label = TokSpan 1262 1262, unLabel = WildCard})}] (Labeled {label = TokSpan 1264 1281, unLabel = Parens (Labeled {label = TokSpan 1265 1280, unLabel = Ifte (Labeled {label = TokPos 1267, unLabel = Fun2 "==" (Labeled {label = TokSpan 1266 1266, unLabel = Var (Labeled {label = TokSpan 1266 1266, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1268 1268, unLabel = IntExp 1})}) (Labeled {label = TokSpan 1270 1273, unLabel = CallFunction (Labeled {label = TokSpan 1270 1270, unLabel = Var (Labeled {label = TokSpan 1270 1270, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokSpan 1272 1272, unLabel = Var (Labeled {label = TokSpan 1272 1272, unLabel = Ident {unIdent = "X"}})}]]}) (Labeled {label = TokSpan 1275 1280, unLabel = CallFunction (Labeled {label = TokSpan 1275 1275, unLabel = Var (Labeled {label = TokSpan 1275 1275, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokPos 1278, unLabel = Fun2 "-" (Labeled {label = TokSpan 1277 1277, unLabel = Var (Labeled {label = TokSpan 1277 1277, unLabel = Ident {unIdent = "n"}})}) (Labeled {label = TokSpan 1279 1279, unLabel = IntExp 1})}]]})})})})}) (Labeled {label = TokSpan 1283 1290, unLabel = PrefixExp (Labeled {label = TokSpan 1283 1283, unLabel = Var (Labeled {label = TokSpan 1283 1283, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 1284 1285, unLabel = InComm (Labeled {label = TokSpan 1285 1285, unLabel = WildCard})}] (Labeled {label = TokSpan 1287 1290, unLabel = CallFunction (Labeled {label = TokSpan 1287 1287, unLabel = Var (Labeled {label = TokSpan 1287 1287, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1289 1289, unLabel = Var (Labeled {label = TokSpan 1289 1289, unLabel = Ident {unIdent = "n"}})}]]})})})]},Labeled {label = TokSpan 1291 1291, unLabel = FunBind (Labeled {label = TokSpan 1291 1291, unLabel = Ident {unIdent = "UpBefore"}}) [FunCase [[Labeled {label = TokSpan 1293 1293, unLabel = VarPat (Labeled {label = TokSpan 1293 1293, unLabel = Ident {unIdent = "m"}})}]] (Labeled {label = TokPos 1326, unLabel = Fun2 "[]" (Labeled {label = TokPos 1308, unLabel = Fun2 "[]" (Labeled {label = TokPos 1299, unLabel = Fun2 "&" (Labeled {label = TokPos 1297, unLabel = Fun2 "!=" (Labeled {label = TokSpan 1296 1296, unLabel = Var (Labeled {label = TokSpan 1296 1296, unLabel = Ident {unIdent = "m"}})}) (Labeled {label = TokSpan 1298 1298, unLabel = IntExp 0})}) (Labeled {label = TokSpan 1300 1307, unLabel = PrefixExp (Labeled {label = TokSpan 1300 1300, unLabel = Var (Labeled {label = TokSpan 1300 1300, unLabel = Ident {unIdent = "tock"}})}) [] (Labeled {label = TokSpan 1302 1307, unLabel = CallFunction (Labeled {label = TokSpan 1302 1302, unLabel = Var (Labeled {label = TokSpan 1302 1302, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokPos 1305, unLabel = Fun2 "-" (Labeled {label = TokSpan 1304 1304, unLabel = Var (Labeled {label = TokSpan 1304 1304, unLabel = Ident {unIdent = "m"}})}) (Labeled {label = TokSpan 1306 1306, unLabel = IntExp 1})}]]})})}) (Labeled {label = TokSpan 1309 1325, unLabel = PrefixExp (Labeled {label = TokSpan 1309 1309, unLabel = Var (Labeled {label = TokSpan 1309 1309, unLabel = Ident {unIdent = "gate"}})}) [Labeled {label = TokSpan 1310 1311, unLabel = InComm (Labeled {label = TokSpan 1311 1311, unLabel = VarPat (Labeled {label = TokSpan 1311 1311, unLabel = Ident {unIdent = "x"}})})}] (Labeled {label = TokSpan 1313 1325, unLabel = Parens (Labeled {label = TokSpan 1314 1324, unLabel = Ifte (Labeled {label = TokPos 1316, unLabel = Fun2 "==" (Labeled {label = TokSpan 1315 1315, unLabel = Var (Labeled {label = TokSpan 1315 1315, unLabel = Ident {unIdent = "x"}})}) (Labeled {label = TokSpan 1317 1317, unLabel = Var (Labeled {label = TokSpan 1317 1317, unLabel = Ident {unIdent = "up"}})})}) (Labeled {label = TokSpan 1319 1319, unLabel = Var (Labeled {label = TokSpan 1319 1319, unLabel = Ident {unIdent = "Idle"}})}) (Labeled {label = TokSpan 1321 1324, unLabel = CallFunction (Labeled {label = TokSpan 1321 1321, unLabel = Var (Labeled {label = TokSpan 1321 1321, unLabel = Ident {unIdent = "UpBefore"}})}) [[Labeled {label = TokSpan 1323 1323, unLabel = Var (Labeled {label = TokSpan 1323 1323, unLabel = Ident {unIdent = "m"}})}]]})})})})}) (Labeled {label = TokSpan 1327 1336, unLabel = PrefixExp (Labeled {label = TokSpan 1327 1327, unLabel = Var (Labeled {label = TokSpan 1327 1327, unLabel = Ident {unIdent = "enter"}})}) [Labeled {label = TokSpan 1328 1329, unLabel = OutComm (Labeled {label = TokSpan 1329 1329, unLabel = IntExp 1})},Labeled {label = TokSpan 1330 1331, unLabel = InComm (Labeled {label = TokSpan 1331 1331, unLabel = WildCard})}] (Labeled {label = TokSpan 1333 1336, unLabel = CallFunction (Labeled {label = TokSpan 1333 1333, unLabel = Var (Labeled {label = TokSpan 1333 1333, unLabel = Ident {unIdent = "Busy"}})}) [[Labeled {label = TokSpan 1335 1335, unLabel = IntExp 1}]]})})})]}] (Labeled {label = TokSpan 1340 1340, unLabel = Var (Labeled {label = TokSpan 1340 1340, unLabel = Ident {unIdent = "Idle"}})})})]},Labeled {label = TokSpan 1341 1341, unLabel = FunBind (Labeled {label = TokSpan 1341 1341, unLabel = Ident {unIdent = "GateLive"}}) [FunCase [[Labeled {label = TokSpan 1343 1343, unLabel = VarPat (Labeled {label = TokSpan 1343 1343, unLabel = Ident {unIdent = "X"}})}]] (Labeled {label = TokSpan 1350 1364, unLabel = Fun3 "sharing" (Labeled {label = TokSpan 1351 1363, unLabel = Closure [Labeled {label = TokSpan 1352 1352, unLabel = Var (Labeled {label = TokSpan 1352 1352, unLabel = Ident {unIdent = "tock"}})},Labeled {label = TokSpan 1354 1354, unLabel = Var (Labeled {label = TokSpan 1354 1354, unLabel = Ident {unIdent = "gate"}})},Labeled {label = TokSpan 1356 1358, unLabel = DotTuple [Labeled {label = TokSpan 1356 1356, unLabel = Var (Labeled {label = TokSpan 1356 1356, unLabel = Ident {unIdent = "enter"}})},Labeled {label = TokSpan 1358 1358, unLabel = IntExp 1}]},Labeled {label = TokSpan 1360 1362, unLabel = DotTuple [Labeled {label = TokSpan 1360 1360, unLabel = Var (Labeled {label = TokSpan 1360 1360, unLabel = Ident {unIdent = "leave"}})},Labeled {label = TokSpan 1362 1362, unLabel = Var (Labeled {label = TokSpan 1362 1362, unLabel = Ident {unIdent = "GateSeg"}})}]}]}) (Labeled {label = TokSpan 1346 1349, unLabel = CallFunction (Labeled {label = TokSpan 1346 1346, unLabel = Var (Labeled {label = TokSpan 1346 1346, unLabel = Ident {unIdent = "Liveness"}})}) [[Labeled {label = TokSpan 1348 1348, unLabel = Var (Labeled {label = TokSpan 1348 1348, unLabel = Ident {unIdent = "X"}})}]]}) (Labeled {label = TokSpan 1365 1368, unLabel = CallBuiltIn (Labeled {label = TokSpan 1365 1365, unLabel = BuiltIn "CHAOS"}) [[Labeled {label = TokSpan 1367 1367, unLabel = Events}]]})})]},Labeled {label = TokSpan 1369 1380, unLabel = AssertRef (Labeled {label = TokSpan 1370 1373, unLabel = CallFunction (Labeled {label = TokSpan 1370 1370, unLabel = Var (Labeled {label = TokSpan 1370 1370, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1372 1372, unLabel = IntExp 3}]]}) "[T=" (Labeled {label = TokSpan 1375 1380, unLabel = CallFunction (Labeled {label = TokSpan 1375 1375, unLabel = Var (Labeled {label = TokSpan 1375 1375, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1377 1377, unLabel = Var (Labeled {label = TokSpan 1377 1377, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1379 1379, unLabel = Var (Labeled {label = TokSpan 1379 1379, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1381 1392, unLabel = AssertRef (Labeled {label = TokSpan 1382 1385, unLabel = CallFunction (Labeled {label = TokSpan 1382 1382, unLabel = Var (Labeled {label = TokSpan 1382 1382, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1384 1384, unLabel = IntExp 2}]]}) "[T=" (Labeled {label = TokSpan 1387 1392, unLabel = CallFunction (Labeled {label = TokSpan 1387 1387, unLabel = Var (Labeled {label = TokSpan 1387 1387, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1389 1389, unLabel = Var (Labeled {label = TokSpan 1389 1389, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1391 1391, unLabel = Var (Labeled {label = TokSpan 1391 1391, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1393 1404, unLabel = AssertRef (Labeled {label = TokSpan 1394 1397, unLabel = CallFunction (Labeled {label = TokSpan 1394 1394, unLabel = Var (Labeled {label = TokSpan 1394 1394, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1396 1396, unLabel = IntExp 1}]]}) "[T=" (Labeled {label = TokSpan 1399 1404, unLabel = CallFunction (Labeled {label = TokSpan 1399 1399, unLabel = Var (Labeled {label = TokSpan 1399 1399, unLabel = Ident {unIdent = "System"}})}) [[Labeled {label = TokSpan 1401 1401, unLabel = Var (Labeled {label = TokSpan 1401 1401, unLabel = Ident {unIdent = "NormalTrain"}})},Labeled {label = TokSpan 1403 1403, unLabel = Var (Labeled {label = TokSpan 1403 1403, unLabel = Ident {unIdent = "NormalGate"}})}]]})},Labeled {label = TokSpan 1406 1415, unLabel = AssertRef (Labeled {label = TokSpan 1407 1410, unLabel = CallFunction (Labeled {label = TokSpan 1407 1407, unLabel = Var (Labeled {label = TokSpan 1407 1407, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1409 1409, unLabel = IntExp 3}]]}) "[T=" (Labeled {label = TokSpan 1412 1415, unLabel = CallFunction (Labeled {label = TokSpan 1412 1412, unLabel = Var (Labeled {label = TokSpan 1412 1412, unLabel = Ident {unIdent = "GateLive"}})}) [[Labeled {label = TokSpan 1414 1414, unLabel = IntExp 2}]]})}]}
